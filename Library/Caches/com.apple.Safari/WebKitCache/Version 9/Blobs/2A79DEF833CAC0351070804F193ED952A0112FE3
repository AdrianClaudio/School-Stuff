DU.prototype.gsa=ga(223,function(a){this.O=Qb(arguments,0)});function P9b(a,b,c,d,e){return $kb(a,y(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.L,!0)},a))}function QV(a){aj(this,a,0,-1,null)}z(QV,$i);function Q9b(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),g=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;g.push(new th(m,k,m+b,k+c))}return g}var R9b=[2];
function S9b(a){return nc(e9b,function(b){return b.match(a)}).getName()}function T9b(a,b){var c=a.type;if(u(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(xa(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":xa(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,g=0;e=b[g];g++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}}
function U9b(a){var b=a.type;if(!u(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return u(a.value)?a.value:null}}function V9b(a){aj(this,a,0,-1,null)}z(V9b,$i);var W9b={Goc:0,Pza:1,oAa:2};function X9b(a){aj(this,a,0,-1,R9b)}z(X9b,$i);
function Y9b(a,b,c){function d(){g=la.setTimeout(e,b);a.apply(null,k)}function e(){g=null;h&&(h=!1,d())}c&&(a=y(a,c));var g=null,h=!1,k=[];return function(a){k=arguments;g?h=!0:d()}}function Z9b(a){for(var b=Math.random,c=a.length-1;0<c;c--){var d=Math.floor(b()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}}function RV(a,b,c,d,e,g){K.call(this,a,b);this.C=b;this.Na=c;this.Pa=d||null;this.mb=e||null;this.F=g||null}z(RV,K);RV.prototype.Ij=f("Na");RV.prototype.Ue=f("Pa");
function $9b(a,b,c,d,e,g){RV.call(this,"assistant-sidepane-insert-chart",null,d,e,g);this.Y=a;this.$=b;this.fc=c}z($9b,RV);$9b.prototype.Re=f("fc");function a$b(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+T(a.title)+"</div>"+T(nt({Fe:"waffle-assistant-section-more-button",content:gs("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function SV(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Xa(b),mt(a,b,void 0),S5b(a),a.setAttribute("data-tooltip-delay",500),T5b(a,u(c)?c:1))};function b$b(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function c$b(){var a=V,b;b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+T(b$b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function d$b(a){return V('<div class="waffle-assistant-panel-title-bar">'+T(nt({Fe:"waffle-assistant-panel-back-button",content:gs(""+T(Lu({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+T(a.title)+"</div></div>")};function TV(a){yq.call(this,a);this.Jd=new JV(!1,"#4285f4");this.Ma(this.Jd);this.O=new yq(this.oa);this.Ma(this.O);this.D=[];this.Hf=this.Bd=!1;this.Oe=this.Qe=this.Ua=this.$=null;this.Ab=new ot("",a,4);ur(this.Ab,2);this.Ma(this.Ab)}z(TV,yq);var e$b={defaultHelpArticleId:"6280499"};q=TV.prototype;q.Sa=function(){TV.Z.Sa.call(this);this.Ba=Qr(c$b);this.Qe=S(this,"waffle-assistant-panel-content-container");this.Oe=S(this,"waffle-assistant-empty-list")};
q.Ha=function(){TV.Z.Ha.call(this);var a=S(this,"waffle-assistant-spinner-container");this.Jd.render(a);this.O.Va(S(this,"waffle-assistant-panel-card-holder"));this.Ab.Va(S(this,"waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Ab,"action",this.GXb).V(this.Ba,"scroll",Y9b(this.KWa,10,this))};q.setVisible=function(a){R(this.Ba,a);A(this.D,function(a){if(!a.qc()){var b=this.O.od();a.Y=b;this.O.Ma(a,!0);a.iP()}},this);this.Bd=a};
q.Ara=function(a,b){var c=this.oa;this.$&&this.Z5();this.$=new yq;this.Ma(this.$);a=Or(a,d$b,{title:b});this.Ua=new ot("",this.oa);this.$.Ma(this.Ua);this.Ua.Va(zn(c,"waffle-assistant-panel-back-button",a));SV(this.Ua.Ba,"Back");this.$.getHandler().V(this.Ua,"action",this.Sjb)};q.Z5=function(){this.$.dispose();this.$=null};function f$b(a,b){a.Jd.setActive(b);R(S(a,"waffle-assistant-panel-pane"),!b)}q.aM=function(a){R(this.Oe,a);R(this.Qe,!a)};
function g$b(a,b){Jb(a.D,b);a.O.removeChild(b);a.O.Ci(b,0);a.D.push(b)}q.xL=function(a){Jb(this.D,a);-1!=Hq(this.O,a)&&this.O.removeChild(a,!0)};q.j5=function(){this.O.Qd(!0);Kc(this.D);this.D=[]};q.KWa=function(){for(var a=this.Ba,a=a.scrollTop+eq(a).height,b=0,c=0;c<this.D.length;c++){var d=this.D[c];b<a?(UV(d,!0),b+=eq(d.Ba).height):UV(d,!1)}};q.We=function(a){this.Hf=a;A(this.D,function(b){b.We(a)})};q.Hd=f("Hf");q.GXb=function(){Q.Pm.Qb(e$b)};q.Sjb=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function VV(a,b,c,d){yq.call(this,d);this.R=a;this.Ua=b;this.X=new ot("",this.oa);this.Ma(this.X);this.J=new yq(this.oa);this.Ma(this.J);this.D=null;this.Na=[];this.Hf=this.Ka=!1;this.O=c}z(VV,yq);q=VV.prototype;q.LMa=Kf;q.Nsa=Lf;q.Sa=function(){VV.Z.Sa.call(this);this.Ba=Qr(a$b,{title:this.DU()})};
q.Ha=function(){VV.Z.Ha.call(this);this.J.Va(S(this,"waffle-assistant-section-card-holder"));this.X.Va(S(this,"waffle-assistant-section-more-button"));this.getHandler().V(this.X,"action",this.fub);this.D=this.PCa();I(this,this.D);R(h$b(this),this.LMa());this.setVisible(!1)};q.setVisible=function(a){if(this.qc()&&this.Ta()!=a&&(R(this.Ba,a),a)){R(this.X.Ba,this.cUa());a=new V9b;var b=this.Kda();P(a,4,b);b=new ko;gj(b,58,a);this.O.Ob(2774,new Wo(10,b))}};q.Ta=function(){return this.qc()&&hq(this.Ba)};
q.cUa=function(){return this.Na.length>this.R};q.DU=v;q.yX=v;q.PCa=function(){return new TV(this.oa)};q.We=function(a){this.Hf=a;A(i$b(this),function(b){b.We(a)});this.D.We(a)};q.Hd=f("Hf");q.vh=oa;q.a5=v;q.Kda=v;q.Qua=function(a){this.Na=a;for(var b=0;b<a.length;b++){Gc(a[b],1);if(this.J.od()<this.R){var c=this.yX(a[b]);c.We(this.Hf);var d=this.J.od();c.Y=d;this.J.Ma(c,!0)}if(this.Nsa()&&(this.D.aM(!1),c=this.D,d=this.yX(a[b]),c.D.push(d),c.Bd)){f$b(c,!1);var e=c.O.od();d.Y=e;c.O.Ma(d,!0);d.iP()}}};
function i$b(a){var b=[];a.J.xg(function(a){b.push(a)});return b}function h$b(a){return S(a,"waffle-assistant-section-content")}q.Kna=function(){return Dua(this.J)};q.t2=function(){this.Na=[];Kc(this.J.Qd(!0));this.setVisible(!1);this.Nsa()&&(this.D.j5(),this.D.aM(!0))};function j$b(a){a.J.xg(function(a,c){c<this.R&&a.iP()},a)}
q.Rua=function(a){var b=0;if(this.Ka)this.D.KWa();else if(this.Kna()){this.setVisible(!0);for(var b=eq(S(this,"waffle-assistant-section-header")).height+eq(h$b(this)).height,c=i$b(this),d=0;d<c.length;d++)b<a&&d<this.R?(this.OJa(c[d]),UV(c[d],!0),b+=eq(c[d].Ba).height):UV(c[d],!1)}else this.setVisible(!1);return a-b};q.OJa=oa;q.setActive=function(a){(this.Ka=a)||this.D.Z5()};q.Nb=f("Ka");function k$b(a,b){a.D.Ara(b,a.DU())}q.fub=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};var l$b={UNKNOWN_ERROR:0,Woc:1,Shc:2,B6b:3},m$b={Noc:0,HC:1,Yhc:2,Bhc:3,Qjc:4},n$b={Koc:0,Uhc:1,fI:2,Efc:3},o$b={Eoc:0,roc:1,h$b:2,Gnc:3,Fnc:4};function WV(){B.call(this)}z(WV,B);var p$b=null;WV.prototype.Fl=function(){return D(this,1)};function XV(){B.call(this)}z(XV,B);var q$b=null;XV.prototype.getText=function(){return D(this,1)};XV.prototype.Hq=function(){return Ac(this,1)};function YV(){B.call(this)}z(YV,B);var r$b=null;YV.prototype.getStatus=function(){return D(this,1)};YV.prototype.hasFormula=function(){return Ac(this,2)};YV.prototype.getError=function(){return D(this,9)};function ZV(){B.call(this)}z(ZV,B);var s$b=null;q=ZV.prototype;
q.oh=function(){return D(this,1)};q.Ag=function(a){E(this,1,a)};q.Y9=function(){return Ac(this,1)};q.hasFormula=function(){return Ac(this,2)};q.getType=function(){return D(this,3)};q.Fd=function(a){E(this,3,a)};q.mf=function(){return Ac(this,3)};WV.prototype.Ca=function(){var a=p$b;a||(p$b=a=Hc(WV,{0:{name:"Error",fb:"ritz.assistant.Error"},1:{name:"message",Aa:9,type:String},2:{name:"code",Aa:14,defaultValue:0,type:l$b}}));return a};WV.Ca=WV.prototype.Ca;
XV.prototype.Ca=function(){var a=q$b;a||(q$b=a=Hc(XV,{0:{name:"AnswerQueryPhrase",fb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Aa:9,type:String},2:{name:"start_byte",Aa:5,type:Number},3:{name:"num_bytes",Aa:5,type:Number}}));return a};XV.Ca=XV.prototype.Ca;
YV.prototype.Ca=function(){var a=r$b;a||(r$b=a=Hc(YV,{0:{name:"AnswerResponse",fb:"ritz.assistant.AnswerResponse"},1:{name:"status",Aa:5,type:Number},10:{name:"parse_status",Aa:14,defaultValue:0,type:m$b},11:{name:"answer_status",Aa:14,defaultValue:0,type:n$b},2:{name:"formula",Aa:9,type:String},3:{name:"debug_parse_response",Aa:9,type:String},4:{name:"interpretation",Aa:9,type:String},5:{name:"debug_interpretation_response",Aa:9,type:String},6:{name:"unused_phrase",qd:!0,Aa:11,type:XV},7:{name:"used_entity_phrase",
qd:!0,Aa:11,type:XV},8:{name:"unused_entity_phrase",qd:!0,Aa:11,type:XV},9:{name:"error",Aa:11,type:WV},12:{name:"alternate_suggestion",qd:!0,Aa:11,type:ZV}}));return a};YV.Ca=YV.prototype.Ca;ZV.prototype.Ca=function(){var a=s$b;a||(s$b=a=Hc(ZV,{0:{name:"QuerySuggestion",fb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Aa:9,type:String},2:{name:"formula",Aa:9,type:String},3:{name:"type",Aa:14,defaultValue:0,type:o$b}}));return a};ZV.Ca=ZV.prototype.Ca;function $V(){B.call(this)}z($V,B);var t$b=null;$V.prototype.getChartType=function(){return D(this,1)};
$V.prototype.Ca=function(){var a=t$b;a||(t$b=a=Hc($V,{0:{name:"AutovisRecommendationProto",fb:"ritz.assistant.AutovisRecommendationProto"},1:{name:"chart_type",Aa:9,type:String},2:{name:"chart_title",Aa:9,type:String},3:{name:"horizontal_axis_title",Aa:9,type:String},4:{name:"horizontal_axis_min",Aa:1,type:Number},5:{name:"horizontal_axis_max",Aa:1,type:Number},6:{name:"left_vertical_axis_title",Aa:9,type:String},7:{name:"left_vertical_axis_min",Aa:1,type:Number},8:{name:"left_vertical_axis_max",
Aa:1,type:Number},9:{name:"right_vertical_axis_title",Aa:9,type:String},10:{name:"right_vertical_axis_min",Aa:1,type:Number},11:{name:"right_vertical_axis_max",Aa:1,type:Number},12:{name:"columns_to_group_by",qd:!0,Aa:5,type:Number},13:{name:"column_aggregation_types",qd:!0,Aa:9,type:String},14:{name:"is_transposed",Aa:8,type:Boolean},15:{name:"use_first_column_as_domain",Aa:8,type:Boolean},16:{name:"first_data_row_index",Aa:5,type:Number},17:{name:"is_stacked",Aa:8,type:Boolean},19:{name:"text_analysis_words",
qd:!0,Aa:9,type:String},20:{name:"text_analysis_word_counts",qd:!0,Aa:5,type:Number},22:{name:"best_facet_column_from_range",Aa:5,type:Number},23:{name:"best_facet_labels",qd:!0,Aa:9,type:String},24:{name:"needs_data_transformation",Aa:8,type:Boolean},25:{name:"data_transformation",Aa:11,type:ff},26:{name:"best_facet_column_label",Aa:9,type:String},27:{name:"best_facet_range",qd:!0,Aa:11,type:Rd}}));return a};$V.Ca=$V.prototype.Ca;var u$b={qfa:0,hea:1,K2:2,L3:3};function aW(){B.call(this)}z(aW,B);var v$b=null;q=aW.prototype;q.getName=function(){return D(this,1)};q.yh=function(a){E(this,1,a)};q.getType=function(){return D(this,4)};q.Fd=function(a){E(this,4,a)};q.mf=function(){return Ac(this,4)};function bW(){B.call(this)}z(bW,B);var w$b=null;bW.prototype.getName=function(){return D(this,1)};bW.prototype.yh=function(a){E(this,1,a)};function cW(){B.call(this)}z(cW,B);var x$b=null;cW.prototype.Yd=function(a){return D(this,2,a)};
cW.prototype.hp=function(){return Ac(this,2)};aW.prototype.Ca=function(){var a=v$b;a||(v$b=a=Hc(aW,{0:{name:"Dimension",fb:"ritz.assistant.Dimension"},1:{name:"name",Aa:9,type:String},2:{name:"filter",qd:!0,Aa:9,type:String},3:{name:"non_unique_filter",qd:!0,Aa:13,type:Number},4:{name:"type",Aa:14,defaultValue:0,type:u$b},5:{name:"year_only_dates",Aa:8,type:Boolean},6:{name:"density",Aa:1,type:Number},7:{name:"alt_name",qd:!0,Aa:9,type:String}}));return a};aW.Ca=aW.prototype.Ca;
bW.prototype.Ca=function(){var a=w$b;a||(w$b=a=Hc(bW,{0:{name:"Metric",fb:"ritz.assistant.Metric"},1:{name:"name",Aa:9,type:String},2:{name:"alt_name",qd:!0,Aa:9,type:String}}));return a};bW.Ca=bW.prototype.Ca;
cW.prototype.Ca=function(){var a=x$b;a||(x$b=a=Hc(cW,{0:{name:"EntityListTable",fb:"ritz.assistant.EntityListTable"},1:{name:"metric",qd:!0,Aa:11,type:bW},2:{name:"dimension",qd:!0,Aa:11,type:aW},3:{name:"non_unique_dimension",qd:!0,Aa:13,type:Number},4:{name:"is_flipped_table",Aa:8,type:Boolean}}));return a};cW.Ca=cW.prototype.Ca;var y$b={$_b:0,YH:1,L1b:2,z_b:3,GXa:4};function dW(){B.call(this)}z(dW,B);var z$b=null;function eW(){B.call(this)}z(eW,B);var A$b=null;eW.prototype.Qf=function(a){return D(this,4,a)};function fW(){B.call(this)}z(fW,B);var B$b=null;q=fW.prototype;q.wT=function(){return D(this,2)};q.hh=function(){return D(this,3)};q.UJ=function(){return D(this,4,0)};q.getPivotTableDef=function(){return D(this,5)};q.zga=function(){return Fc(this,7)};q.getAutovisRecommendation=function(){return D(this,8)};
function gW(){B.call(this)}z(gW,B);var C$b=null;dW.prototype.Ca=function(){var a=z$b;a||(z$b=a=Hc(dW,{0:{name:"AssistantResponseProto",fb:"ritz.assistant.AssistantResponseProto"},1:{name:"recommendation",qd:!0,Aa:11,type:fW},2:{name:"selection_recommendation",qd:!0,Aa:11,type:fW}}));return a};dW.Ca=dW.prototype.Ca;
eW.prototype.Ca=function(){var a=A$b;a||(A$b=a=Hc(eW,{0:{name:"AssistantRequestProto",fb:"ritz.assistant.AssistantRequestProto"},1:{name:"table_range",Aa:11,type:Rd},2:{name:"selected_row",qd:!0,Aa:5,type:Number},3:{name:"selected_column",qd:!0,Aa:5,type:Number},4:{name:"color",qd:!0,Aa:11,type:sd},5:{name:"color_frequency",qd:!0,Aa:5,type:Number}}));return a};eW.Ca=eW.prototype.Ca;
fW.prototype.Ca=function(){var a=B$b;a||(B$b=a=Hc(fW,{0:{name:"RecommendationProto",fb:"ritz.assistant.RecommendationProto"},1:{name:"recommendation_type",Aa:14,defaultValue:0,type:y$b},2:{name:"confidence",Aa:1,type:Number},3:{name:"description",Aa:9,type:String},4:{name:"grid_ranges",qd:!0,Aa:11,type:Rd},5:{name:"pivot_table_def",Aa:11,type:Oe},6:{name:"conditional_format_rules",qd:!0,Aa:11,type:Ve},7:{name:"banding_protos",qd:!0,Aa:11,type:Fd},8:{name:"autovis_recommendation",Aa:11,type:$V},9:{name:"entity_list_table",
Aa:11,type:cW}}));return a};fW.Ca=fW.prototype.Ca;
gW.prototype.Ca=function(){var a=C$b;a||(C$b=a=Hc(gW,{0:{name:"AssistantFlagsProto",fb:"ritz.assistant.AssistantFlagsProto"},2:{name:"include_word_clouds",Aa:8,type:Boolean},3:{name:"include_conditional_formats",Aa:8,type:Boolean},4:{name:"include_forms_integration",Aa:8,type:Boolean},5:{name:"include_answers",Aa:8,type:Boolean},6:{name:"include_autovis_faceting",Aa:8,type:Boolean},7:{name:"include_banding",Aa:8,type:Boolean},9:{name:"include_autovis_sum",Aa:8,type:Boolean},10:{name:"include_already_applied_formatting_recommendations",
Aa:8,type:Boolean}}));return a};gW.Ca=gW.prototype.Ca;function D$b(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(fm?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(fm?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function hW(){}z(hW,dJ);qa(hW);hW.prototype.rc=n("waffle-assistant-link-button");function E$b(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function F$b(a,b){yq.call(this,b);this.D=a;this.C=new ht("",new hW,this.oa);this.Ma(this.C)}z(F$b,yq);q=F$b.prototype;q.Sa=function(){this.Ba=Qr(E$b)};q.Ha=function(){F$b.Z.Ha.call(this);var a=S(this,"waffle-assistant-feedback-card-link");this.C.Va(a);this.getHandler().V(this.Ba,"mousedown",this.FXb).V(this.C,"action",this.ppb);this.show(!1)};q.FXb=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Ba,c=S(this,"waffle-assistant-feedback-card-link");Jp(b,"waffle-assistant-feedback-card-hidden",!a);qn(c,a)};q.ppb=function(){Q.sx.Qb({source:this.D});this.show(!1);this.dispatchEvent(new K("feedback-dialog-opened"))};function iW(){}z(iW,ft);qa(iW);iW.prototype.rc=n("waffle-assistant-button");function G$b(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+T(Lu({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+T(Lu({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function jW(a){yq.call(this,a);this.C=new ht("",new iW,this.oa);this.Ma(this.C);this.D=new ht("",new iW,this.oa);this.Ma(this.D)}z(jW,yq);jW.prototype.Sa=function(){this.Ba=Qr(G$b)};jW.prototype.Ha=function(){jW.Z.Ha.call(this);var a=S(this,"waffle-assistant-thumbs-down-button");this.C.Va(a);SV(a,"Not useful");a=S(this,"waffle-assistant-thumbs-up-button");this.D.Va(a);SV(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.J)};
function H$b(a,b){a.oa.Nf(S(a,"waffle-assistant-thumbs-text"),b)}jW.prototype.F=function(){this.dispatchEvent(new K("thumbs-down"));R(this.Ba,!1)};jW.prototype.J=function(){this.dispatchEvent(new K("thumbs-up"));R(this.Ba,!1)};function kW(a,b){yq.call(this,b);this.D=a;this.X=this.F=this.Y=null;this.Xa=new JV(!0,"#4285f4");this.Ma(this.Xa);this.bb=this.mc=this.Jd=!1;this.$=null;this.Hf=this.Tb=!1}z(kW,yq);q=kW.prototype;q.Az=v;q.rz=v;q.eOa=Kf;q.BU=Kf;q.Z9=Lf;q.oy=v;q.FE=Mf;q.CE=Mf;q.v8=Mf;q.hla=Mf;q.gla=Mf;q.We=ea("Hf");q.Hd=f("Hf");q.y9=oa;q.Sa=function(){this.Ba=Qr(D$b)};
q.Ha=function(){kW.Z.Ha.call(this);var a=S(this,"waffle-assistant-card-spinner-container");this.Xa.render(a);Mp(S(this,"waffle-assistant-card-inner"),"visibility","hidden");if(this.BU()){var a=this.Ba,b=new xq(a);I(this,b);this.getHandler().V(b,"focusin",this.vkb).V(b,"focusout",this.ukb).V(a,"mouseenter",this.mna).V(a,"mouseleave",this.E9)}I$b(this,!1);fm&&(this.X=new F$b(this.oy(),this.oa),this.X.render(S(this,"waffle-assistant-card-feedback-container")),this.getHandler().V(this.X,"feedback-dialog-opened",
this.qpb).V(this,"trigger_feedback",this.IRb),this.Z9()?(this.F=new jW(this.oa),this.F.render(S(this,"waffle-assistant-thumbs-container")),J$b(this,!0),a=Sa(this.v8()),Qa(a)||H$b(this.F,a),a=Sa(this.hla()),Qa(a)||SV(S(this.F,"waffle-assistant-thumbs-up-button"),a),a=Sa(this.gla()),Qa(a)||SV(S(this.F,"waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.F,"thumbs-down",this.DXb).V(this.F,"thumbs-up",this.EXb)):J$b(this,!1));this.rz()};
function lW(a){return S(a,"waffle-assistant-card-content-container")}function K$b(a){a.BU();return S(a,"waffle-assistant-card-options")}function J$b(a,b){fm&&R(S(a,"waffle-assistant-thumbs-container"),a.Z9()&&b)}q.iP=function(){this.isDisposed()||(this.Jd=!0,L$b(this))};function UV(a,b){!a.mc&&b&&(a.mc=!0,L$b(a))}function L$b(a){if(a.Jd&&a.mc){var b=y(a.CXb,a);a.Az(b)}}q.mna=function(){this.bb||(I$b(this,!0),this.bb=!0,gl(this.$),this.$=fl(this.YBa,100,this))};
q.YBa=function(){this.isDisposed()||(gl(this.$),this.$=null,this.Ba.parentNode.querySelector(":hover")==this.Ba?this.$=fl(this.YBa,100,this):this.E9())};q.E9=function(){I$b(this,!1);this.bb=!1};q.vkb=function(){I$b(this,!0)};q.ukb=function(){fl(function(){this.isDisposed()||ln(this.Ba,document.activeElement)||this.Ba.parentNode.querySelector(":hover")==this.Ba||I$b(this,!1)},0,this)};
q.DXb=function(){M$b(this,!0);J$b(this,!1);var a=this.CE();this.dispatchEvent(new RV("assistant-sidepane-thumbs",this,a))};q.EXb=function(){J$b(this,!1);var a=this.FE();this.dispatchEvent(new RV("assistant-sidepane-thumbs",this,a))};q.qpb=function(){M$b(this,!1)};q.IRb=function(){M$b(this,!0)};function I$b(a,b){var c=S(a,"waffle-assistant-card-options");a=a.BU();R(c,a&&b)}q.CXb=function(){this.Xa.setActive(!1);R(this.Xa.Ba,!1);Mp(S(this,"waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new K("content-rendered"))};
function M$b(a,b){Jp(S(a,"waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.X.show(b)};function N$b(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function O$b(){return V(T(nt({Fe:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:gs(""+T(Lu({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(nt({Fe:"waffle-assistant-zoom-button",content:gs(""+T(Lu({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function P$b(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(T(a.P4a)+"</span>"),d=0==a.fGa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e';a=a.fGa;for(var e=a.length,g=0;g<e;g++)var h=a[g],c=c+((0==g%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+T(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==g%2||g==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+
(d?" waffle-assistant-facet-white-section":"")+'">'+c+(fm?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function Q$b(a,b,c,d,e,g,h){yq.call(this,h);this.F=a;this.D=b;this.L=e;this.J=g;this.C=this.fc=null;this.Ec=Yo(new Xo,10).Fa()}z(Q$b,yq);q=Q$b.prototype;q.Ha=function(){Q$b.Z.Ha.call(this);(new lV(wI,this.D.Ug)).send(y(this.Jmb,this,this.D))};q.y9=function(a,b){a=new $9b(this.F.clone(),this.L,this.fc,2746,a,b);this.dispatchEvent(a)};q.Jmb=function(a,b){b&&(b.wi()?OH.Yz(this.Ba,b):(b=b.Re(),a.Ef(b),zV(a,b),PH(a,"ready",y(this.vXb,this,a)),GV(a,this.Ba,qm),this.fc=b))};
q.vXb=function(a){a.Zl()&&(PH(a.Zl(),"onmouseover",y(this.tXb,this)),PH(a.Zl(),"onmouseout",y(this.uXb,this)))};q.tXb=function(){this.C=Ha()};q.uXb=function(){Ca(this.C)&&500<Ha()-this.C&&this.J.Ob(2750,this.Ec);this.C=null};function R$b(a,b,c,d,e){yq.call(this,e);this.J=a;this.Da=b;this.O=c;this.R=d;this.L=Fc(this.J,23);this.ea=D(this.J,22);this.D=D(this.J,26);this.$=[];this.Ka=new Li;this.X=this.F=this.C=null;this.Hf=!1;this.Y=new ot("",this.oa);this.Ma(this.Y);this.Ec=Yo(new Xo,10).Fa()}z(R$b,yq);q=R$b.prototype;q.Sa=function(){R$b.Z.Sa.call(this);this.Ba=Qr(P$b,{P4a:this.D,fGa:this.L});this.Ba.style.visibility="hidden"};
q.Ha=function(){R$b.Z.Ha.call(this);var a=S(this,"waffle-assistant-facet-toggle");this.Y.Va(a);this.getHandler().V(this.Ba,"mousedown",this.qXb).V(this.Y,"action",this.IBb);fm&&(this.X=new F$b("assistantAutovisFacetFeedback",this.oa),this.X.render(S(this,"waffle-assistant-facet-feedback-container")),this.C=new jW(this.oa),this.Ma(this.C),this.C.render(S(this,"waffle-assistant-facet-thumbs-container")),H$b(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.sXb).V(this.C,"thumbs-down",this.rXb));S$b(this,toa)};q.Hd=f("Hf");q.We=function(a){this.Hf=a;T$b(this)};q.qXb=function(a){a.stopPropagation()};q.IBb=function(){var a=Ep(S(this,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");S$b(this,a);this.O.Ob(a?2647:2646,this.Ec)};
function S$b(a,b){var c=S(a,"waffle-assistant-facet-toggle");on(c,b?"HIDE":"SHOW");Jp(S(a,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(Aq(a,"waffle-assistant-faceted-chart"),function(a){qn(a,b)});a.C&&R(a.C.Ba,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');SV(c,b?a:d)}
function U$b(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function V$b(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function T$b(a){a.R&&!a.Hf&&A(a.$,y(function(a){var b=a.Ba;if(!this.R.contains(b)){var d=this.R;a=new W$b(b,a);eib(d,a)}},a))}q.sXb=function(){this.O.Ob(2649,this.Ec)};q.rXb=function(){this.O.Ob(2648,this.Ec);this.X.show(!0)};function mW(a,b,c,d,e,g){kW.call(this,a,g);this.C=a.getAutovisRecommendation();this.$e=b;this.Qe=c;this.R=d;this.Ua=e;this.O=new ot("",this.oa);this.Ma(this.O);this.Za=new ot("",this.oa);this.Ma(this.Za);this.Oe=new Li;this.Bd=null;this.Ka=!1;this.Xc=[];this.Tc=[];this.Ab=[];this.Na=this.Da=this.J=this.L=this.ea=null;this.Ec=Yo(new Xo,10).Fa()}z(mW,kW);
var X$b={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}},Y$b=["BarChart","ColumnChart"],nW={nXa:"waffle-assistant-after-chart-preview",JXa:"waffle-assistant-before-chart-preview",WXa:"waffle-assistant-card-draggable",
q3:"waffle-assistant-chart-highlights",f_a:"waffle-assistant-insert-chart-button",Zea:"waffle-assistant-chart-preview",S0a:"waffle-assistant-button-separator",n1a:"waffle-assistant-styled-border",o1a:"waffle-assistant-styled-rect",n2a:"waffle-assistant-zoom-button"};q=mW.prototype;q.Az=function(a){this.Bd=a;Z$b(this)};q.rz=function(){$$b(this,y(function(a){a=g9b(this.$e,a);Cp(this.Ba,a)},this),!1)};q.eOa=Lf;q.BU=Lf;q.oy=n("autovisFeedback");q.FE=n(2208);q.CE=n(2207);q.v8=n("Was this chart useful?");
q.Sa=function(){mW.Z.Sa.call(this);lW(this).appendChild(Qr(N$b));K$b(this).appendChild(Qr(O$b));Ac(this.C,22)&&(this.J=new R$b(this.C,this.Y,this.R,this.Ua,this.oa),this.Ma(this.J,!0),this.J.We(this.Hd()))};
q.Ha=function(){mW.Z.Ha.call(this);Fp(this.Ba,nW.WXa);var a=S(this,nW.f_a);this.O.Va(a);SV(a,"Insert chart");a=S(this,nW.n2a);this.Za.Va(a);SV(a,"View full size");var a=S(this,nW.JXa),b=S(this,nW.Zea),c=S(this,nW.nXa);this.getHandler().V(this.Ba,"keydown",this.nXb).V(b,"click",this.alb).V(a,"focus",this.$jb).V(c,"focus",this.Vib).V(this.O,"action",this.Krb).V(this.O.Ba,"mousedown",this.Pua).V(this.Za,"action",this.wDb).V(this.Za.Ba,"mousedown",this.Pua).V(S(this,nW.q3),"mousedown",this.Pua).V(rw(this.$e),
"Ib",this.oXb);aac(this);this.R.Ob(2790,this.Ec);this.J&&this.R.Ob(2791,this.Ec)};q.We=function(a){mW.Z.We.call(this,a);aac(this);this.qc()&&bac(this)};function aac(a){if(a.qc()){var b=a.Hd();a.O.setVisible(!b);a=zn(a.oa,nW.S0a,K$b(a));R(a,!b)}}q.nXb=function(a){13==a.keyCode&&a.target==this.Ba&&(a.preventDefault(),a.stopPropagation(),cac(this,2255))};
function dac(a){for(var b=a.getChartType(),c=!!D(a.C,14),d=D(a.C,16),e=!!D(a.C,15),g="Histogram"==b,h="PieChart"==b,k=eac(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=fac(k[b].rect,c!=h);Pb(m,p)}var b=bB(a.Qe).ud(),r=vb(hc(Yg),b.s2,b),c=vb(m,function(a){return vb(r,Fa(xh,a))});g&&e&&(c=Qb(c,1));a.Ab=gac(c.length,h&&0<d||!g&&!h&&e,h&&l);d=bB(a.Qe);for(b=0;b<c.length;b++)for(e=a.Ab[b],g=0;g<c[b].length;g++)c[b][g]&&Jh(c[b][g])&&(h=MT(d,c[b][g],nW.o1a),I(a,h),bG(TI(d),h,!0),Mp(h.Ba,"background-color",
e),h.setVisible(!0),a.Xc.push(h),h=yI(d,c[b][g],nW.n1a,1,0),I(a,h),HZa(h,e),h.setVisible(!0),a.Tc.push(h))}function hac(a){Kc(a.Xc);Kc(a.Tc);a.Xc=[];a.Tc=[];a.Ab=[]}q.oXb=function(){this.Ka&&(hac(this),dac(this))};q.mna=function(){mW.Z.mna.call(this);this.Da=Ha();this.Ka||(dac(this),this.Ka=!0)};q.E9=function(){mW.Z.E9.call(this);Ca(this.Da)&&500<Ha()-this.Da&&this.R.Ob(2789,this.Ec);this.Da=null;hac(this);this.Ka=!1};q.alb=function(){this.Ba.focus()};
q.$jb=function(){var a=S(this,nW.q3);if(hq(a))a.focus();else{if(a=this.F)a=S(this.F,"waffle-assistant-thumbs-up-button"),hq(a)?(a.focus(),a=!0):a=!1;a||this.O.Ba.focus()}};q.Vib=function(){var a;if(a=this.X)a=this.X,S(a,"waffle-assistant-feedback-card-hidden")?a=!1:(S(a,"waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Ba.focus()};q.Krb=function(){this.R.Ob(2255,this.Ec);cac(this,2255)};q.Pua=function(a){a.stopPropagation()};q.wDb=function(){X.J2.Qb(this)};
q.y9=function(a,b){cac(this,2257,a,b)};function cac(a,b,c,d){$$b(a,y(function(a){a=new $9b(a,this.Y,this.L&&this.L.Re(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.pXb=function(a,b){if(b){var c=S(this,nW.Zea);if(b.wi())OH.Yz(c,b);else{a.Ef(b.Re());zV(a,a.Re());dU(a,"ready",y(this.mXb,this,a));b=[];try{var d=new ef;d.setContext(a.toJSON());var e=!!D(this.C,14);E(d,3,e);var g=D(this.C,16);E(d,4,g);E(d,5,"ROWS"==(e?"ROWS":"COLS"));E(d,8,0);if(D(this.C,24)){var h=D(this.C,25);E(d,9,h)}for(var k=eac(this),e=0;e<k.length;e++)d.addRange(Ph(k[e].rect,k[e].vd));var l=this.Oe.serialize(d);b=vb(o9b(Fa(ritz.getVerbalHighlightsForProto,l),a).call(),l9b)}catch(m){b=[]}d=
S(this,nW.q3);R(d,0<b.length);0<b.length&&(d.appendChild(b[0]),qn(d,!0));this.L=a;GV(a,c,qm)}}};q.mXb=function(a){null!==this.ea&&(wJ(uJ.getInstance(),this.ea),this.ea=null);this.isDisposed()||(a.Zl()&&(PH(a.Zl(),"onmouseover",y(this.kXb,this)),PH(a.Zl(),"onmouseout",y(this.lXb,this))),this.Bd(),bac(this))};q.kXb=function(){this.Na=Ha()};q.lXb=function(){Ca(this.Na)&&500<Ha()-this.Na&&this.R.Ob(2795,this.Ec);this.Na=null};
function bac(a){if(a.Ua&&!a.Hd()){var b=S(a,nW.Zea);if(!a.Ua.contains(b)){var c=a.Ua;a=new W$b(b,a);eib(c,a)}}}
function iac(a){a.Tb&&(a.ea=vJ(uJ.getInstance(),mj.rva),a.Tb=!1);var b=new $H(uc(X$b)),c=a.C.getChartType(),d=D(a.C,16);"PieChart"==c?(b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled")):0>=d&&b.setOption("legend.position","none");b.setOption("title",D(a.C,2));b.setOption("hAxis.title",D(a.C,3));Ac(a.C,4)&&b.setOption("hAxis.viewWindow.min",D(a.C,4));Ac(a.C,5)&&b.setOption("hAxis.viewWindow.max",D(a.C,5));b.setOption("vAxes.0.title",D(a.C,6));Ac(a.C,7)&&b.setOption("vAxes.0.viewWindow.min",
D(a.C,7));Ac(a.C,8)&&b.setOption("vAxes.0.viewWindow.max",D(a.C,8));b.setOption("vAxes.1.title",D(a.C,9));Ac(a.C,10)&&b.setOption("vAxes.1.viewWindow.min",D(a.C,10));Ac(a.C,11)&&b.setOption("vAxes.1.viewWindow.max",D(a.C,11));b.setOption("useFirstColumnAsDomain",D(a.C,15));b.setOption("isStacked",D(a.C,17));b.setOption("treatLabelsAsText",Bb(Y$b,c));b.Eh(c);d=Fc(a.C,12);if(!D(a.C,24)&&d&&d.length)if(b.setOption("applyAggregateData",0),d=Fc(a.C,13),"PieChart"===c)b.setOption("aggregateFunction",d[0]);
else for(c=0;c<d.length;c++)b.setOption("series."+c+".aggregateFunction",d[c]);b.aca(wI);var c=eac(a),d=!!D(a.C,14),e=D(a.C,16)||0,d=c5a("/gviz/tq").gk("").hb("transpose",d?"1":"0").hb("headers",e.toString()).hb("hds",0).hb("merge",d?"ROWS":"COLS").hb("authkey",vm("authKey"));D(a.C,24)&&d.hb("dt",encodeURIComponent(JSON.stringify(a.Oe.serialize(D(a.C,25)))));h5a(d,c);b.Oi(d.toString());a.J&&(c=d.clone(),a.J.F=c);return b}
function Z$b(a){var b=iac(a);b.setOption("legend.position","none");b.setOption("hAxis.slantedText",0);b.setOption("hAxis.textStyle.fontSize",11);b.setOption("vAxes.0.textStyle.fontSize",11);b.setOption("vAxes.1.textStyle.fontSize",11);b.setOption("fontStyle.size",10);b.setOption("fontStyle.italic",!1);b.setOption("titleTextStyle.bold",!1);b.setOption("titleTextStyle.fontSize",12);b.setOption("async",40);!1!==b.Ub("useFirstColumnAsDomain")&&b.Re()&&"number"===b.Re().bd(0)&&b.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==b.Ub("useFirstColumnAsDomain")&&b.Re()&&"string"===b.Re().bd(0)){var c=0,d=Xm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";S(a,"waffle-assistant-card-inner").appendChild(d);for(var e=0;e<b.Re().getNumberOfRows();e++)on(d,b.Re().zf(e,0)),c=Math.max(c,lq(d).width);dn(d);c=Math.min(27,Math.max(15,10+100*c/271))}b.setOption("chartArea.top","15%");d=b.Ub("hAxis.title");b.setOption("chartArea.height",Qa(Sa(d))?"80%":"65%");b.setOption("chartArea.left",c+"%");b.setOption("chartArea.width",
95-c+"%");"PieChart"==b.getChartType()&&(b.setOption("chartArea.top",Qa(Sa(b.Ub("title")))?"12%":"15%"),b.setOption("chartArea.height","70%"),b.setOption("chartArea.left","0%"),b.setOption("chartArea.width","100%"),b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled"),b.setOption("legend.textStyle.fontSize",10));(new lV(wI,b.Ug)).send(y(a.pXb,a,b));a.J&&$$b(a,y(function(a){var c=this.J,d=b;a=new $H(a.toJSON());var d=new $H(d.toJSON()),e=Aq(c,"waffle-assistant-faceted-chart");
if(1<e.length){V$b(a);var g=d;U$b(g);g.setOption("pieSliceText","percentage");g.setOption("axisFontSize",0);g.setOption("hAxis.title",null);g.setOption("hAxis.textPosition","none");g.setOption("vAxes.0.title",null);g.setOption("vAxes.0.textPosition","none");g.setOption("vAxes.1.title",null);g.setOption("vAxes.1.textPosition","none");g.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});g.setOption("legend","none");g.setOption("titleTextStyle.fontSize",0)}else g=a,V$b(g),g.setOption("applyAggregateData",
void 0),g.setOption("legend","right"),U$b(d);for(var g=h5a,p=c.F,r=Fc(c.J,27),t=[],w=0;w<r.length;w++)t.push(JT(r[w]));g(p,t);g=D(c.J,25);for(p=0;p<e.length;p++){var r=xa(c.L[p])?c.L[p]:null,w=t=g.clone(),x=c.ea,C=r,F=new kf;E(F,1,x);xa(C)&&F.Wa(C);E(w,7,F);c.F.hb("dt",encodeURIComponent(JSON.stringify(c.Ka.serialize(t))));t=new $H(a.toJSON());t.Oi(c.F.toString());w=d.clone();w.Oi(c.F.toString());var C=c,G=t,x=r;(F=G.Ub("title"))||(F=S9b(G));G=F+(' when "'+(C.D+('" is "'+(x+'"'))));C=F+(' by "'+(C.D+
'"'));x=x?G:C;t.setOption("title",x);w.setOption("title",x);w=new Q$b(t,w,0,0,c.Da,c.O,c.oa);c.Ma(w);x=e[p];w.Va(x);c.$.push(w);w=c;C=S9b(t);t=C+(' broken down by "'+(w.D+('" for "'+(r+'"'))));w=C+(' broken down by "'+(w.D+'"'));Cp(x,r?t:w)}T$b(c);c.Ba.style.visibility="visible"},a),!1)}function $$b(a,b,c){var d=iac(a);(new lV(wI,d.Ug)).send(function(a){a?(a=a.Re(),c&&d.Ef(a),zV(d,a),b(d)):b(null)})}function eac(a){a=Fc(a.D,4);for(var b=[],c=0;c<a.length;c++)b.push(JT(a[c]));return b}
q.getChartType=function(){return this.C.getChartType()};function gac(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=u7b("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Pb(d,d);return d}function fac(a,b){return b?Q9b(a,new kh(a.width,1)):Q9b(a,new kh(1,a.height))};function jac(){rL.call(this);this.La.push(this);this.va=this.ea=!0;this.Na="waffle-assistant-dragged-card"}z(jac,dib);jac.prototype.contains=function(a){return!!A(this.J,function(b){if(b.element==a)return!0})};jac.prototype.Cla=function(a){var b=jac.Z.Cla.call(this,a);if(jU()||qm){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=vb(b.querySelectorAll("clippath"),function(a){return a.id}),kac(b,a);return b};
function kac(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];xa(c)&&cb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=fn(a);for(d=0;d<a.length;d++)kac(a[d],b)}function W$b(a,b){tL.call(this,a,b)}z(W$b,tL);W$b.prototype.Ela=f("element");function lac(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function oW(a,b){kW.call(this,a,b);this.C=a.getAutovisRecommendation()}z(oW,kW);q=oW.prototype;q.rz=oa;q.oy=n("assistantWordCloudFeedback");q.FE=n(2634);q.CE=n(2633);q.Sa=function(){oW.Z.Sa.call(this);lW(this).appendChild(Qr(lac));Fp(lW(this),"waffle-assistant-word-cloud-content-container")};
q.Az=function(a){for(var b=Fc(this.C,19),c=Fc(this.C,20),d=S(this,"waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Sk(b,c,e),120<d.clientHeight){this.Sk(b,c,e-1);break}b=this.oa;c=D(this.C,2);c=Cn(b,c);d=S(this,"waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Sk=function(a,b,c){for(var d=S(this,"waffle-assistant-word-cloud-words-container"),e=this.oa;d.firstChild;)d.removeChild(d.firstChild);for(var g=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(Cn(e," "));var l=e.createElement("SPAN");e.appendChild(l,Cn(e,a[k]));e.appendChild(d,l);Fp(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-g)/(h-g)*15+9+"px"}};function pW(a,b,c,d,e){VV.call(this,20,d,c,e);this.ea=a;this.$=b;this.C=new jac;I(this,this.C);this.F=null;this.Y=0}z(pW,VV);q=pW.prototype;q.Ha=function(){pW.Z.Ha.call(this);this.C.Ve();this.getHandler().V(this.C,"drag",this.jXb).V(this.C,"dragend",this.iXb)};q.DU=n("Analysis");q.a5=function(a){return 0==a};q.yX=function(a){return"WordCloud"==a.getAutovisRecommendation().getChartType()?new oW(a,this.oa):new mW(a,this.ea,this.$,this.O,this.C,this.oa)};q.We=function(a){pW.Z.We.call(this,a);a&&Mhb(this.C)};
q.OJa=function(a){Gf(this.getHandler(),a,"content-rendered",this.hXb);this.Y++};q.hXb=function(){0==--this.Y&&this.dispatchEvent("assistant-done-rendering")};q.jXb=function(){this.F=$p(this.C.Yc.target)};q.iXb=function(a){var b=this.F,c=bB(this.$).C;if(ph(VE(c,"page",!1,!1)).contains(b)){var d=TE(c,b.x,b.y,"page"),c=XE(c,vh(d),"page"),b=new N(b.x-c.left,b.y-c.top);a.C.getData().y9(d,b)}this.F=null};q.Kda=n(2);function mac(a){for(var b=0;b<nac.length;++b)if(-1!=Ab(nac[b].xj,function(b){return Ma(a,b)}))return b;return-1};function oac(a,b,c,d,e){this.C=a;this.$fa=b;this.F=d;this.Yn=c;this.L=d?Fc(d,6):[];this.O=d?Fc(d,7):[];this.J=d?Fc(d,8):[];this.error=e||1;this.interpretation=hoa&&d&&Ac(d,4)?D(d,4):null;this.D=ioa&&d?Fc(d,12):[]}function pac(a){return{pT:qac(a),interpretation:a.interpretation,$fa:a.$fa,Yn:a.Yn}}function rac(a){return{pT:qac(a),error:sac(a)}}
function sac(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer. Please try again.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about you data.";case 6:return a.F.getError().Fl()||"";case 7:return a=mac(a.C),-1!=a?nac[a].yg:""}return""}
function qac(a){var b=[];if(goa&&1==a.error&&null!=a.Yn){var c=[];A(Lb(a.L,a.J),function(a){c.push(tac(a,"waffle-assistant-answercard-question-unused-phrase"))},a);A(a.O,function(a){c.push(tac(a,"waffle-assistant-answercard-question-used-entity"))},a);Ub(c,function(a,b){return a.lC>b.lC?1:-1});var d=0;A(c,function(a){a.lC>d&&b.push({text:this.C.substring(d,a.lC),className:null});d=a.lC+a.length;b.push({text:this.C.substring(a.lC,d),className:a.Ck})},a);d<a.C.length&&b.push({text:a.C.substring(d),
className:null})}else b.push({text:a.C,className:null});return b}function tac(a,b){return{lC:D(a,2),length:D(a,3),Ck:b}}function uac(a,b,c){return new oac(a,null,null,c||null,b)};function qW(a,b,c,d){L.call(this);this.R=a;this.X=b;this.Y=c;this.Ga=d;this.qa=new M(this);I(this,this.qa);this.C=new DU;I(this,this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.Hf=!1;y6b(this.C,this.R);this.C.X=10;this.C.ea=!0;this.C.L=!1;this.C.gsa("waffle-assistant-visible");this.C.R=Xa("waffle-assistant-dragged-formula").split(" ");this.C.Ve();this.qa.V(this.C,"beforedragstart",this.va).V(this.C,"dragmove",this.ea).V(this.C,"beforedragend",this.$)}z(qW,L);qW.prototype.We=ea("Hf");
qW.prototype.va=function(a){a=sb(this.R.childNodes,a.C);this.O=this.L[a]};
qW.prototype.ea=function(a){var b=a.event instanceof wq?a.event.C:a.event;this.Hf?(a.Y.Cw(b,!0),a.preventDefault()):(Sp(a.F,a.event.clientX,a.event.clientY),a=Tp(a.F),b=bB(this.X).C,ph(VE(b,"page",!1,!1)).contains(a)?(a=TE(b,a.x,a.y,"page"),(b=by(tw(this.Y),a.y,a.x))?a=new N(b.Wb(),b.gc()):b=vh(a),this.J=a,this.D&&this.D.tc().equals(b)||(a=bB(this.X),J(this.D),this.D=MT(a,b,"waffle-assistant-formula-insertion-rect"),I(this,this.D),bG(TI(a),this.D),J(this.F),this.F=yI(a,b,"waffle-assistant-formula-insertion-border",
2,0),I(this,this.F),HZa(this.F,"#000"),this.F.setVisible(!0))):vac(this))};qW.prototype.$=function(a){if(this.J){var b=this.J,c=tw(this.Y),b=new mF(c,b,this.O);this.Ga.C(b);this.dispatchEvent(new K("formula_inserted"))}a.Y.Cw(null,!0);a.preventDefault();this.O="";vac(this)};function vac(a){a.J=null;J(a.D);a.D=null;J(a.F);a.F=null};function wac(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+xac({pT:a.I4.pT}),d;d=a.I4.$fa;var e=a.I4.Yn;a=a.I4.interpretation;null==d||ta(d);a=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+js("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(a?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
T(a)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a+='<div class="waffle-assistant-answercard-answer">';for(var g=d.length,h=0;h<g;h++){var k=d[h],l=1<k.length;if(0==h&&l){a+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=k.length,m=0;m<l;m++)a+='<span class="waffle-assistant-answercard-answer-col">'+T(k[m])+"</span>"}else for(l="waffle-assistant-answercard-answer-row"+(l?" waffle-assistant-answercard-answer-list-row":""),l=fs(l),a+=
'<div class="'+W(l)+'">',l=k.length,m=0;m<l;m++){var p=k[m];a=p?a+('<span class="waffle-assistant-answercard-answer-col">'+T(p)+"</span>"):a+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}a+="</div>"}a+="</div>"}a+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+
T(Lu({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+T(e)+"</div></div></div></div></div></div>";d=V(a);return b(c+d+"</div></div>")}
function xac(a){a=a.pT;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+js("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+T(e.text)+"</span>":T(e.text)}return V(b+"</div></div></div>")}
function yac(){return V(T(V('<div class="waffle-assistant-answers-card-remove">'+T(Lu({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};var zac="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this".split(";"),nac=[{xj:["Thank you"],yg:"No problem"},{xj:["you are amazing","This is great","omg"],yg:"Happy to help"},{xj:["I love you"],yg:"Must be in the air"},{xj:["How do you know"],yg:"It's all in the data"},{xj:["Are you sure"],yg:"Send feedback if this doesn't seem correct to help improve accuracy"},{xj:["How are you"],yg:"Pretty good, thanks"},{xj:["Hi","Hello","Hey"],yg:"Hi, there. Try asking a question about your data."},
{xj:["You are stupid","This is dumb","You are wrong"],yg:"Help improve this experience by sending feedback"},{xj:["How smart are you"],yg:"Pretty smart"}];function Aac(a,b,c,d){K.call(this,"sqc");this.Y=a;this.C=d||"";this.F=c}z(Aac,K);function rW(a,b,c,d,e,g,h,k){kW.call(this,new fW,k);this.L=a;this.Da=b;this.Ua=c;this.Na=d;this.Za=g;this.ea=e;this.Ka=h;this.Ec=Yo(new Xo,10).Fa();this.R=new ht("",new iW,this.oa);this.Ma(this.R);this.C=null;this.J=new ht("",new hW,this.oa);this.Ma(this.J);this.O=new ht("",new hW,this.oa);this.Ma(this.O)}z(rW,kW);q=rW.prototype;q.jka=f("Ka");q.Sa=function(){rW.Z.Sa.call(this);K$b(this).appendChild(Qr(yac))};
q.Ha=function(){rW.Z.Ha.call(this);var a=S(this,"waffle-assistant-answers-card-remove");this.R.Va(a);SV(a,"Remove card",0);Gf(this.getHandler(),this.R,"action",this.xXb).V(this.J,"action",this.izb).V(this.O,"action",this.Nqb)};
q.Az=function(a){lW(this).appendChild(Qr(wac,{I4:pac(this.L)}));this.J.Va(S(this,"waffle-assistant-answercard-see-formula-link"));this.O.Va(S(this,"waffle-assistant-answercard-hide-formula-link"));this.C=new qW(S(this,"waffle-assistant-answercard-formula-text-container"),this.Da,this.Ua,this.Na);this.C.We(this.Hd());this.C.L=[this.L.Yn];I(this,this.C);var b=S(this,"waffle-assistant-answercard-formula-text");Cp(b,"Formula: "+(this.L.Yn+". Click/Press ENTER to copy or drag to insert on to sheet."));
If(this.getHandler().V(this.C,"formula_inserted",this.wXb),S(this,"waffle-assistant-answercard-formula-text"),nd,this.eqb);Bac(this,!1);a()};q.rz=function(){Cp(this.Ba,"Answer Card for question: "+this.L.C)};q.BU=Lf;q.oy=n("assistantAnswersFeedback");q.FE=n(2628);q.CE=n(2627);q.v8=n("Was this answer correct?");q.hla=n("Correct");q.gla=n("Incorrect");q.x7=f("L");q.We=function(a){rW.Z.We.call(this,a);this.C&&this.C.We(a)};
function Bac(a,b){a.J.setVisible(!b);a.O.setVisible(b);R(S(a,"waffle-assistant-answercard-formula"),b);b?S(a,"waffle-assistant-answercard-formula-text").focus():(a.J.Ba.focus(),a.J.Yq(!0))}q.xXb=function(){var a=new QV;P(a,3,!0);var b=new PT;gj(b,4,a);a=new ko;gj(a,46,b);this.ea.Ob(2753,new Wo(10,a));this.dispatchEvent(new K("rc"))};q.izb=function(){Bac(this,!0)};q.Nqb=function(){Bac(this,!1)};q.wXb=function(){this.ea.Ob(2709,this.Ec)};
q.eqb=function(){var a=this.oa.xb(),b=a.createElement("textarea");b.textContent=this.L.Yn;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&Cac(this.Za,"Formula copied to clipboard",this.oa)};function Dac(){var a;a=fs("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+T(Lu({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function Eac(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+T(xac({pT:a.TFa.pT})),d;d=a.TFa.error;var e=!!a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+T(Lu({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';e?(d=T(d)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',
a+='<div class="waffle-assistant-errorcard-text">'+d+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+T(d)+"</div>";d=V(a+"</div></div>");return b(c+d+"</div></div>")}function Fac(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function sW(a,b,c,d,e){kW.call(this,new fW,e);this.O=a;this.ea=b;this.L=d;this.Da=c;this.R=new ht("",new iW,this.oa);this.Ma(this.R);this.J=new ht("",new hW,this.oa);this.Ma(this.J);this.C=new ht("",new hW,this.oa);this.Ma(this.C)}z(sW,kW);q=sW.prototype;q.rz=function(){Cp(this.Ba,"Error Card for question: "+this.O.C)};q.oy=n("assistantAnswersFeedback");q.BU=Lf;q.Z9=Kf;q.Sa=function(){sW.Z.Sa.call(this);K$b(this).appendChild(Qr(yac))};
q.Ha=function(){sW.Z.Ha.call(this);var a=S(this,"waffle-assistant-answers-card-remove");this.R.Va(a);this.C.setVisible(this.L);SV(a,"Remove card",0);Gf(Gf(this.getHandler(),this.R,"action",this.BXb),this.J,"action",this.vzb).V(this.C,"action",this.Jqb)};
q.Az=function(a){lW(this).appendChild(Qr(Eac,{TFa:rac(this.O),showHelp:this.L}));if(fm){var b=Qr(Fac);this.oa.appendChild(this.Ba,b);this.J.Va(S(this,"waffle-assistant-answercard-feedback-link"))}this.L&&this.C.Va(S(this,"waffle-assistant-answers-helpcenter-link"));a()};q.jka=f("ea");q.x7=f("O");q.vzb=function(){this.J.setVisible(!1);R(S(this,"waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new K("trigger_feedback"))};
q.BXb=function(){var a=new QV;P(a,3,!1);var b=new PT;gj(b,4,a);a=new ko;gj(a,46,b);this.Da.Ob(2753,new Wo(10,a));this.dispatchEvent(new K("rc"))};q.Jqb=function(){Q.Pm.Qb()};function Gac(a){kW.call(this,new fW,a);this.C=this.oa.createElement("div");on(this.C,"Previous")}z(Gac,kW);q=Gac.prototype;q.rz=function(){Cp(this.Ba,"Previous questions below")};q.Sa=function(){Gac.Z.Sa.call(this);Hp(this.Ba,"waffle-assistant-card");Fp(this.Ba,"waffle-assistant-answers-previousheadercard")};q.Az=function(a){0<this.oa.Dh(lW(this)).length||lW(this).appendChild(this.C);a()};q.Z9=Kf;q.oy=n("assistantAnswersFeedback");function Hac(a){var b;b=""+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+T(a.title)+"</div>":"");var c;c=fs("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.TQb;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+T(Lu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+
T(g)+"</div></div></div>"}return V(b+"</div>")};function tW(a,b,c,d,e){kW.call(this,a,e);this.J=c;this.C=d;this.L=b}z(tW,kW);q=tW.prototype;q.FE=function(){return Bb([Iac,Jac],this.C)?2799:Bb([Kac,Lac],this.C)?2801:null};q.CE=function(){return Bb([Iac,Jac],this.C)?2798:Bb([Kac,Lac],this.C)?2800:null};q.v8=n("Were these interesting?");q.hla=n("Interesting");q.gla=n("Not interesting");q.oy=n("assistantAnswersFeedback");q.rz=function(){var a=this.C.title;a&&this.J?Cp(this.Ba,a+(" for question : "+this.J)):Cp(this.Ba,"Suggested questions")};
q.Az=function(a){this.L.then(function(b){if(0==b.length)R(this.Ba,!1);else{var c=this.oa,d=lW(this);if(0==c.Dh(d).length){var e=Qr(Hac,{title:this.C.title,TQb:vb(b,function(a){return a.query})});d.appendChild(e);d=Aq(this,"waffle-assistant-answercard-question-container");A(d,function(a,d){var e=new ht("",new iW,c);this.Ma(e);e.Va(a);this.getHandler().V(e,"action",y(this.$Ab,this,b[d]))},this)}}a()},null,this)};q.$Ab=function(a){this.dispatchEvent(new Aac(this.C.I1,0,a.Yn||null,a.query))};
var Mac={title:"",I1:null},Iac={title:"",I1:1},Jac={title:"Suggested questions",I1:1},Lac={title:"Did you mean?",I1:4},Kac={title:"Related questions",I1:4};function Nac(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var g;do g=Math.floor(Math.random()*a);while(d[g]);d[g]=1;c.push(g)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),g=c[e],c[e]=c[d],c[d]=g}return c.slice(0,b)}function uW(a){return Nac(a,1)[0]}function Oac(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return vb(a[b],function(b,d){return vb(a,function(a){return a[d]})})};function Pac(a){this.J=[];this.D={};this.L=a;this.C=new sP}function Qac(a,b,c,d){function e(a){return a.toLowerCase()}Rb(b,void 0,e);Rb(c,void 0,e);Rb(d,void 0,e);A(b,a.F,a);A(c,a.F,a);A(d,a.F,a)}Pac.prototype.F=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,g=b.substr(d),h=this.C.get(g);h||(h=[],this.C.add(g,h));h.push(e)}};
Pac.prototype.mG=function(a,b,c){var d;if(Xa(a||"")){d=this.L.Wl();d=Rac(this,a.substring(0,d));var e=Sac(this,b-d.length,a);d=Lb(d,e)}else d=Sac(this,b);d.length>b&&(d=Qb(d,0,b));c(a,d)};function Sac(a,b,c){var d=c||"";c=cc(a.D,function(a){return Ma(a,d)});var e=Tac(hc(c),d?1:2,1);a=ub(a.J,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=Tac(a,b-gc(e),2);return Lb(hc(b),hc(e))}
function Rac(a,b){for(var c=[],d=3,e={},g=b.toLowerCase(),h=0;h<g.length&&0<d;++h)if(0==h||" "==g[h-1]&&" "!=g[h]){var k={},l=0,m=g.substr(h),p=a.C.ye(m);A(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.C.get(a);k[b]||(k[b]=[]);Pb(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var t=0;t<r.length&&0<d;++t){var w=r[t];cb(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Yn:"",mz:0,SBa:g.length-h}),e[w]=!0)}}}return c}
function Tac(a,b,c){b=Nac(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=xa(b)?b:b.query;d[e.toLowerCase()]={text:e,Yn:xa(b)?"":b.Yn,mz:c,SBa:0}});return d};function vW(){RF.call(this,"",null,!1)}z(vW,RF);vW.prototype.WB=function(a,b){if(2==a.mz||1==a.mz)return vW.Z.WB.call(this,a.text,b);var c=this.Ia(),d=this.Wl(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var g=c.substring(0,d-a.SBa)+a.text;e||(g+=" ");a=vW.Z.WB.call(this,{toString:function(){return g+c.substring(d)}},b);this.a1(g.length);b=this.Fj;b.blur();b.focus();return a};
vW.prototype.Jg=function(a){var b=vW.Z.Jg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,sYa(b)&&b.cF()&&a.preventDefault(),b=!0);return b};function Uac(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+T(Lu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+T(Lu({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+T(Lu({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function Vac(a){this.C=a||Km()}
Vac.prototype.yL=function(a,b,c){b=Qr(Uac);var d=zn(this.C,"waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.C.Nf(d,a.text);var d=zn(this.C,"waffle-assistant-answers-ac-entity-icon",b),e=zn(this.C,"waffle-assistant-answers-ac-suggested-query-icon",b),g=zn(this.C,"waffle-assistant-answers-ac-session-query-icon",b);R(d,0==a.mz);R(e,2==a.mz);R(g,1==a.mz);d="";switch(a.mz){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Fp(c,d);this.C.appendChild(c,b)};function wW(a,b,c,d,e,g,h,k,l){TV.call(this,l);this.$e=c;this.yk=d;this.Ii=e;this.$g=a;this.jb=h;this.Da=this.R=this.J=this.bb=null;this.ea=new vW;this.ea.IGa=!0;this.ea.ea=!0;this.Ka=new Pac(this.ea);a=new PF(null,new Vac(l));this.F=new KF(this.Ka,a,this.ea);I(this,this.F);this.L=g;this.Xc=this.Y=null;this.Kf=k;this.Xa=!1;this.Ec=Yo(new Xo,10).Fa();this.tj=new Li;this.Na={};this.X=this.C=this.Tb=null;this.Tc=[];this.mc=[];this.Lg=uJ.getInstance();this.Za=""}z(wW,TV);q=wW.prototype;
q.Sa=function(){wW.Z.Sa.call(this);var a=this.F.Pe();a.className="waffle-assistant-answers-ac-renderer";a.$h="waffle-assistant-answers-ac-row";a.Rr="waffle-assistant-answers-ac-active";a.oI="waffle-assistant-answers-ac-highlighted"};q.Ha=function(){wW.Z.Ha.call(this);this.ea.C=this.F;this.F.S4=!1;this.F.laa=6;this.getHandler().V(this.F,"update",this.Ejb);this.aM(null==this.Y)};
q.Ara=function(a,b){wW.Z.Ara.call(this,a,b);b=this.oa;var c=this.$;b.appendChild(a,Qr(Dac));this.X=zn(b,"waffle-assistant-answers-query-box",a);this.J=new ht("",new iW,this.oa);c.Ma(this.J);this.J.Va(zn(b,"waffle-assistant-answers-clear-query-button",this.X));this.Da=new JV(!1,"#4285f4");c.Ma(this.Da);this.Tb=zn(b,"waffle-assistant-answers-spinner-container",this.X);this.Da.render(this.Tb);this.C=zn(b,"waffle-assistant-answers-input-box",this.X);HYa(this.ea,this.C);SV(this.J.getElement(),"Clear query");
c.getHandler().V(this.X,"submit",y(this.WAb,this)).V(this.X,"focus",y(this.OFa,this,!0),!0).V(this.X,"blur",y(this.OFa,this,!1),!0).V(this.J,"action",y(this.G4a,this)).V(this.C,"input",y(this.$Rb,this)).V(this.C,"focus",y(this.INb,this));this.J.setVisible(!1)};q.Z5=function(){JYa(this.ea,this.C);this.J.setVisible(!1);this.Da.dispose();this.Da=null;wW.Z.Z5.call(this)};q.aM=function(a){wW.Z.aM.call(this,a);this.C&&(a?this.C.setAttribute("disabled",!0):this.C.removeAttribute("disabled"))};q.vh=ea("bb");
function Wac(a,b,c){var d=vb(Fc(c,1),function(a){return a.getName()}),e=[],g=[];A(Fc(c,2),function(a){e.push(a.getName());g=g.concat(Fc(a,2))});Qac(a.Ka,d,e,g);Xac(a.$g).then(function(a){this.Ka.J=a},null,a);a.Y=b;a.Xc=c;a.aM(null==b)}q.reset=function(){mU(this.Na);mU(this.Ka.D);this.R=null};
function Yac(a){if(a.qc()&&(Zac(a),null!=a.Y))for(var b=bB(a.$e),c=b.ud(),c=vb(hc(Yg),c.s2,c),c=vb(c,Fa(xh,a.Y.rect)),d=0;d<c.length;d++)if(c[d]&&Jh(c[d])){var e=MT(b,c[d],"waffle-assistant-answers-styled-rect");I(a,e);bG(TI(b),e,!0);e.setVisible(!0);a.Tc.push(e);e=yI(b,c[d],"waffle-assistant-answers-styled-border",1,0);I(a,e);e.setVisible(!0);a.mc.push(e)}}function Zac(a){Kc(a.Tc);Kc(a.mc);a.Tc=[];a.mc=[]}
q.Ejb=function(a){a.row&&(a=a.row,2==a.mz?($ac(this,1,a.Yn),this.L.Ob(2652,this.Ec)):0==a.mz?(this.Xa=!0,this.L.Ob(2651,this.Ec)):1==a.mz&&$ac(this,3))};q.OFa=function(a){Jp(this.X,"waffle-assistant-answers-query-box-focused",a);MF(this.F)&&!a&&this.F.zj()};q.$Rb=function(){this.J.setVisible(!!U9b(this.C))};q.INb=function(){this.F.Gv(this.C);var a=Sa(U9b(this.C));this.ea.a1(a.length);pYa(this.F,a||"  ");this.F.update(!0)};
function $ac(a,b,c){var d=Xa(U9b(a.C));if(!a.bb||3<=a.bb.getStatus().getState().C)d=uac(d,2),abc(a,d,!1);else{if(d&&a.Y)if(a.Na[d])a.L.Ob(2681,a.Ec),c=a.Na[d],c!=rb(a.D)&&(1<a.D.length&&(bbc(a),cbc(a)),dbc(a,c.x7()),g$b(a,c));else{var e=ebc(),g=ej(ej(e,PT,46),QV,4);P(g,2,a.Xa);a.L.Ob(2635,new Wo(10,e));a.Xa=!1;e=Kw(a.Y.rect);b=al(tj(bl(vj(wj(a.bb.Cf("/answers/parse").Ff("q",d,"qt",b,"gid",a.Y.vd,"range",e),y(a.Yj,a,d,b)),y(a.yXb,a,d,b)),"POST"),2));c&&b.Ff("sgfml",c);b.Se();a.Za=vJ(a.Lg,mj.nva);fbc(a,
!0)}else T9b(a.C,"");a.C.blur();a.J.setVisible(!!d);MF(a.F)&&a.F.zj()}}q.WAb=function(a){a.stopPropagation();a.preventDefault();$ac(this,2)};q.G4a=function(){T9b(this.C,"");this.J.setVisible(!1)};q.yXb=function(a,b){var c=ebc(),d=ej(ej(c,PT,46),QV,4);P(d,1,1==b||4==b?W9b.Pza:W9b.oAa);this.L.Ob(2640,new Wo(10,c));gbc(this,a)};function gbc(a,b){fbc(a,!1);b=uac(b,3);abc(a,b,!1);hbc(a)}
q.Yj=function(a,b,c){this.Kf.C.D.ue.then(function(){var d=null,e=null,g=!1,h=ebc(),k=ej(ej(h,PT,46),QV,4);P(k,1,1==b||4==b?W9b.Pza:W9b.oAa);h=new Wo(10,h);if(c.ql()){e=this.tj.kd(YV.Ca(),c.Mf());if(g=e.getStatus()){var l;switch(g){case 1:l=2639;break;case 2:l=2643;break;case 3:l=2644;break;case 4:l=2638;break;case 5:l=2707;break;case 6:l=2706}l&&this.L.Ob(l,h)}if(1==g){gbc(this,a);return}if(2==g){e=-1!=ibc(a);g=-1!=mac(a);h=4;e?h=5:g&&(h=7);g=uac(a,h);e?(e=new sW(g,!0,this.L,!0,this.oa),jbc(this,
g,e)):abc(this,g,!0);fbc(this,!1);hbc(this);return}l=e.hasFormula()?D(e,2):null;k=Ac(e,9)?e.getError().Fl():null;g=!0;if(l){d=kbc(this.Kf,l,this.Y,!!this.Xc&&!!D(this.Xc,4));if(!d){if(k=l.match(/([A-Z]*)\(/)){var m=ej(ej(h.C,PT,46),QV,4);P(m,7,k[1])}this.L.Ob(2645,h)}d=new oac(a,d,"="!=l[0]?"="+l:l,e,null)}else k&&(d=uac(a,6,e))}else this.L.Ob(2640,h);d||(d=uac(a,4,e));fbc(this,!1);1==d.error&&null!=d.Yn?lbc(this,d,g):abc(this,d,g);hbc(this)},function(){gbc(this,a)},this)};
function hbc(a){""!=a.Za&&(wJ(a.Lg,a.Za),a.Za="")}function mbc(a){if(null!=a.Yn)return Kac;switch(a.error){case 4:return 0<a.D.length?Lac:Jac;case 5:return Jac;case 6:return Lac}return Mac}function ebc(){var a=new QV,b=new PT;gj(b,4,a);a=new ko;gj(a,46,b);return a}function ibc(a){return Ab(zac,function(b){return Ma(a,b)})}function nbc(a){var b=[];a=a.D;0<a.length&&(a=Qb(a,0,3),b=vb(a,function(a){return{query:a.oh(),Yn:D(a,2),type:a.getType()}}));return Gj(b)}
function lbc(a,b,c){c=new rW(b,a.$e,a.yk,a.Ii,a.L,a.jb,c,a.oa);jbc(a,b,c)}function abc(a,b,c){c=new sW(b,c,a.L,!1,a.oa);jbc(a,b,c)}function jbc(a,b,c){bbc(a);cbc(a);dbc(a,b);obc(a,c);for(var d=a.D;5<d.length;)a.xL(d[0]);if(1==b.error&&null!=b.Yn){var d=a.Ka,e=b.C;d.D[e.toLowerCase()]||(d.D[e.toLowerCase()]=e)}c.jka()&&(a.Na[b.C]=c);a.getHandler().V(c,"rc",a.Sxb)}function cbc(a){0!=a.D.length&&(a.R?g$b(a,a.R):(a.R=new Gac(a.oa),obc(a,a.R)))}
function bbc(a){A(a.D,function(a){a instanceof rW||a instanceof sW||a==this.R||this.xL(a)},a)}function dbc(a,b){var c=mbc(b),d=null;c==Kac||c==Lac?0<b.D.length&&(d=nbc(b)):c==Jac&&(d=pbc(a.$g));d&&(c=new tW(new fW,d,b.C,c,a.oa),obc(a,c),a.L.Ob(2769,a.Ec),a.getHandler().V(c,"sqc",y(a.ZAb,a,b)))}q.ZAb=function(a,b){T9b(this.C,b.C);this.C.focus();$ac(this,b.Y,b.F);this.L.Ob(2762,this.Ec)};
function fbc(a,b){R(a.Tb,b);R(zn(a.oa,"waffle-assistant-answers-button-container",a.X),!b);a.Da&&a.Da.setActive(b)}function obc(a,b){b.We(a.Hd());a.D.push(b);a.Bd&&(a.O.Ci(b,0,!0),b.iP());UV(b,!0)}q.j5=function(){wW.Z.j5.call(this);this.reset()};
q.Sxb=function(a){var b=this.oa;a=a.target;a instanceof rW?(this.xL(a),Cac(this.jb,"Answer removed",b,y(this.Txb,this,a))):a instanceof sW&&(this.xL(a),Cac(this.jb,"Card removed",b));b=this.D;!this.R||b[0]!=this.R&&b[b.length-1]!=this.R||(this.xL(this.R),this.R=null)};q.Txb=function(a){lbc(this,a.x7(),a.jka());Cac(this.jb,"Remove answer undone",this.oa)};q.xL=function(a){if(a.qc()){if(a instanceof rW||a instanceof sW)delete this.Na[a.x7().C],a==rb(this.D)&&bbc(this);wW.Z.xL.call(this,a)}J(a)};function qbc(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
T(Lu({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+js("Ask a question about your data")+'" /></div></form></div>');return V(a)};function rbc(a,b){this.C=a;this.D=b}function kbc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=nw(a.D),e=null!=e?e.toString():"0",g=0,h=0;ritz.getActiveFilterId(e)&&c&&(c=c.rect,ritz.getNumberOfRows(e)>c.Qc()+1?g=c.Qc()+1:ritz.getNumberOfColumns(e)>c.Vc()+1&&(h=c.Vc()+1));(a=P9b(a.C,b,e,g,h))&&d&&(a=Oac(a));return a};function sbc(a){var b=[];if(Ac(a,25)&&(a=D(a,25)))for(var c=0;c<Bc(a,1);c++){var d=D(a,1,c);if(Ac(d,2)){var e=D(d,2);e&&b.push(tbc(e,ubc(d)))}}return b}function vbc(a){var b=sbc(a);Ac(a,6)&&(a=D(a,6))&&b.push(tbc(a,0));return b}function ubc(a){return(a=Ac(a,4)?D(a,4):0)?a:0}function tbc(a,b){return{name:a,IAa:b}};function wbc(a,b,c){this.va=a;this.ea=b;this.D=[];this.F=[];this.O=[];this.R=[];this.X=[];this.Y=[];this.C=new jg;this.L=new jg;this.$=new jg;this.J=new jg;xbc(this,c)}function ybc(a,b){return lg(a,b)?a.get(b).values.Cd():[]}
function xbc(a,b){for(var c=new rg,d=new rg,e=0;e<b.length;e++){for(var g=vbc(b[e]),h=[],k=[],l=0;l<g.length;l++){var m=g[l].name.toLowerCase();if(lg(a.va,m)){var p=a.va.get(m);c.add(p);h.push(p)}lg(a.ea,m)&&(m=a.ea.get(m),d.add(m),k.push(m))}zbc(a,h,k)}a.D=c.Cd();a.F=d.Cd();Ub(a.D);Ub(a.F);a.O=vb(a.C.Cd(),function(a){return a.key});Ub(a.O);a.R=vb(a.L.Cd(),function(a){return a.key});Ub(a.R);a.X=vb(a.$.Cd(),function(a){return a.key});Ub(a.X);a.Y=vb(a.J.Cd(),function(a){return a.key});Ub(a.Y)}
function zbc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)xW(a.C,b[d],b[e]),xW(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)xW(a.L,b[d],c[e]),xW(a.$,c[e],b[d]);for(d=0;d<c.length;d++)for(e=d+1;e<c.length;e++)xW(a.J,c[d],c[e]),xW(a.J,c[e],c[d])}function xW(a,b,c){var d;lg(a,b)?d=a.get(b).values:d=new rg;d.add(c);a.set(b,{key:b,values:d})};function Abc(a,b){this.C=a;for(var c=new jg,d=0;d<Bc(a,2);d++)c.set(a.Yd(d).getName().toLowerCase(),d);this.R=c;c=new jg;for(d=0;d<Bc(a,1);d++)c.set(D(a,1,d).getName().toLowerCase(),d);this.va=c;c=[];for(d=0;d<Bc(a,2);d++)yW(a.Yd(d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Bc(a,1);d++)yW(D(a,1,d).getName())&&c.push(d);this.O=c;c=[];for(d=0;d<Bc(a,1);d++){for(var e=D(a,1,d).getName(),g=!0,h=0;h<Bbc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Bbc[h]+"(\\b|_)","i"))){g=!1;break}g&&c.push(d)}this.ea=
c;this.$=Cbc(a,0);this.X=Cbc(a,1);c=[];for(d=0;d<Bc(a,2);d++).8<=D(a.Yd(d),6)&&c.push(d);this.Y=c;this.F=Dbc(Bc(a,2));this.J=Dbc(Bc(a,1));this.D=new wbc(this.R,this.va,b)}function Dbc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function Cbc(a,b){for(var c=[],d=0;d<Bc(a,2);d++)a.Yd(d).getType()==b&&c.push(d);return c}
function Ebc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Fbc(c,a[d]);for(d=0;d<b.length;d++)a=c,c=Fbc(a,b[d]),c=0<c.length?c:a;return 0<c.length?c[uW(c.length)]:-1}function Gbc(a,b,c,d,e){var g=[a.L,a.D.D],h=[a.F];b&&(h.push(a.$),h.push(a.Y));c&&h.push(Fc(a.C,3));null!=e&&-1!=e?g.push(ybc(a.D.L,e)):d&&g.push(a.D.R);return Ebc(h,g)}function zW(a,b,c){var d=[a.O,a.D.F],e=[a.J];b&&e.push(a.ea);c&&d.push(a.D.X);return Ebc(e,d)}
function Hbc(a,b){for(var c=5;;){var d=a.C.Yd(b),e=uW(Bc(d,2));c--;if(yW(D(d,2,e))||0==c)return e}}function AW(a,b){b=a.C.Yd(b);a=b.getName();yW(a)||(b=Ibc(Fc(b,7)),a=null==b?a:b);return a}function BW(a,b){b=D(a.C,1,b);a=b.getName();yW(a)||(b=Ibc(Fc(b,2)),a=null==b?a:b);return a}function Ibc(a){for(var b=0;b<a.length;b++)if(yW(a[b]))return a[b];return null}function yW(a){return null==a?!1:50>=a.length}function Jbc(a){for(var b=Nac(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}
function Fbc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Bbc=["average","total","sum","mean","median"];function Kbc(a){this.C=[];this.D=[];this.J=this.L=this.F=null;this.R=new rg;this.O=new rg;this.X=a}Kbc.prototype.reset=function(){this.C=[];this.D=[];this.F&&(this.F.cancel(),this.F=null);this.O=new rg;this.R=new rg};Kbc.prototype.vh=ea("J");function Xac(a,b){if(joa)return a.F.then(function(){var a=this.D.slice();b||Z9b(a);return a},null,a);a=a.C.slice();b||Z9b(a);return Gj(a)}
function Lbc(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function CW(a,b,c,d){a.O.contains(c)||(b.push({query:c,Yn:void 0,type:d}),a.R.add(d),a.O.add(c))}function DW(a,b){return!a.R.contains(b)}function pbc(a){return Xac(a,koa).then(function(a){return 3>=a.length?a:Qb(a,0,3)},null,a)}function Mbc(a,b){var c=[];b=sbc(b);for(var d=0;d<b.length&&-1!=a.va.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}
function Nbc(a){switch(a){case 6:return"Sum";case 1:return"Average";case 4:return"Count"}return null}function EW(a){return a[uW(a.length)]}
function Obc(a){var b=null;a.F=new Ej(function(a){if(!this.J||3<=this.J.getStatus().getState().C)this.D=this.C,a();var c=Kw(this.L.rect),e=vb(this.C,function(a){return a.query});b=bl(al(tj(vj(wj(this.J.Cf("/answers/parsesuggestions").Ff("gid",this.L.vd,"range",c),y(function(b){Pbc(this,b).then(a)},this)),y(function(){this.D=this.C;a()},this)).setContent(["queries",Xi(e)]).setTimeout(2E3),1)),"POST").Se()},a);Lj(a.F,function(){b&&b.dispose()})}
function Pbc(a,b){return a.X.C.D.ue.then(function(){var a=[];if(b.ql())for(var d=b.Mf(),e=0;e<d.length;e++){var g;if(g=d[e])a:{if(g=kbc(this.X,d[e],this.L,!1))for(var h=1<g.length?1:0;h<g.length;h++){for(var k=!1,l=g[h],m=0;m<l.length;m++)if(!l[m]){k=!0;break}if(!k){g=!0;break a}}g=!1}g&&(this.C[e].Yn=d[e],a.push(this.C[e]))}this.D=a},function(){this.D.length=0},a)}var Qbc="Minimum Maximum Most Least Highest Lowest".split(" "),Rbc=["Average","Total","Sum"],Sbc=["before","after"];function FW(a,b,c,d,e,g,h){VV.call(this,1,g,e,h);this.Xa=c;this.ea=null;this.Y=new ht("",new hW,this.oa);this.Ma(this.Y);this.$=new ht("",new hW,this.oa);this.Ma(this.$);a=new Ykb(a,!0,!0);a=new rbc(a,c);this.L=new Kbc(a);this.C=new wW(this.L,0,b,c,d,e,this.Ua,a,h);this.F=this.Da=null;this.Ec=Yo(new Xo,10).Fa()}z(FW,VV);
var Tbc={d_a:"waffle-assistant-answers-input-box",q0a:"waffle-assistant-answers-query-box",lkc:"waffle-assistant-answers-query-box-focused",n_a:"waffle-assistant-answers-learn-more",ngc:"waffle-assistant-answers-logging-message-container",U_a:"waffle-assistant-answers-logging-opt-out"};q=FW.prototype;q.Sa=function(){FW.Z.Sa.call(this);var a=Qr(qbc);this.oa.appendChild(h$b(this),a)};
q.Ha=function(){FW.Z.Ha.call(this);var a=S(this,Tbc.q0a),b=S(this,Tbc.d_a);this.$.Va(S(this,Tbc.U_a));this.Y.Va(S(this,Tbc.n_a));this.getHandler().V(a,"focus",this.fxb,!0).V(a,"blur",this.dxb,!0).V(a,"mouseover",this.hxb).V(a,"mouseout",this.gxb).V(a,"click",this.exb).V(b,"input",this.zXb).V(this.$,"action",this.Fvb).V(this.Y,"action",this.Asb).V(rw(this.Xa),"Ib",Y9b(this.AXb,25,this));this.setVisible(null!=this.Da);Ubc(this,foa&&loa&&vm("showAnswersLoggingOptOut"))};q.cUa=Kf;q.LMa=Lf;q.Nsa=Kf;
q.DU=n("Answers");q.Kda=n(1);q.a5=function(a){return 3==a||0==a};q.Qua=function(a,b){Ub(a,function(a,b){return b.wT()-a.wT()});for(var c=[],d=null,e=0;e<a.length;e++){var g=Gc(a[e],1);3==g?d=a[e]:0==g&&c.push(a[e].getAutovisRecommendation())}d&&d.wT()?(e=b||null,0<Bc(d,4)?Vbc(this,JT(d.UJ()),D(d,9),c):Vbc(this,e,D(d,9),c),this.F||(FW.Z.Qua.call(this,a,b),this.getHandler().V(this.F,"sqc",this.YAb))):this.t2(!0)};q.yX=function(a){if(!this.F){var b=pbc(this.L);this.F=new tW(a,b,"",Iac,this.oa)}return this.F};
q.PCa=f("C");q.Kna=function(){return this.Ta()};q.t2=function(a,b,c){this.L.reset();(a||b)&&this.F&&(FW.Z.t2.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(FW.Z.t2.call(this,a,b,c),this.F.dispose(),this.F=null),this.qc()&&(this.L.reset(),this.Da=null,a=this.C,a.qc()&&(b=a.Ka,b.J=[],b.C.clear(),a.C&&T9b(a.C),a.j5(),a.Y=null,a.aM(!0),a.J&&!a.J.isDisposed()&&a.J.setVisible(!1),a.Xa=!1),this.setVisible(!1),this.Nb()&&Zac(this.C));c&&this.C.reset()};
q.vh=function(a){this.ea=a;this.C.vh(a);this.L.vh(a)};q.setActive=function(a){FW.Z.setActive.call(this,a);a?Yac(this.C):Zac(this.C)};function Ubc(a,b){R(S(a,"waffle-assistant-answers-logging-message-container"),b)}function Wbc(a,b){a=S(a,"waffle-assistant-answers-query-box");Jp(a,"waffle-assistant-answers-query-box-focused",b)}q.AXb=function(){this.Nb()&&Yac(this.C)};q.fxb=function(){Wbc(this,!0);Yac(this.C)};q.dxb=function(){Wbc(this,!1);this.Nb()||Zac(this.C)};q.hxb=function(){Yac(this.C)};
q.gxb=function(){this.Nb()||Zac(this.C)};q.exb=function(){Xbc(this,"")};q.zXb=function(){var a=S(this,"waffle-assistant-answers-input-box");Xbc(this,a.value);a.value=""};q.YAb=function(a){Xbc(this,a.C);fl(y(function(a){$ac(this.C,1,a)},this,a.F),150,this);this.O.Ob(2652,this.Ec)};function Xbc(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");fl(function(){var a=this.C;T9b(a.C,b);a.C.focus()},150,a)}
function Vbc(a,b,c,d){c=c||new cW;a.Da=b;var e=a.L,g=d;e.reset();g=koa?g:[];d=[];var h=new Abc(c,g);if(koa)for(var k=0;k<g.length;k++){var l=g[k];switch(l.getChartType()){case "BarChart":var m=e,p=h,r=l,l=d;if(DW(m,12)||DW(m,1)){var t=D(r,6);if(t&&-1!=p.R.get(t.toLowerCase(),-1)){p=Mbc(p,r);if(0<p.length){var r=EW(p),w=Nbc(r.IAa);w&&DW(m,12)&&CW(m,l,w+" of "+r.name+" by "+t,12)}1<p.length&&DW(m,1)&&CW(m,l,"Correlation between "+p[0].name+" and "+p[1].name,1)}}break;case "ScatterChart":m=e;t=h;p=l;
l=d;DW(m,1)&&(t=Mbc(t,p),1<t.length&&CW(m,l,"Correlation between "+t[0].name+" and "+t[1].name,1));break;case "PieChart":if(m=e,t=h,r=l,l=d,DW(m,13)){p=[];r=sbc(r);for(w=0;w<r.length&&-1!=t.R.get(r[w].name.toLowerCase(),-1);w++)p.push(r[w]);t=p;1==t.length&&4==t[0].IAa&&CW(m,l,"Distribution of "+t[0].name,13)}}}DW(e,0)&&(g=zW(h,!1,!0),k=Gbc(h,!0,!1,!0,g),-1!=k&&-1!=g&&(k=AW(h,k),g=BW(h,g),k!=g&&CW(e,d,"Top "+k+" by "+g,0)));if(DW(e,1)&&1<Bc(h.C,1)){a:if(2>h.J.length)k=[-1,-1];else{k=Ebc([h.J],[h.O,
h.D.F,h.D.Y]);if(-1!=k&&(g=ybc(h.D.J,k),0<g.length)){k=[k];m=uW(g.length);k.push(g[m]);break a}k=Jbc(2<=h.O.length?h.O:h.J)}g=BW(h,k[0]);k=BW(h,k[1]);g!=k&&CW(e,d,"Correlation between "+g+" and "+k,1)}DW(e,2)&&(g=zW(h,!0),-1!=g&&CW(e,d,EW(Rbc)+" of "+BW(h,g),2));if(DW(e,4)&&(m=h.C,k=zW(h,!0,!0),g=Gbc(h,!0,!1,!0,k),-1!=k&&-1!=g&&(k=BW(h,k),m=m.Yd(g),l=AW(h,g),0<Bc(m,3)&&l!=k))){a:for(t=5;;)if(p=h.C.Yd(g),r=uW(Bc(p,3)),w=D(p,3,r),t--,yW(D(p,2,r))||0==t){g=w;break a}CW(e,d,EW(Rbc)+" of "+k+" when "+
l+" is "+D(m,2,g),4)}DW(e,8)&&(k=zW(h,!1,!0),g=Gbc(h,!0,!1,!0,k),-1!=g&&-1!=k&&(k=BW(h,k),g=AW(h,g),g!=k&&CW(e,d,g+" with "+EW(Qbc)+" "+k,8)));DW(e,9)&&0<Bc(h.C,1)&&(g=BW(h,zW(h)),CW(e,d,EW(Qbc)+" "+g,9));DW(e,10)&&(g=h.C,k=Gbc(h,!0,!0),-1!=k&&(m=AW(h,k),0<Bc(g.Yd(k),3)&&CW(e,d,"Most frequent "+m,10)));if(DW(e,11)){g=h.C;m=zW(h,!0);a:{if(1==h.X.length&&(k=h.X[0],!D(h.C.Yd(k),5)))break a;k=-1}-1!=k&&-1!=m&&(m=BW(h,m),g=g.Yd(k),0<Bc(g,2)&&(k=Hbc(h,k),CW(e,d,EW(Rbc)+" of "+m+" "+EW(Sbc)+" "+D(g,2,k),
11)))}((g=3>d.length)||0==uW(5))&&DW(e,6)&&(m=h.C,t=zW(h,!1,!0),k=Gbc(h,!1,!1,!0,t),-1!=k&&-1!=t&&(m=m.Yd(k),l=AW(h,k),t=BW(h,t),0<Bc(m,2)&&l!=t&&(k=Hbc(h,k),CW(e,d,"Show "+t+" for "+l+" "+D(m,2,k),6))));if((g||0==uW(5))&&DW(e,7)){g=h.C;a:if(2>h.F.length)m=[-1,-1];else{k=[h.L,h.D.D,h.D.O];m=[h.F];m.push(h.$);m.push(h.Y);l=Ebc(m,k);if(-1!=l&&(k=ybc(h.D.C,l),0<k.length)){m=[l];l=uW(k.length);m.push(k[l]);break a}m=Jbc(2<=h.L.length?h.L:h.F);m[0]!=l&&(m[1]=m[0],m[0]=l)}k=m[0];1<Bc(g,2)&&-1!=k&&(m=m[1],
g=g.Yd(m),l=AW(h,m),k=AW(h,k),0<Bc(g,2)&&l!=k&&(h=Hbc(h,m),CW(e,d,"What is "+k+" where "+l+" is "+D(g,2,h),7)))}e.C=d;e.L=b;joa&&Obc(e);a.setVisible(null!=b);Wac(a.C,b,c);a.Nb()&&Yac(a.C)}q.Fvb=function(a){a.stopPropagation();a.preventDefault();this.ea&&(bl(vj(wj(this.ea.Cf("/answers/logoptout"),y(this.itb,this)),y(this.htb,this)),"POST").Se(),this.O.Ob(2663,this.Ec))};
q.Asb=function(a){a.stopPropagation();a.preventDefault();$o("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.itb=function(a){a.ql()&&Ubc(this,!1)};q.htb=da();function Ybc(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+Zbc()+"</div>");return V(a)}
function $bc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+Zbc()+"</div>")}function Zbc(){var a;a=""+T(nt({Fe:"waffle-assistant-formatting-edit-button",content:fs("Edit"),style:4}));return V(a)};function GW(a,b,c){kW.call(this,a,c);a=vb(this.D.zga(),p6b);this.C=new zU(!1,a,7);this.Ma(this.C);this.O=new ot("",this.oa);this.Ma(this.O);this.R=b;this.L=!1;this.J=-1}z(GW,kW);var acc={cea:"waffle-assistant-banding-color-picker-container",mea:"waffle-assistant-formatting-edit-button",ZH:"waffle-assistant-banding-range"};q=GW.prototype;q.Sa=function(){GW.Z.Sa.call(this);lW(this).appendChild(Qr(Ybc))};
q.Ha=function(){GW.Z.Ha.call(this);this.getHandler().V(this.O,"action",this.Fob).V(this.C,"banding-scheme-changed",this.Vjb);this.R.Ob(2768,void 0)};q.Az=function(a){var b=S(this,acc.cea);this.C.render(b);v6b(this.C);var b=S(this,acc.ZH),c=this.D.UJ(),d=Rh(c);on(b,Kw(d));bcc(this,c);b=S(this,acc.mea);this.O.Va(b);a()};q.rz=function(){Cp(this.Ba,"Suggested alternating background colors");pr(this.C,"Choose a color scheme")};q.oy=n("assistantBandingFeedback");q.FE=n(2672);q.CE=n(2671);
q.Fob=function(a){Un.dispatchEvent({type:"show-banding-pane-recommendation",WRa:this.D,G5a:w6b(this.C)});a.stopPropagation()};q.Vjb=function(a){if(!this.L&&AU(this.C)){var b=this.J;this.J=this.C.gi();this.J==b?this.dispatchEvent(new RV("assistant-sidepane-remove-banding",this,2797)):this.dispatchEvent(new RV("assistant-sidepane-apply-banding",this,2673));a.stopPropagation()}};
function bcc(a,b){a.L=!0;var c;c=b.eb();b=Rh(b);c=ritz.getWorkbookRangeIntersectingIds(c,b.gc(),b.Wb(),b.Qc(),b.Vc(),7,!1);c.length?(c=ritz.getBandedRangeByWorkbookRangeId(c[0]),c=(new Li).kd(Fd.Ca(),c),c=p6b(c)):c=null;c?(c=x6b(a.C,c),gL(a.C,c?c.getElement():null)):gL(a.C,null);a.J=a.C.gi();a.L=!1};function HW(a,b){kW.call(this,a,b);this.C=new ot("",this.oa);this.Ma(this.C);this.jb=Fc(a,6)}z(HW,kW);var IW={mea:"waffle-assistant-formatting-edit-button",HZa:"waffle-assistant-conditionalformat-format-preview",L0a:"waffle-assistant-conditionalformat-rule-holder",S2:"waffle-assistant-conditionalformat-description",R_a:"one-rule",L1a:"two-rules",z1a:"three-rules",j0a:"waffle-assistant-conditionalformat-format-preview-label"};q=HW.prototype;q.Sa=function(){HW.Z.Sa.call(this);lW(this).appendChild(Qr($bc))};
q.Ha=function(){HW.Z.Ha.call(this);var a=S(this,IW.mea);this.C.Va(a);SV(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.tjb)};q.Az=function(a){on(S(this,IW.S2),Gc(this.D,3));var b=S(this,IW.L0a),c=new ccc(this,this.oa);this.Ma(c);c.Va(b);SV(b,"Apply conditional format rules");a()};q.rz=oa;q.oy=n("assistantConditionalFormatFeedback");q.FE=n(2630);q.CE=n(2629);
q.tjb=function(){dcc(this);this.dispatchEvent(new RV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Rh(D(this.jb[0],1,0))));Yn()};function dcc(a){a.dispatchEvent(new RV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function ccc(a,b){mr.call(this,void 0,void 0,b);this.C=a}z(ccc,mr);
ccc.prototype.Ge=function(a){ccc.Z.Ge.call(this,a);var b=this.C.jb,c;switch(b.length){case 0:break;case 1:c=IW.R_a;break;case 2:case 4:c=IW.L1a;break;default:c=IW.z1a}for(var d=0;d<b.length;d++){var e=b[d],g=Vm("DIV");Gp(g,[IW.HZa,c]);var h=Vm("DIV");Fp(h,IW.j0a);g.appendChild(h);on(h,"123");if(Ac(e,2)){var k=D(D(e,2),1);switch(D(D(k,1),1)){case 9:case 13:var k=Fc(D(k,1),2)[0],l=Fc(e,1)[0];on(h,JF(k,Gc(l,1),Gc(l,2),Gc(l,4)))}}J5b(e,g);a.appendChild(g)}};ccc.prototype.jj=function(){dcc(this.C);return!0};function ecc(a,b,c){VV.call(this,2,b,a,c)}z(ecc,VV);q=ecc.prototype;q.DU=n("Formatting");q.a5=function(a){return 2==a||4==a};q.yX=function(a){var b=D(a,1);switch(b){case 2:return new HW(a,this.oa);case 4:return a=new GW(a,this.O,this.oa),this.getHandler().V(a,"assistant-sidepane-apply-banding",this.HPb).V(a,"assistant-sidepane-remove-banding",this.LDb),a;default:throw Error("Unsupported recommendation type: "+b);}};
q.HPb=function(a){Cac(this.Ua,"Alternating colors applied",this.oa,y(this.Wjb,this,a.C))};q.LDb=function(){this.Ua.clear()};q.Wjb=function(a){this.dispatchEvent(new RV("assistant-undo-pressed",a,2796))};q.We=function(a){ecc.Z.We.call(this,a);this.setVisible(!a)};q.Rua=function(a){return this.Hd()?(this.setVisible(!1),a):ecc.Z.Rua.call(this,a)};q.Kda=n(3);function JW(a,b,c,d){Ru.call(this,a,b,c,d,void 0,void 0,!0)}z(JW,Ru);JW.prototype.Sa=function(){JW.Z.Sa.call(this);Fp(this.Ba,"waffle-assistant-toast");Fp(S(this,"docs-ui-toast-content"),"waffle-assistant-toast-content")};JW.prototype.sI=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Dq(this,b);JW.Z.sI.call(this,a,b,c)};JW.prototype.Gi=function(a,b,c,d){this.sI(a,b,d);a=Fq(this,b);If(this.getHandler(),a,nd,y(function(){this.setVisible(!1);c()},this))};function fcc(){this.C=null}z(fcc,H);fcc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function Cac(a,b,c,d){a.clear();a.C=new JW(b,c,!1,5E3);a.C.render();d&&a.C.Gi("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}fcc.prototype.ma=function(){fcc.Z.ma.call(this);this.clear()};function gcc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+T(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+js("Press enter to insert formula")+'"></span></div>');return V(a)};function KW(a,b){yq.call(this);this.C=a;this.D=b}z(KW,yq);q=KW.prototype;q.Sa=function(){this.Ba=Qr(gcc,{name:this.C,title:this.D})};q.Ha=function(){KW.Z.Ha.call(this);var a=S(this,"waffle-assistant-quicksum-entry-name");SV(a);this.getHandler().V(this.Ba,"keypress",this.gXb);R(this.Ba,!1)};q.getFunctionName=f("C");q.Wa=function(a){on(S(this,"waffle-assistant-quicksum-entry-value"),a||"");R(this.Ba,!!a)};q.Ta=function(){return hq(this.Ba)};
q.gXb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new K("insert",this)))};function LW(a,b,c,d,e){yq.call(this,e);this.Da=a;this.$=b;this.O=c;this.L=d;this.D=a.C;this.ea=new Li;this.X=Yo(new Xo,17).Fa();this.R=Yo(new Xo,2).Fa();this.Hf=!1;this.F=[];this.C=null;this.J=[]}z(LW,yq);
LW.prototype.Ha=function(){LW.Z.Ha.call(this);this.Ci(new KW(ritz.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Ci(new KW(ritz.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Ci(new KW(ritz.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Ci(new KW(ritz.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Ci(new KW(ritz.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new qW(this.Ba,this.$,this.D,this.O);this.C.We(this.Hf);I(this,this.C);this.getHandler().V(this,"insert",
this.Y).V(this.C,"formula_inserted",this.Ka)};
function hcc(a){function b(a){return l?ritz.renderNumberAsFormattedString(a,m):null}if(sw(a.D)){var c=tw(a.D),d=Vx(c),e=sJ(a.D);if(yb(d,c.Ls,c)){var g=[];a.F=[];for(c=0;c<d.length;c++){var h=d[c],k=eha(e+"",h.gc(),h.Wb(),h.Qc(),h.Vc());g.push(a.ea.serialize(k));a.F.push(h)}if(d=ritz.quickSum(g)){R(a.Ba,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.zd(0).Wa(b(d.sum));a.zd(1).Wa(b(d.average));a.zd(2).Wa(b(d.min));a.zd(3).Wa(b(d.max));1<e?a.zd(4).Wa(ritz.renderNumberAsFormattedString(e,
c)):R(a.Ba,!1);if(a.C){a.C.L=[];a.J=[];for(c=0;c<a.od();++c)d=a.zd(c),a.J.push(icc(a,d.getFunctionName()));a.C.L=a.J}}else R(a.Ba,!1)}else R(a.Ba,!1)}else R(a.Ba,!1)}LW.prototype.We=function(a){this.Hf=a;this.C&&this.C.We(a);Jp(this.Ba,"waffle-assistant-quicksum-panel-readonly",a)};LW.prototype.Y=function(a){var b=a.target;a=this.F[0];a=new N(a.left,a.Qc());b=b.getFunctionName();b=icc(this,b);a=new mF(tw(this.D),a,b);this.O.C(a);this.L.Ob(2624,this.R)};LW.prototype.Ka=function(){this.L.Ob(2624,this.X)};
function icc(a,b){var c=Rw(a.Da.O);a=vb(a.F,function(a){return Kw(a)});return"="+b+"("+a.join(c)+")"};function jcc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+T(nt({content:fs("INSERT CHART"),style:4,Fe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+T(nt({Fe:"waffle-autovis-lightbox-close",content:gs(""+T(Lu({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:fs("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
T(nt({content:gs("&#10094;"),style:4,Fe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:hs('aria-label="'+js("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+T(nt({content:gs("&#10095;"),style:4,Fe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:hs('aria-label="'+js("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
T(a.zHb)+"</div></div></div>");return V(a)}function kcc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function MW(a,b,c){yq.call(this,c);this.F=a;this.D=b;this.J=[];this.C=new ot("",this.oa);this.Ma(this.C);this.R=new ot("",this.oa);this.Ma(this.R);this.O=new ot("",this.oa);this.Ma(this.O);this.L=new ot("",this.oa);this.Ma(this.L)}z(MW,yq);q=MW.prototype;q.Sa=function(){MW.Z.Sa.call(this);this.Ba=Qr(jcc,{zHb:this.F.length})};
q.Ha=function(){MW.Z.Ha.call(this);var a=X.nH.isEnabled();this.We(!a);a=S(this,"waffle-autovis-lightbox-close");this.C.Va(a);a=S(this,"waffle-autovis-lightbox-insert");this.R.Va(a);var b=S(this,"waffle-autovis-lightbox-previous");this.O.Va(b);b=S(this,"waffle-autovis-lightbox-next");this.L.Va(b);lcc(this);mcc(this,this.D,!1);this.getHandler().V(document.body,dd,this.xSb).V(this.Ba,"keydown",this.ySb).V(Um(),"resize",this.BSb).V(this.C,"action",this.close).V(this.R,"action",this.Lrb).V(this.O,"action",
this.ASb).V(this.L,"action",this.zSb);b=new yv(this.Ba,this.oa);zv(b);I(this,b);a.focus()};function lcc(a){var b=S(a,"waffle-autovis-lightbox-content"),c=S(a,"waffle-autovis-lightbox-content-inner");a=S(a,"waffle-autovis-lightbox-page-count");var d=Sm();a=eq(a);var e=d.height-a.height-195,g=d.width-200;.75<e/g?(d=g,e=.75*g):d=e/.75;aq(c,d,e);aq(b,d,e+a.height+35)}q.We=function(a){Jp(this.Ba,"waffle-autovis-lightbox-readonly",a)};
function mcc(a,b,c){c&&Xn("Page "+(b+1+(" of "+(a.F.length+"."))));a.J[b]?ncc(a,b):a.F[b]&&$$b(a.F[b],y(a.glb,a,b),!0)}q.glb=function(a,b){if(!this.isDisposed()&&b){var c=S(this,"waffle-autovis-lightbox-container"),d=Qr(kcc);c.appendChild(d);this.J[a]=d;GV(b,d,qm);ncc(this,a)}};function ncc(a,b){R(a.J[a.D],!1);R(a.J[b],!0);a.O.Qa(0!=b);a.L.Qa(b!=a.F.length-1);var c=S(a,"waffle-autovis-lightbox-page-number");on(c,b+1);a.D=b}q.xSb=function(a){!ln(this.Ba,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.ySb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&mcc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||occ(this);a.stopPropagation()};q.BSb=function(){var a=S(this,"waffle-autovis-lightbox-container");an(a);this.J=[];lcc(this);mcc(this,this.D,!0)};q.Lrb=function(){this.close();cac(this.F[this.D],2256)};q.ASb=function(){0!=this.D&&mcc(this,this.D-1,!0);0==this.D&&this.L.Ba.focus()};q.zSb=function(){occ(this);this.D==this.F.length-1&&this.O.Ba.focus()};
function occ(a){a.D!=a.F.length-1&&mcc(a,a.D+1,!0)}q.close=function(){this.dispose()};q.Ad=function(){MW.Z.Ad.call(this);var a=this.F[this.D];a&&a.Ba&&a.Ba.focus()};function pcc(a,b){L.call(this);this.Za=a;this.mb=b;this.F=a.C;this.Da=new Li;this.La=Uj();this.J=Uj();this.bc=this.C=this.D=this.L=this.O=this.va=this.Y=null;this.$a=!1;this.$=null;this.Xa=!0;this.Pa=this.Ka=!1;this.Na=this.Ua=null;this.R=uJ.getInstance();this.Ga=this.ea="";b=this.Za.O.Ur();this.X=new gW;E(this.X,2,Pna);a=uoa&&!a.Hd();E(this.X,3,a);E(this.X,4,moa);a=pm&&"en"==ZD(b);E(this.X,5,a);E(this.X,6,poa);E(this.X,7,voa);E(this.X,10,!1);a=new M(this);I(this,a);a.V(this.mb,"Ca",this.IXb)}
z(pcc,L);var qcc={M1b:"cu",VXa:"cs",UXa:"ce",u_a:"ls",t_a:"le"};q=pcc.prototype;q.update=function(a,b,c){c&&this.C&&!zb(c,function(a){return Zga(a,this.C.rect)},this)||(this.La.cancel(!0),this.Y&&this.Y.cancel(!0),a&&(this.Pa=!0,this.J.cancel(!0),this.D=this.L=this.O=this.va=null),this.La=rcc(),this.La.addCallback(this.P3a,this),this.La.addCallback(Fa(this.Q3a,b),this))};q.vh=ea("Ua");q.IXb=function(){this.Y&&3==this.mb.getState()&&(this.Y.Hb(),this.Y=null)};
function rcc(){var a=null,b=new Nj(function(){null===a||gl(a)}),a=fl(function(){b.Hb()});return b}q.rkb=function(){this.Ka=!0};q.P3a=function(){var a=this.F.getActiveGrid();if(a){var b=tw(this.F),c=Vx(b),d=scc(this,c||[]),e=scc(this,this.bc||[]);d&&!e||!d&&!tcc(c,this.bc)?(this.D=null,this.$a=!0):this.$a=!1;this.bc=c;var g=$C(b).clone();A(Vx(b),function(a){yh(g,a)});this.$=new Mh(a.eb(),"",g)}else this.$=null};
q.Q3a=function(a){this.ea=vJ(this.R,mj.Fwa);var b=this.F.getActiveGrid(),c=this.$&&this.$.vd;if(!b||b.eb()!=c||null===c)return this.$=null;var d=this.F.getActiveGrid().D,b=qB(d,this.$.rect);b.addCallback(function(){if(!this.F.getActiveGrid()||nw(this.F)!=c)return null;var b=tw(this.F),g=tB(b,this.$.rect,hc(Xg),a?void 0:500),h=nB(b.F,"r"),k=b.Xm("r");return!b.Ls(g)||h>=g.gc()&&zKa(b)||k<=g.Qc()&&yKa(b)?(this.dispatchEvent(new K("ls")),sB(d,g,hc(Xg),a?void 0:500).addCallback(this.p6a,this)):g},this);
b.addCallback(function(a){var b=this.F.getActiveGrid();return a&&b&&b.eb()==c&&null!==c?ucc(this,a,tw(this.F)):null},this);b.addCallback(function(b){b=b&&new Mh(c,"",b);if(null===b&&null!==this.C||null!==b&&!b.equals(this.C))this.D=this.L=this.O=this.va=null;var d=null!==b&&b.equals(this.C);if(d=this.Pa||this.$a||!d&&(null===this.O||null!==this.L&&null===this.D))this.Xa=this.Ka&&this.Xa||!this.C||!b||!b.rect.intersects(this.C.rect);var e=null!==b&&b.contains(this.C);this.C=b;""!=this.ea&&(wJ(this.R,
this.ea),this.ea="");d&&(a&&(this.Ga=vJ(this.R,mj.Gwa)),this.J.cancel(!0),this.J=Uj(),this.J.addCallback(this.X3a,this),this.J.addCallback(this.m6a,this),a&&(this.J.addCallback(Fa(this.i6a,e),this),this.Ua&&!dy(this.Za)&&qoa?this.J.addCallback(this.Lfb,this):(this.J.addCallback(this.U3a,this),this.J.addCallback(this.V3a,this)),this.J.addCallback(this.h6a,this)),Qj(this.J,this.rkb,this))},this);return b};
q.X3a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.va){var a=vJ(this.R,mj.qva);this.va=ritz.getAssistantConfidence(""+this.C.vd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.Da.serialize(this.X));wJ(this.R,a)}};q.p6a=function(){this.dispatchEvent(new K("le"))};q.m6a=function(){this.dispatchEvent(new vcc(this.C,this.va))};q.i6a=function(a){a=new wcc(a,this.Pa);this.Pa=!1;this.dispatchEvent(a)};
q.Lfb=function(){if(null===this.C||null===this.C.rect||null!==this.L&&null!==this.D)return null;J(this.Na);return 3!=this.mb.getState()?(this.Y=new Nj,this.Y.addCallback(this.dTa,this),this.Y):this.dTa()};
q.dTa=function(){var a=vJ(this.R,mj.Iwa),b=xcc(this),c=b&&!b.oOa,b=ritz.getAssistantRequestProto(this.C.vd.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Be:[]),b=this.Da.kd(eW.Ca(),b),c=new Li;c.Rv=!0;var b=Xi(c.serialize(b)),d=new Nj;this.Na=vj(wj(tj(al(bl(this.Ua.Cf("/explore/getrecommendations").Ff("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=vJ(this.R,mj.Hwa);b=ycc(this,b.Mf());wJ(this.R,c);this.L=Fc(b,
1);this.D=Fc(b,2);this.Na=null;wJ(this.R,a);d.Hb()},this),function(){this.L=[];this.D=[];d.Hb()},this).Se();return d};
q.U3a=function(){function a(){b=null;ritz.continueAssistantRecommendation(this.O)?(this.L=Fc(ycc(this,ritz.getAssistantRecommendations(this.O)),1),d.Hb()):b=fl(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.L)return null;this.O=ritz.newAssistantRecommender(this.Da.serialize(this.X));this.D=this.L=null;ritz.startAssistantRecommendation(this.O,""+this.C.vd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var b=null,c=
y(function(){null!==b&&(gl(b),this.D=this.L=this.O=b=null)},this),d=new Nj(c),b=fl(a,5,this);return d};q.V3a=function(){var a=xcc(this);a&&this.O&&null===this.D&&(this.D=a.oOa?[]:Fc(ycc(this,ritz.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.Be)),2))};q.h6a=function(){this.Ka=!1;var a=this.D&&0<this.D.length?this.D:this.L;""!=this.Ga&&(wJ(this.R,this.Ga),this.Ga="");this.dispatchEvent(new zcc(this.C,a||[],this.Xa))};function ycc(a,b){return a.Da.kd(dW.Ca(),b)}
function ucc(a,b,c){b=b.clone();fc(Xg,function(a){for(var d=!0;d&&b;){for(var g=ah(a),h=0;h<(g?b.width:b.height);h++){var k=Gh(b,a),l=g?b.Wb():b.gc();if(g&&!sJb(c.sf(k,l+h))||!g&&!sJb(c.sf(l+h,k))){d=!1;break}}d&&(cha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function tcc(a,b){return Wb(a,b,function(a,b){return zh(a,b)})}
function xcc(a){var b=a.F.getActiveGrid();if(!b||!a.C||b.eb()!=a.C.vd)return null;for(var c=Vx(tw(a.F)),c=vb(c,Fa(xh,a.C.rect)),c=ub(c,sa),d=vb(c,function(a){return new nh(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new rg,e=new rg,g=0;g<d.length;g++){for(var h=0;h<d[g].width;h++)e.add(d[g].left+h);for(h=0;h<d[g].height;h++)b.add(d[g].top+h)}a=scc(a,c);return{rows:b.Cd(),Be:e.Cd(),oOa:a}}
function scc(a,b){a.F.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(Ah(b)||0==Kh(b))return!0;a=tOa(tw(a.F).Y,b.top,b.left);return b.equals(a)}function vcc(a,b){K.call(this,"cu");this.C=a;this.F=b}z(vcc,K);function zcc(a,b,c){K.call(this,"ce");this.C=a;this.F=b;this.Y=c}z(zcc,K);function wcc(a,b){K.call(this,"cs");this.C=a;this.F=b}z(wcc,K);function NW(a,b,c,d,e,g){rU.call(this,g);this.Na=a;this.jb=b.C;this.Ka=c;this.Tb=d;this.L=e;this.Y=new LW(b,c,d,e,this.oa);this.Ma(this.Y);this.R=new JV(!1,"#4285f4");this.Ma(this.R);this.O=null;this.Hf=this.bb=!1;this.Xa=!0;this.Ua=uJ.getInstance();this.ea=this.$="";this.Ec=Yo(new Xo,10).Fa()}z(NW,rU);q=NW.prototype;q.Sa=function(){NW.Z.Sa.call(this);this.Ba=Qr(this.Tua(),{EPb:pm});Fp(this.Ba,"waffle-assistant-sidepanel")};q.Tua=v;
q.Ha=function(){NW.Z.Ha.call(this);var a=S(this,"waffle-assistant-quicksum-panel");this.Y.Va(a);a=S(this,"waffle-assistant-spinner-container");this.R.render(a);this.getHandler().V(this,"close-sidebar",this.xna).V(this.Na,qcc.u_a,this.lna).V(this.Na,qcc.t_a,this.kna).V(this.Na,qcc.VXa,this.Mma).V(this.Na,qcc.UXa,this.Lma).V(S(this,"waffle-assistant-scroll-pane"),"scroll",Y9b(this.u2,10,this));a=X.nH.isEnabled();this.We(!a)};
q.resize=function(){var a=S(this,"waffle-assistant-sidepane-content"),a=eq(a).height,b=S(this,"waffle-assistant-spinner-container");Mp(b,"margin-top",a/2-16+"px")};q.vh=oa;function Acc(a,b){var c=a.dH();0!=c.length&&(J(a.O),c=c.filter(function(a){return a instanceof mW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new MW(c,b,a.oa),a.O.render(),I(a,a.O),a.O.We(a.Hf)))}q.We=function(a){this.Hf=a;Jp(this.Ba,"waffle-assistant-readonly",a);this.Y.We(a);this.O&&!this.O.isDisposed()&&this.O.We(a)};
q.setVisible=function(a){var b=this.Ta();NW.Z.setVisible.call(this,a);a&&!b&&(this.ea=vJ(this.Ua,mj.Nwa),this.R.setActive(!0),OW(this));a||this.EU(!0)};q.lna=function(){this.Ta()&&(this.EU(!0),this.R.setActive(!0),OW(this))};q.kna=function(){this.Ta()&&(this.R.setActive(!1),OW(this))};q.Mma=function(a){this.Ta()&&(this.L.Ob(2775,this.Ec),this.EU(void 0,a.C,a.F),this.H$()||this.R.setActive(!0),OW(this),this.Xa=!1)};
q.Lma=function(a){if(this.Ta()){this.L.Ob(2776,this.Ec);var b=a.F;0<b.length&&(this.$=vJ(this.Ua,mj.Lwa));this.EU(!1);this.R.setActive(!1);this.Sua(b,a.C);a=a.Y;b=this.dH();0<b.length&&this.bb&&(b[b.length-1].Tb=!0);this.bb=!1;OW(this);this.Uua(a);this.u2()}};q.Sua=v;q.Uua=v;q.EU=v;q.Cka=v;function OW(a){var b=a.H$(),c=hq(S(a,"waffle-assistant-quicksum-panel")),d=a.R.Nb(),b=b||c||d,c=a.Cka();a=S(a,c);R(a,!b)}q.H$=v;q.u2=v;q.dH=v;q.RHa=Mf;
function Bcc(a){return S(a,"waffle-assistant-scroll-pane").scrollTop+eq(S(a,"waffle-assistant-sidepane-content")).height}q.Ac=oa;q.Hd=f("Hf");q.xna=function(){this.L.Ob(2226,this.Ec)};q.AGb=function(){""!=this.$&&(wJ(this.Ua,this.$),this.$="");""!=this.ea&&(wJ(this.Ua,this.ea),this.ea="");this.Xa||(this.L.Ob(2777,this.Ec),this.Xa=!0)};function Ccc(a){a=a||{};return V(T(BU(ds({title:gs(""+Dcc()),Rj:gs('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+V('<div class="waffle-assistant-empty-list-old" style="display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>')+
'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:fs("autovis"),T1:fs("waffle-assistant-title"),$O:fs("waffle-assistant-sidepane-content")},a))))}
function Ecc(a){a=a||{};var b=V,c=gs('<div class="waffle-assistant-replaceable-title">'+Dcc()+"</div>"),d,e;e=a||{};d=V;e=e||{};var g;g=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+T(b$b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');g=e.EPb?g+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
g+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(g+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=d('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>');return b(T(BU(ds({title:c,Rj:gs(""+d),id:fs("autovis"),T1:fs("waffle-assistant-title"),$O:fs("waffle-assistant-sidepane-content")},a))))}
function Dcc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+T(b$b({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+T("Explore")+"</div></div>")};function PW(a,b,c,d,e,g,h){NW.call(this,a,b,c,d,e,h);this.Za=g;this.Ab=b;this.X=new yq(this.oa);this.Ma(this.X);this.J=new fcc;I(this,this.J);this.D=[];this.F=null;this.Da=new ot("",h,4);ur(this.Da,2);this.Ma(this.Da)}z(PW,NW);
var QW={Fz:"waffle-assistant-scroll-pane-feature-content",fZa:"waffle-assistant-empty-list",uZa:"waffle-assistant-features",m_a:"waffle-assistant-empty-list-learn-more",Wea:"waffle-assistant-expanded-panel",D0a:"waffle-assistant-replaceable-title",tmc:"waffle-assistant-scroll-pane",fO:"waffle-assistant-title"},Fcc={defaultHelpArticleId:"6280499"};q=PW.prototype;q.Tua=function(){return Ecc};q.Cka=n("waffle-assistant-empty-list");
q.Ha=function(){PW.Z.Ha.call(this);this.X.Va(S(this,QW.Wea));SV(this.C.Ba,"Close");var a=this.Ab.O.Ur();pm&&"en"==ZD(a)&&(a=new FW(this.Za,this.Ka,this.jb,this.Tb,this.L,this.J,this.oa),this.Ma(a),this.D.push(a));if(uoa||voa)a=new ecc(this.L,this.J,this.oa),this.Ma(a),this.D.push(a);a=new pW(this.jb,this.Ka,this.L,this.J,this.oa);this.Ma(a);this.D.push(a);var b=S(this,QW.uZa);A(this.D,function(a){a.render(b);this.X.Ma(a.D,!0)},this);this.Da.Va(S(this,QW.m_a));this.getHandler().V(this.Da,"action",
this.HXb);Gcc(this)};q.HXb=function(){Q.Pm.Qb(Fcc)};q.Sua=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var g=Gc(a[e],1);this.D[c].a5(g)&&d.push(a[e])}0<d.length&&this.D[c].Qua(d,b)}};q.Uua=function(){A(this.D,function(a){j$b(a)})};q.EU=function(a,b,c){A(this.D,function(d){d.t2(a,b,c)})};q.H$=function(){return!!zb(this.D,function(a){return a.Kna()})};
q.u2=function(){var a=Bcc(this);A(this.D,function(b){this.F&&this.F!=b||(b instanceof pW&&Gf(this.getHandler(),b,"assistant-done-rendering",this.AGb),a=b.Rua(a))},this)};q.dH=function(){if(this.F)return this.F.D.D;var a=[];A(this.D,function(b){Pb(a,i$b(b))});return a};q.We=function(a){PW.Z.We.call(this,a);Gcc(this)};q.vh=function(a){A(this.D,function(b){b.vh(a)})};
q.Ac=function(){var a=S(this,QW.Fz),b=S(this,QW.D0a),c=S(this,QW.fO),d=this.X.Ba;if(this.F)this.F.D.setVisible(!1),this.F.setActive(!1),this.F=null,R(a,!0),R(d,!1),Or(b,Dcc),yp(b,"label"),this.resize();else if(this.F=zb(this.D,function(a){return a.Nb()}))R(a,!1),R(d,!0),this.F.D.setVisible(!0),k$b(this.F,b),Cp(b,this.F.DU());dq(c,eq(b).height);fl(function(){var a=Wv;a&&a.dispatchEvent("resize");this.u2()},150,this)};
q.setVisible=function(a){var b=this.Ta();PW.Z.setVisible.call(this,a);a&&!b&&Hcc(this,!0);a||this.J.clear()};q.xna=function(){PW.Z.xna.call(this);this.F&&this.Ac()};q.lna=function(){PW.Z.lna.call(this);Hcc(this,!0)};q.kna=function(){PW.Z.kna.call(this);Hcc(this,!1)};q.Mma=function(a){PW.Z.Mma.call(this,a);Hcc(this,!0,a.C)};q.Lma=function(a){PW.Z.Lma.call(this,a);Hcc(this,!1)};function Gcc(a){A(a.D,function(a){a.We(this.Hd())},a)}q.RHa=f("D");function Hcc(a,b,c){A(a.D,function(a){c||f$b(a.D,b)})};function Icc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base '+W(a.Wf)+'"><div class="docs-explore-promo-content">'+(a.tF?'<div class="docs-explore-promo-header">'+T(null==(b=a.tF)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+T(null==(b=a.JX)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.cJ?T(nt({Fe:"docs-explore-promo-button docs-explore-promo-continue-button",content:gs(""+T(a.cJ)),style:4})):"")+(a.kJ?T(nt({Fe:"docs-explore-promo-button docs-explore-promo-close-button",
content:gs(""+T(a.kJ)),style:4})):"")+"</div></div></div>"+(a.vNa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+T(b$b({color:a.vNa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function Jcc(a,b){yq.call(this,b);this.F=new ot("",b);this.Ma(this.F);this.C=new ot("",b);this.Ma(this.C);this.D=new ot("",b);ur(this.D,2);this.Ma(this.D);this.J=a;Lqa([Q.nea,Q.oea,Q.Kwa],!0)}z(Jcc,yq);q=Jcc.prototype;q.Sa=function(){this.Ba=Qr(Icc,this.J)};
q.Ha=function(){Jcc.Z.Ha.call(this);var a=S(this,"docs-explore-promo-continue-button");a&&this.F.Va(a);(a=S(this,"docs-explore-promo-close-button"))&&this.C.Va(a);(a=S(this,"docs-explore-promo-icon"))&&this.D.Va(a);this.getHandler().V(this.F,"action",this.hKa).V(this.C,"action",this.w7a).V(this.D,"action",this.arb)};q.show=function(a){Q.Kwa.Qb();this.render(a)};q.hKa=function(a){Q.nea.Qb();a.stopPropagation()};q.w7a=function(a){Q.oea.Qb();a.stopPropagation()};q.arb=function(a){this.hKa(a)};function Kcc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+T(a.tF)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+T(a.JX)+"</p>"+(a.cJ?T(nt({Fe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:gs(""+T(a.cJ)),style:4})):"")+(a.kJ?T(nt({Fe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:gs(""+T(a.kJ)),
style:4})):"")+"</div>")};function RW(a,b,c){zF.call(this,a,c);this.O=new ot("",c);this.C=new ot("",c);a=Qr(Kcc,b);this.setContent(a);this.Hg("docs-promo-bubble");this.setPosition(0,0);this.F.Ny=!0;Kq(this.D,!1);this.Iv=!1}z(RW,zF);RW.prototype.Ha=function(){RW.Z.Ha.call(this);var a=S(this,"waffle-assistant-walkthrough-promo-continue-button");a&&this.O.Va(a);(a=S(this,"waffle-assistant-walkthrough-promo-close-button"))&&this.C.Va(a);this.getHandler().V(this.O,"action",this.J).V(this.C,"action",this.R)};
RW.prototype.J=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};RW.prototype.R=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function Lcc(a){var b=Qm("waffle-assistant-chart-preview",void 0);RW.call(this,b,{tF:"See the big picture",JX:"Data visualizations and text summaries make it easier to spot trends and outliers",cJ:"Learn more",kJ:"Got it"},a)}z(Lcc,RW);var Mcc={defaultHelpArticleId:"6280499"};Lcc.prototype.J=function(a){Q.Pm.Qb(Mcc);Lcc.Z.J.call(this,a)};function Ncc(a,b){var c=Qm("waffle-assistant-answers-input",void 0),d;d=new Xv;a="Interested in the "+(d.Im("b")+(a+(d.Vm("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={tF:"Find answers in a snap",JX:d.format(a),cJ:"Next",kJ:"Dismiss"};RW.call(this,c,d,b)}z(Ncc,RW);function Occ(a,b){a={Wf:"waffle-assistant-entry-promo",tF:"Get insights instantly",JX:pm&&"en"==ZD(a)?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore":"Apply formatting and create charts over your data in a single click using Sheets Explore",cJ:"Check it out",kJ:"Dismiss",vNa:"#0F9D58"};Jcc.call(this,a,b)}z(Occ,Jcc);function Pcc(a){var b=Qm("waffle-assistant-banding-color-picker-container",void 0);RW.call(this,b,{tF:"Make it pop",JX:"Quickly apply alternating row color formatting to add style, polish, and visual appeal",cJ:"Next",kJ:"Dismiss"},a)}z(Pcc,RW);function Qcc(a,b,c,d,e,g,h,k,l){xU.call(this,b,h);this.La=a;this.C=b;this.X=c;this.Ga=d;this.Ua=e;this.Y=g;this.Pa=k;this.R=c.C;this.Da=this.va=!1;this.J=l;this.D=null;this.mb=new Li;this.O=null;a=rw(this.Ua);this.qa.V(this.Ga,"selectionChange",this.KXb).V(this.R,"Sa",this.JXb).V(a,"kb",this.Ttb).V(this.C,"assistant-sidepane-apply-conditional-format-rules",this.vjb).V(this.C,"assistant-sidepane-apply-banding",this.ujb).V(this.C,"assistant-sidepane-remove-banding",this.Rxb).V(this.C,"assistant-sidepane-change-selection",
this.Jkb).V(this.C,"assistant-sidepane-insert-chart",this.Mrb).V(this.C,"assistant-sidepane-thumbs",this.GAb).V(this.C,"assistant-sidepane-set-active-panel",this.Bzb).V(this.C,"assistant-sidepane-back-button-clicked",this.Rjb).V(this.C,"assistant-undo-pressed",this.LXb).V(this.La,"cu",this.bmb);Vo(this.L,X.nH,go,this.Prb).subscribe(X.UU,"action",this.Ojb).subscribe(X.J2,"action",this.tAb).subscribe(X.Uda,"action",this.oAb);X.I2.Qa(!0);this.Ec=Yo(new Xo,10).Fa();this.Ka=uJ.getInstance();this.ea=vJ(this.Ka,
mj.Jwa);fl(Fa(this.oX,!1),100,this)}z(Qcc,xU);q=Qcc.prototype;q.Jh=function(){return X.Wda};q.xt=function(){return X.Xda};q.Fs=function(a){Qcc.Z.Fs.call(this,a);X.J2.Qa(a);this.oX(!1);!this.va&&a&&(this.va=!0,Aoa&&vK(this.Pa,"ritz-DisplayExploreV2Promo",!1))};q.vh=function(a){this.C.vh(a);this.La.vh(a)};q.Ojb=function(){var a=this.C.Ta();this.Jh().setVisible(!a);a?this.J.Ob(2226,this.Ec):(this.C.focus(),this.J.Ob(2253,this.Ec))};q.oAb=function(){this.C.Ta()||this.Fs(!0)};
q.tAb=function(a){Acc(this.C,a)};q.KXb=function(){this.oX(!0)};q.oX=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.O&&b[0].equals(this.O)){this.O=null;return}}var c=this.C;c.Ta()&&(hcc(c.Y),OW(c));this.La.update(!a,this.C.Ta(),b)};
q.bmb=function(a){""!=this.ea&&(wJ(this.Ka,this.ea),this.ea="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&Kh(c)>=Eoa&&Fh(c,"r")>=Goa&&Fh(c,"c")>=Hoa&&Kh(c)<=Foa)&&.6<=b;d!==this.Da&&(this.Da=d,X.I2.Qb(d),!d&&this.D&&(J(this.D),this.D=null));if(c){if(a&&a.rect){var d=.9<=b,e=1E3>=Kh(a.rect),c=ritz.isFormsRegion(""+a.vd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),d=qoa&&!this.C.Ta()&&!this.va&&d&&e&&!dy(this.X),c=roa&&c,e=soa&&this.X.Hd();d&&(c||e)?(d=new V9b,P(d,
1,b),P(d,2,c),P(d,3,e),c=new ko,gj(c,58,d),this.lBa(new Wo(10,c)),c=!0):c=!1}else c=!1;if(c=!c)if(c=Aoa){if(b=.6<=b&&!this.C.Ta()&&!this.va&&!this.D&&this.Pa.C["ritz-DisplayExploreV2Promo"].Ia()&&a)b=a.rect,b=ritz.hasBandingSuggestions(a.vd+"",b.gc(),b.Qc(),b.Wb(),b.Vc());c=b}c&&(a=this.X.O.Ur(),this.D=new Occ(a),I(this,this.D),this.D.show(),this.L.subscribe(Q.nea,"action",this.Wob).subscribe(Q.oea,"action",this.rna),vK(this.Pa,"ritz-DisplayExploreV2Promo",!1),this.J.Ob(2788,this.Ec))}};
q.lBa=function(a){this.C.bb=!0;var b=eQa(tw(this.R));GKb.C||b||(a=a||this.Ec,this.Jh().setVisible(!0),this.J.Ob(2225,a),fl(Fa(this.l4a,a),5E3,this))};q.l4a=function(a){this.C.Ta()||this.J.Ob(2752,a)};q.rna=function(){J(this.D);this.D=null};
q.Wob=function(){J(this.D);this.Fs(!0);Gf(this.qa,this.C,"assistant-done-rendering",y(function(){var a;a:{this.C.Ta();a=this.X.O.Ur();a=pm&&"en"==ZD(a);for(var b=!1,c=!1,d=!1,e=this.C.dH(),g=0;g<e.length;g++)if(e[g]instanceof tW?b=!0:e[g]instanceof GW?c=!0:e[g]instanceof mW&&(d=!0),c&&d&&(b||!a)){a=!0;break a}a=!1}a?this.MLa():this.rna()},this))};
q.MLa=function(){this.C.Ta();J(this.D);var a=null;this.D instanceof Occ?(a=this.X.O.Ur(),pm&&"en"==ZD(a)?(a=this.C.RHa(),a=Lbc(zb(a,function(a){return a instanceof FW}).L).toLowerCase(),a=new Ncc(a)):a=new Pcc):this.D instanceof Ncc?a=new Pcc:this.D instanceof Pcc&&(a=new Lcc);if(this.D=a)I(this,this.D),this.D.render(),Gf(Gf(this.qa,this.D,"promo-dismiss",this.rna),this.D,"promo-continue",this.MLa)};q.Rjb=function(){this.C.Ac()};
q.LXb=function(a){var b=a.C,c=b.D.UJ(),d=parseInt(c.eb(),10);this.O=Rh(c);this.Y.C(new zLb(d));bcc(b,c);this.J.Ob(a.Ij(),this.Ec)};q.JXb=function(){sw(this.R)?(this.C.Qa(!0),this.oX(!1)):(this.Jh().setVisible(!1),this.C.Qa(!1))};q.Prb=function(){this.C.We(!X.nH.isEnabled())};q.Ttb=function(a){this.oX(!1,a.C?a.C:a.rect?[a.rect]:[])};
q.vjb=function(a){var b=tw(this.R),c=""+b.jc(),d=[],e=K5b(b);if(e){var b=new Ze,g=Gc(e,2);E(b,3,g);g=Gc(e,2);E(b,2,g);e=Gc(e,1);E(b,1,e);d.push(b)}b=a.C.jb;for(e=0;e<b.length;e++)g=new Ze,E(g,2,b[e]),d.push(g);this.Y.C(new CU(d,c));a=a.Ij();this.J.Ob(a,this.Ec)};
q.ujb=function(a){var b=a.C,c=w6b(b.C),d=b.D.UJ(),e=c.$t?c.Fw:null,g=c.C?c.ow:null,h=parseInt(d.eb(),10),k=Rcc(d);this.O=Rh(d);k?this.Y.C(new wU(k,h,this.O,e,c.Or,c.Es,g)):this.Y.C(new uU(h,this.O,e,c.Or,c.Es,g));d=new X5b;P(d,1,1);c=new PT;b=b.D.wT();P(c,2,b);gj(c,5,d);b=new ko;gj(b,46,c);b=new Wo(10,b);a=a.Ij();this.J.Ob(a,b)};q.Rxb=function(a){a=a.C;var b=a.D.UJ(),c=parseInt(b.eb(),10),d=Rcc(b);this.O=Rh(b);this.Y.C(new vU(d,c));bcc(a,b)};
function Rcc(a){var b=a.eb();a=Rh(a);b=ritz.getWorkbookRangeIntersectingIds(b,a.gc(),a.Wb(),a.Qc(),a.Vc(),7,!1);return 0<b.length?b[0]:null}q.Jkb=function(a){jD(tw(this.R),a.F);a=a.Ij();this.J.Ob(a,this.Ec)};
q.GAb=function(a){var b=a.C;a=a.Ij();if(b instanceof rW||b instanceof tW)this.J.Ob(a,this.Ec);else{var c=this.C.dH(),d=new PT,e=b.D.wT(),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new ko;gj(e,46,d);if(b instanceof mW){(d=b.L)?(b=Scc(this,b,d),b=h9b(b,d,d.Ug)):b=null;if(!b)return;gj(e,39,b)}else if(b instanceof oW){var g=b.D,c=new X9b;if(b instanceof oW)b=1;else throw Error("Unknown text analysis card type.");g=Fc(g.getAutovisRecommendation(),20).slice(0,10);P(c,2,g||[]);P(c,1,b);gj(d,3,c)}this.J.Ob(a,new Wo(10,
e))}};q.Bzb=function(){this.C.Ac()};
q.Mrb=function(a){var b=a.Y;if(b){var c=tw(this.R),d=a.Ue();d||(d=bB(this.Ga).ud().C.Ue());var e=16,g=16,h=a.mb;h&&(e=h.x,g=h.y);c={oid:null,ar:qD(c,d.y),ac:rD(c,d.x),x:e,y:g,h:nIa.height,w:nIa.width,p:{context:{chartName:"Chart "+(Tcc(this)+1)}}};d=new mI(nw(this.R)||0,c,!1,!1);c=b.Ug;e=new Hl(c);g=Pl(e,"headers");g=null!=g&&xa(g)&&Ua(g)?parseInt(g,10):-1;d.Pa=g;d.va=0;g="1"==Pl(e,"transpose");d.La=g;d.O=g?"ROWS":"COLS";g=Pl(e,"range");g=O5b(N5b(g,","),this.R);d.UT(g);U4b(d,b);if(e=Pl(e,"dt"))e=
this.mb.kd(ff.Ca(),JSON.parse(decodeURIComponent(e))),d.R=encodeURIComponent(JSON.stringify(d.Ua.serialize(e)));this.Ga.dispatchEvent(new rF("objectRequest"));this.Y.C(new kF(this.X,d));e=Ucc(this,b,a.$,a.Re());d=this.J;a=a.Ij();b=h9b(e,b,c);c=new ko;gj(c,39,b);d.Ob(a,new Wo(10,c))}};function Scc(a,b,c){var d=a.C.dH().filter(function(a){return a instanceof mW});return Ucc(a,c,d.indexOf(b),b.L&&b.L.Re())}
function Ucc(a,b,c,d){var e=new j9b;a=a.C.dH().filter(function(a){return a instanceof mW}).map(function(a){return a.getChartType()});e.R=a;e.F=c;k9b(e,b.getChartType());e.D=d?d.clone():null;return e}function Tcc(a){var b=0;HG(a.X.J,function(a){6==a.getType()&&b++});return b};function Vcc(a,b){kW.call(this,a,b)}z(Vcc,kW);q=Vcc.prototype;q.Az=function(a){a()};q.rz=oa;q.oy=n("assistantPivotTableFeedback");q.FE=n(2632);q.CE=n(2631);function Wcc(a,b,c,d,e,g,h){NW.call(this,a,b,c,d,e,h);this.J=new yq(this.oa);this.Ma(this.J);this.F=null;this.Da=new M;I(this,this.Da);this.D=[];this.Za=null;this.X=!0}z(Wcc,NW);var Xcc={XXa:"waffle-assistant-card-holder",Fz:"waffle-assistant-sidepane-content",$Ya:"waffle-assistant-dragger-card",ZYa:"waffle-assistant-dragged-card",fZa:"waffle-assistant-empty-list-old",VISIBLE:"waffle-assistant-visible"};q=Wcc.prototype;q.Tua=function(){return Ccc};q.Cka=n("waffle-assistant-empty-list-old");
q.Ha=function(){Wcc.Z.Ha.call(this);var a=S(this,Xcc.XXa);this.J.Va(a)};q.setVisible=function(a){var b=this.Ta();Wcc.Z.setVisible.call(this,a);a&&!b&&(this.X=!0)};
q.Sua=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=D(c,1),e=null;switch(d){case 0:"WordCloud"==c.getAutovisRecommendation().getChartType()?e=new oW(c,this.oa):e=new mW(c,this.jb,this.Ka,this.L,null,this.oa);break;case 1:e=new Vcc(c,this.oa);break;case 2:e=new HW(c,this.oa);break;case 4:e=new GW(c,this.L,this.oa);break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.od();e.Y=c;this.J.Ma(e,!0);if(X.nH.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new Ycc,y6b(this.F,
this.J.Ba),this.F.X=10,this.F.R=Xa(Xcc.$Ya).split(" "),this.F.ea=!0,this.F.gsa(Xcc.VISIBLE),this.F.L=!1,this.F.Ve(),this.Da.V(this.F,"beforedragstart",y(this.MXb,this)).V(this.F,"dragstart",y(this.NXb,this)).V(this.F,"beforedragend",y(this.akb,this));var c=this.F,d=this.J.Ba,g=e.Ba;u(void 0)?tpa(d,g,void 0):d.appendChild(g);z6b(c,g)}0!=this.D.length&&e.getHandler().V(this.D[this.D.length-1],"content-rendered",e.iP);this.D.push(e)}};
q.Uua=function(a){0<this.D.length&&this.D[0].iP();if(a||this.X)this.X=!1,Zcc(this)};function Zcc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Ba;Sp(d,0,1E3);b+=eq(d).height}b=Math.max(eq(S(a,"waffle-assistant-sidepane-content")).height,b);dq(a.J.Ba,b);for(c=0;c<a.D.length;c++)fl(Fa(a.O2a,a.D[c]),100*c,a);fl(function(){dq(this.J.Ba,"auto")},100*a.D.length,a)}}q.O2a=function(a){!a.isDisposed()&&this.isEnabled()&&(new gU(a.Ba,[0,1E3],[0,0],100)).play()};
q.EU=function(){this.Da.Gc();J(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.qc()&&this.J.removeChild(b,!0);J(b)}this.D=[]};q.H$=function(){return 0<this.D.length};q.u2=function(){for(var a=Bcc(this),b=0,c=0;c<this.D.length;c++)b<a?(UV(this.D[c],!0),b+=eq(this.D[c].Ba).height):UV(this.D[c],!1)};q.MXb=function(a){var b=sb(this.J.Ba.childNodes,a.C),b=this.J.zd(b);b.eOa()?this.Za=b:a.preventDefault()};q.NXb=function(a){Fp(a.F,Xcc.ZYa)};
q.akb=function(a){var b=Tp(a.F),c=bB(this.Ka).C;if(ph(VE(c,"page",!1,!1)).contains(b)){var d=TE(c,b.x,b.y,"page"),c=XE(c,vh(d),"page");this.Za.y9(d,new N(b.x-c.left,b.y-c.top))}a.Y.Cw(null,!0);a.preventDefault();this.Za=null};q.dH=f("D");function Ycc(){DU.call(this)}z(Ycc,DU);Ycc.prototype.Gla=function(a){a=Ycc.Z.Gla.call(this,a);var b=vb(a.querySelectorAll("clippath"),function(a){return a.id});$cc(a,b);return a};
function $cc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];xa(c)&&cb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=fn(a);for(d=0;d<a.length;d++)$cc(a[d],b)};function adc(){H.call(this)}z(adc,Kn);adc.prototype.C=function(){return pcc};adc.prototype.F=function(){return uoa||voa||pm?PW:Wcc};adc.prototype.D=function(){return Qcc};Sn("assistant",adc);
