var loading=false;var alignmentContainerState="closed";Drupal.behaviors.sAlignment=function(c){var b=$(".alignment-form-container");$(".alignment-form-container:not(.sAlignmentProccessed)",c).addClass("sAlignmentProccessed").each(function(){var e=$(this);sAlignmentLoadGuids();$(".selected-btn",e).bind("click",function(){$(".selected-container",e).show();$(".alignment-breadcrumbs",e).hide();$(".browse-container",e).hide();$(".search-container",e).hide();$(".search-block input",e).val("");$(this).addClass("active");$(".browse-btn",e).removeClass("active");sPopupsResizeCenter()});$(".browse-btn",e).bind("click",function(){$(".browse-container",e).show();$(".alignment-breadcrumbs",e).show();$(".selected-container",e).hide();$(".search-container",e).hide();$(".search-block input",e).val("");$(this).addClass("active");$(".selected-btn",e).removeClass("active");sPopupsResizeCenter()});$("#edit-alignment-search-field",e).bind("keydown",function(h){var g=(h.keyCode?h.keyCode:h.which);if(g==13){var f=$(this);
sAlignmentSearch(f.val(),f.parents(".alignment-form-container"));return false}});$(".mag-glass",e).bind("click",function(h){h.preventDefault();var f=$(this);var g=f.siblings("#edit-alignment-search-field").val();if(!g){return}sAlignmentSearch(g,f.parents(".alignment-form-container"));return false});$(document).unbind("popups_before_close.s_alignment").bind("popups_before_close.s_alignment",function(h,g){$(".selected-container div.selected-item").remove();if($("#alignments-wrapper-form").length){b.attr("id","");$("#alignments-wrapper-form").append(b.hide())}var f=e.attr("id");if(f){var j=f.split("_")[1];$("#"+j).append(e.hide())}alignmentContainerState="closed"})});$(".alignment-btn:not(.sAlignmentProccessed)",c).addClass("sAlignmentProccessed").each(function(){var e=$(this).parents("form").eq(0);if(typeof Drupal.settings.s_alignment=="undefined"){Drupal.settings.s_alignment={}}Drupal.settings.s_alignment.activeForm=e;$(this).bind("click",function(j,h){if(typeof(h)=="undefined"||h==null){h={}
}if(alignmentContainerState=="open"||$(this).hasClass("disabled")&&!h.override){return false}sAlignmentUpdateSelectedCount(true);var g=sAlignmentGetActiveForm();if(!g){g=$(this).parents("form").eq(0)}if(!b.length){b=$("#alignments-wrapper-form .alignment-form-container")}if(b.length){var f=new Popups.Popup();f.extraClass="popups-large add-alignment-popup";var k={popup:f,options:{hideActive:false},buttons:{close:{title:Drupal.t("Add Learning Objectives"),func:function(n){var l=Popups.activePopup();if(l!=null){var m=$("#"+l.id);g.append($(".alignment-form-container",m).hide());Popups.close(l)}}}}};if($(".guids-container .guid-container .guid-item").length===1){$(".guids-container .guid-container .guid-item").click()}Popups.open(k.popup,Drupal.t("Add Learning Objectives"),'<div id="popup-alignment-form-wrapper"></div>',k.buttons,k.width,k.options);b.attr("id","form_"+g.attr("id"));b.prependTo($("#popup-alignment-form-wrapper",k.popup.$popupBody())).show();alignmentContainerState="open";Popups.resizeAndCenter(f)
}})});$(document).trigger("sAlignmentAlignmentBtnProcessed");$(".selected-item:not(.sAlignmentProccessed)",c).addClass("sAlignmentProccessed").each(function(){$(this).bind("click",function(){sAlignmentRemoveItem($(this).attr("id").split("_").pop(),true)})});$(".alignment-inline-item:not(.sAlignmentProccessed)",c).addClass("sAlignmentProccessed").each(function(){$(".delete-btn",$(this)).bind("click",function(){var e=$(this).parent().attr("id").split("_").pop();sAlignmentRemoveItem(e)})});$(".search-result:not(.sAlignmentProccessed)",c).addClass("sAlignmentProccessed").each(function(){$(this).bind("click",function(){var e=$(this);var g=$("input[type=checkbox].std-selector",e);var f=g.is(":checked");g.prop("checked",!f);if(f){sAlignmentRemoveItem(e.attr("id").split("_").pop(),true)}else{sAlignmentAddItem(e)}})});$(".guid-container:not(.sAlignmentProccessed)",c).addClass("sAlignmentProccessed").each(function(){var e=$(this);$(".guid-item",e).bind("click",function(j){var g=$(this);var h=$("input[type=checkbox].std-selector",g);
var f=h.is(":checked");if(g.hasClass("has-children")){sAlignmentLoadId(g,e,b);return}h.prop("checked",!f);if(f){sAlignmentRemoveItem(g.attr("id").split("_").pop(),true)}else{sAlignmentAddItem(g)}})});$(".breadcrumb-item:not(.sAlignmentProccessed)",c).addClass("sAlignmentProccessed").each(function(){var e=$(this);var f=e.parents(".alignment-form-container").eq(0);e.bind("click",function(){if(!$(this).hasClass("enabled")){return}$(".guid-container",f).hide();itemId=$(this).attr("id").split("_")[1];selectedItem=$("#container_"+itemId+".guid-container",f);selectedItem.show();e.nextAll("span").remove();$(".browse-btn",f).trigger("click")})});var d=sAlignmentGetActiveIdStore();var a=d.val();if(a&&a.length){$(".adv-option-btn.alignment-btn:not(.disabled)",c).addClass("active")}};function sAlignmentLoadGuids(b){if(loading){return}var a=$(".guids-container",b);loading=true;var c=$("#edit-enable-outcomes",b).val();$.ajax({url:"/alignment/browse?enable_outcomes="+c,dataType:"json",success:function(e,d,f){html=$(e.html);
a.append(html);$(".loader",b).hide();sAttachBehavior("sAlignment",a);loading=false}})}function sAlignmentLoadId(d,a,c){var e=d.attr("id").split("_")[1];var b="guid="+e;if(!$("#container_"+e,c).length&&!loading){loading=true;sAlignmentShowLoader(c,$(".guids-container",c));$.ajax({url:"/alignment/browse",data:b,dataType:"json",success:function(h,f,j){var g=$(h.html);$(".guids-container",c).append(g).show();sAlignmentUpdateSelectedCount();a.hide();sAlignmentAddBreadcrumb(d);Drupal.attachBehaviors(c);$(".authorities-container",c).hide();loading=false;sAlignmentHideLoader(c);sPopupsResizeCenter()}})}else{$(".guid-container",c).hide();$("#container_"+e,c).show();$(".authorities-container",c).hide();sAlignmentAddBreadcrumb(d)}}function sAlignmentShowLoader(c,b){if(b!=null){b.hide()}var a=$(".loader",c);a.show();sPopupsResizeCenter()}function sAlignmentHideLoader(b){var a=$(".loader",b);a.hide();sPopupsResizeCenter()}function sAlignmentAddBreadcrumb(c){var a=$(".alignment-breadcrumbs");var b=$('<span class="breadcrumb-item" id="'+c.attr("id")+'"><span class="arrow"></span>'+$(".title",c).text()+"</span>");
a.append(b);sAttachBehavior("sAlignment",a);$(".breadcrumb-item",a).removeClass("enabled").not(b).addClass("enabled")}function sAlignmentResetSelectedItems(){var a=$(".alignment-form-container");$("li",a).removeClass("active");$("input[type=checkbox]",a).prop("checked",false)}function sAlignmentResetAttachedAlignments(a){if(typeof a=="undefined"){a=false}if(typeof Drupal.settings.s_alignment=="undefined"){Drupal.settings.s_alignment={attached_tags:{}}}else{if(typeof Drupal.settings.s_alignment.attached_tags=="undefined"){Drupal.settings.s_alignment.attached_tags={}}}if(a){sAlignmentResetSelectedItems();Drupal.settings.s_alignment.attached_tags={};sAlignmentGetActiveIdStore().val("")}}function sAlignmentAddItem(o,j){if(typeof j=="undefined"){j=false}var a=$(".alignment-form-container");var b=sAlignmentGetActiveForm();if(!b){var n=a.attr("id").split("_").pop();b=$("form#"+n)}var m=o.attr("id").split("_").pop();var f=$(".title",o).text();var l=$(".meta",o).text();var d=sAlignmentGetActiveIdStore();
var h=$("#edit-item-nid").val();var e=d.val().length?d.val().split(","):new Array();if($.inArray(m,e)==-1){e.push(m);var k=$('<div id="selected_'+m+'" class="selected-item active">'+o.html()+"</div>");$(".selected-container",a).append(k);sAttachBehavior("sAlignment",$(".selected-container",a));var b=sAlignmentGetActiveForm();if(!b){var b=$("#"+a.attr("id").split("_").pop())}if(!j){var c=alignmentElement(m,f);$(".alignment-inline-wrapper .alignment-container",b).append(c);sAttachBehavior("sAlignment",$(".alignment-inline-wrapper",b))}}d.val(e);if(e.length){$(".alignment-inline-wrapper",b).show();$(".adv-option-btn.alignment-btn:not(.disabled)",b).addClass("active");sPopupsResizeCenter()}o.addClass("active");var g={guid:m,name:f,description:l,item_id:h};sAlignmentResetAttachedAlignments();Drupal.settings.s_alignment.attached_tags[g.guid]=g;sAngular.rootScopeBroadcast("sAlignmentAdd",g);sAlignmentUpdateSelectedCount();sPopupsResizeCenter(0)}function sAlignmentRemoveItem(h,b,f){if(typeof b=="undefined"){b=true
}var f=sAlignmentGetActiveIdStore();var g=f.val().split(",");var e=$.inArray(h,g);if(e===-1){return}g.splice(e,1);f.val(g);$("#selected_"+h).remove();var d=$("#item_"+h);$("input[type=checkbox]",d).prop("checked",false);d.removeClass("active");var a=$("#searchresult_"+h);$("input[type=checkbox]",a).prop("checked",false);a.removeClass("active");$("#formitem_"+h).remove();var c=$(".tag-item-from-rubric").length;if(c+g.length==0){$(".alignment-inline-wrapper").hide();$(".adv-option-btn.alignment-btn:not(.disabled)").removeClass("active");sPopupsResizeCenter()}sAlignmentUpdateSelectedCount();if(b){$.each(Drupal.settings.s_alignment.attached_tags,function(j,k){if(k.guid==h){delete Drupal.settings.s_alignment.attached_tags[j]}});sAngular.rootScopeBroadcast("sAlignmentRemove",{guid:h})}sPopupsResizeCenter();sPopupsResizeCenter(0)}function sAlignmentUpdateSelectedCount(b){if(typeof b=="undefined"){b=false}var d=$(".alignment-form-container");var g=$(".selected-container",d);$("div.selected-item.active.visually-hidden",g).remove();
var h=$("div",g);var a=h.length;if(b&&a==0){var e=sAlignmentGetActiveIdStore().val("");sAlignmentResetAttachedAlignments();$.each(Drupal.settings.s_alignment.attached_tags,function(j,l){var k=$('<div class="selected-item active" id="'+l.guid+'"><input type="checkbox" class="std-selector"><span class="title">'+l.name+'</span> Â· <span class="meta small gray">'+l.description+"</span></div>");sAlignmentAddItem(k,true);a=a+1})}var c=(a)?("&nbsp;("+a+")"):"";$(".header .selected-count",d).html(c);$(".guid-item",d).each(function(){$(this).removeClass("active");$("input[type=checkbox].std-selector",$(this)).prop("checked",false)});var e=sAlignmentGetActiveIdStore();var f=e.val().length?e.val().split(","):new Array();$.each(f,function(j,k){var l=$("#item_"+k);l.addClass("active");$("input[type=checkbox].std-selector",l).prop("checked",true)})}function sAlignmentGetActiveIdStore(){if(typeof Drupal.settings.s_alignment!="undefined"){var a=Drupal.settings.s_alignment.activeForm}if(a){return idStore=$("#edit-selected-ids",a)
}else{return idStore=$("#edit-selected-ids")}}function sAlignmentGetActiveForm(){var a;if(typeof Drupal.settings.s_alignment!="undefined"){var a=Drupal.settings.s_alignment.activeForm}return a}function sAlignmentSearch(c,b){$(".browse-container",b).hide();$(".selected-container",b).hide();var a=$(".search-container",b).empty().show(),d=a.siblings(".alignment-breadcrumbs").children().eq(0);d.removeClass("enabled").siblings().remove();$(".search-block-filters input",b).each(function(){if($(this).is(":checked")&&!loading){loading=true;var g=$(this).attr("id").split("_")[1];var e="t="+c+"&guid="+g;var f=$(this).parents(".alignment-form-container").eq(0);a.show();sAlignmentShowLoader(f,null);$.ajax({url:"/alignment/search",data:e,dataType:"json",success:function(k){$(".browse-container",b).hide();$(".selected-container",b).hide();var h=$(".search-container",b).empty().show(),l=h.siblings(".alignment-breadcrumbs").children().eq(0);var j=$(k.html);$(".selected-container .selected-item").each(function(){selItemId=$(this).attr("id").split("_")[1];
if($("#searchresult_"+selItemId,j).length){$("#searchresult_"+selItemId+" input",j).attr("checked","checked");$("#searchresult_"+selItemId,j).addClass("active")}});l.addClass("enabled");h.html(j).show();Drupal.attachBehaviors(h);sAlignmentHideLoader(f);loading=false}})}})}function alignmentElement(e,d,a){var b=(a)?"tag-item-from-rubric":"";var c=(a)?"":'<span class="delete-btn"></span>';return $('<span class="alignment-inline-item tag-item '+b+'" id="formitem_'+e+'">'+d+c+"</span>")}function sAlignmentClearAlignments(b){var a=$(".alignment-container");if(b){$(".tag-item-from-rubric",a).remove()}else{$.each($(".tag-item:not(.tag-item-from-rubric)"),function(d,e){sAlignmentRemoveItem(e.id.replace("formitem_",""),false)});$(".tag-item",a).remove()}var c=sAlignmentGetActiveIdStore();c.val("");$(".selected-container div.selected-item").remove();if($(".tag-item",a).length==0){$(".alignment-inline-wrapper").hide();$(".adv-option-btn.alignment-btn:not(.disabled)").removeClass("active");sPopupsResizeCenter()
}}function sAlignmentClearPendingAlignments(a){var b=$(".alignment-container");$.each($(".tag-item:not(.tag-item-from-rubric)"),function(c,d){sAlignmentRemoveItem(d.id.replace("formitem_",""),true)});if(a){$(".tag-item-from-rubric").remove()}}function sAlignmentRubricUpdate(a){sAlignmentClearAlignments(false);$.each(a.rows,function(b,c){if(c.title){$rubric_alignment_element=alignmentElement(c.id,htmlentities(c.title),true);$(".alignment-inline-wrapper .alignment-container").append($rubric_alignment_element)}});if($(".tag-item").length>0){$(".alignment-inline-wrapper").show()}sPopupsResizeCenter()}function sAlignmentRubricInfo(a){var b=false;$.each(a.rows,function(c,d){if(d.is_published){b=true}});return{has_published_criteria:b,rubric:a}}function sAlignmentDisableAlignmentButton(){var a=$(".adv-option-btn.alignment-btn");if(!$(document).data("alignment-btn-original-title")){$(document).data("alignment-btn-original-title",a.attr("original-title"))}a.addClass("disabled disabled-rubric-selected");
a.removeClass("active");$(".s-common-adv-options-label").addClass("disabled");a.attr("original-title",Drupal.t("Cannot add learning objectives while rubric is selected"))}function sAlignmentEnableAlignmentButton(){var a=$(".adv-option-btn.alignment-btn");a.removeClass("disabled disabled-rubric-selected");$(".s-common-adv-options-label").removeClass("disabled");a.attr("original-title",$(document).data("alignment-btn-original-title"))}(function($){var PROP_NAME="datepicker";function Datepicker(){this.debug=false;this._curInst=null;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._promptClass="ui-datepicker-prompt";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this.regional=[];
this.regional[""]={clearText:"Clear",clearStatus:"Erase the current date",closeText:"Close",closeStatus:"Close without change",prevText:"&#x3c;Prev",prevStatus:"Show the previous month",prevBigText:"&#x3c;&#x3c;",prevBigStatus:"Show the previous year",nextText:"Next&#x3e;",nextStatus:"Show the next month",nextBigText:"&#x3e;&#x3e;",nextBigStatus:"Show the next year",currentText:"Today",currentStatus:"Show the current month",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthStatus:"Show a different month",yearStatus:"Show a different year",weekHeader:"Wk",weekStatus:"Week of the year",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dayStatus:"Set DD as first week day",dateStatus:"Select DD, M d",dateFormat:"mm/dd/yy",firstDay:0,initStatus:"Select a date",isRTL:false};
this._defaults={showOn:"focus",showAnim:"show",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,closeAtTop:true,mandatory:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,showBigPrevNext:false,gotoCurrent:false,changeMonth:true,changeYear:true,showMonthAfterYear:false,yearRange:"-10:+10",changeFirstDay:true,highlightWeek:false,showOtherMonths:false,showWeeks:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",showStatus:false,statusForDate:this.dateStatus,minDate:null,maxDate:null,duration:"normal",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,rangeSelect:false,rangeSeparator:" - ",altField:"",altFormat:""};$.extend(this._defaults,this.regional[""]);this.dpDiv=$('<div id="'+this._mainDivId+'" style="display: none;"></div>')}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",log:function(){if(this.debug){console.log.apply("",arguments)
}},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=="div"||nodeName=="span");if(!target.id){target.id="dp"+(++this.uuid)}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([:\[\]\.])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:$('<div class="'+this._inlineClass+'"></div>'))}},_connectDatepicker:function(target,inst){var input=$(target);
if(input.hasClass(this.markerClassName)){return}var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(appendText){input[isRTL?"before":"after"]('<span class="'+this._appendClass+'">'+appendText+"</span>")}var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both"){input.focus(this._showDatepicker)}if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");var trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](trigger);trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==target){$.datepicker._hideDatepicker()}else{$.datepicker._showDatepicker(target)}return false})}input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value
}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst)},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return}divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst));this._updateDatepicker(inst)},_inlineShow:function(inst){var numMonths=this._getNumberOfMonths(inst);inst.dpDiv.width(numMonths[1]*$(".ui-datepicker",inst.dpDiv[0]).width())},_dialogDatepicker:function(input,dateText,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){var id="dp"+(++this.uuid);this._dialogInput=$('<input type="text" id="'+id+'" size="1" style="position: absolute; top: -100px;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);
inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});this._dialogInput.val(dateText);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){var browserWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var browserHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",this._pos[0]+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);if(!$target.hasClass(this.markerClassName)){return
}var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){$target.siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove().end().removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress)}else{if(nodeName=="div"||nodeName=="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var $target=$(target);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;$target.siblings("button."+this._triggerClass).each(function(){this.disabled=false}).end().siblings("img."+this._triggerClass).css({opacity:"1.0",cursor:""})}else{if(nodeName=="div"||nodeName=="span"){$target.children("."+this._disableClass).remove()}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)})},_disableDatepicker:function(target){var $target=$(target);
if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;$target.siblings("button."+this._triggerClass).each(function(){this.disabled=true}).end().siblings("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);var offset=inline.offset();var relOffset={left:0,top:0};inline.parents().each(function(){if($(this).css("position")=="relative"){relOffset=$(this).offset();return false}});$target.prepend('<div class="'+this._disableClass+'" style="'+($.browser.msie?"background-color: transparent; ":"")+"width: "+inline.width()+"px; height: "+inline.height()+"px; left: "+(offset.left-relOffset.left)+"px; top: "+(offset.top-relOffset.top)+'px;"></div>')}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false
}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_changeDatepicker:function(target,name,value){var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}var inst=this._getInst(target);if(inst){if(this._curInst==inst){this._hideDatepicker(null)}extendRemove(inst.settings,settings);var date=new Date();extendRemove(inst,{rangeStart:null,endDay:null,endMonth:null,endYear:null,selectedDay:date.getDate(),selectedMonth:date.getMonth(),selectedYear:date.getFullYear(),currentDay:date.getDate(),currentMonth:date.getMonth(),currentYear:date.getFullYear(),drawMonth:date.getMonth(),drawYear:date.getFullYear()});this._updateDatepicker(inst)}},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date,endDate){var inst=this._getInst(target);
if(inst){this._setDate(inst,date,endDate);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst)}return(inst?this._getDate(inst):null)},_doKeyDown:function(e){var inst=$.datepicker._getInst(e.target);var handled=true;if($.datepicker._datepickerShowing){switch(e.keyCode){case 9:$.datepicker._hideDatepicker(null,"");break;case 13:$.datepicker._selectDay(e.target,inst.selectedMonth,inst.selectedYear,$("td.ui-datepicker-days-cell-over",inst.dpDiv)[0]);return false;break;case 27:$.datepicker._hideDatepicker(null,$.datepicker._get(inst,"duration"));break;case 33:$.datepicker._adjustDate(e.target,(e.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(e.target,(e.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(e.ctrlKey){$.datepicker._clearDate(e.target)
}handled=e.ctrlKey;break;case 36:if(e.ctrlKey){$.datepicker._gotoToday(e.target)}handled=e.ctrlKey;break;case 37:if(e.ctrlKey){$.datepicker._adjustDate(e.target,-1,"D")}handled=e.ctrlKey;break;case 38:if(e.ctrlKey){$.datepicker._adjustDate(e.target,-7,"D")}handled=e.ctrlKey;break;case 39:if(e.ctrlKey){$.datepicker._adjustDate(e.target,+1,"D")}handled=e.ctrlKey;break;case 40:if(e.ctrlKey){$.datepicker._adjustDate(e.target,+7,"D")}handled=e.ctrlKey;break;default:handled=false}}else{if(e.keyCode==36&&e.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){e.preventDefault();e.stopPropagation()}},_doKeyPress:function(e){var inst=$.datepicker._getInst(e.target);var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||(chr<" "||!chars||chars.indexOf(chr)>-1)},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input"){input=$("input",input.parentNode)[0]
}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input){return}var inst=$.datepicker._getInst(input);var beforeShow=$.datepicker._get(inst,"beforeShow");extendRemove(inst.settings,(beforeShow?beforeShow.apply(input,[input,inst]):{}));$.datepicker._hideDatepicker(null,"");$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return !isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.rangeStart=null;inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);inst.dpDiv.width($.datepicker._getNumberOfMonths(inst)[1]*$(".ui-datepicker",inst.dpDiv[0]).width());
offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim")||"show";var duration=$.datepicker._get(inst,"duration");var postProcess=function(){$.datepicker._datepickerShowing=true;if($.browser.msie&&parseInt($.browser.version,10)<7){$("iframe.ui-datepicker-cover").css({width:inst.dpDiv.width()+4,height:inst.dpDiv.height()+4})}};if($.effects&&$.effects[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim](duration,postProcess)}if(duration==""){postProcess()}if(inst.input[0].type!="hidden"){inst.input[0].focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var dims={width:inst.dpDiv.width()+4,height:inst.dpDiv.height()+4};inst.dpDiv.empty().append(this._generateHTML(inst)).find("iframe.ui-datepicker-cover").css({width:dims.width,height:dims.height});
var numMonths=this._getNumberOfMonths(inst);inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst.input&&inst.input[0].type!="hidden"){$(inst.input[0]).focus()}},_checkOffset:function(inst,offset,isFixed){var pos=inst.input?this._findPos(inst.input[0]):null;var browserWidth=window.innerWidth||document.documentElement.clientWidth;var browserHeight=window.innerHeight||document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;if(this._get(inst,"isRTL")||(offset.left+inst.dpDiv.width()-scrollX)>browserWidth){offset.left=Math.max((isFixed?0:scrollX),pos[0]+(inst.input?inst.input.width():0)-(isFixed?scrollX:0)-inst.dpDiv.width()-(isFixed&&$.browser.opera?document.documentElement.scrollLeft:0))}else{offset.left-=(isFixed?scrollX:0)}if((offset.top+inst.dpDiv.height()-scrollY)>browserHeight){offset.top=Math.max((isFixed?0:scrollY),pos[1]-(isFixed?scrollY:0)-(this._inDialog?0:inst.dpDiv.height())-(isFixed&&$.browser.opera?document.documentElement.scrollTop:0))
}else{offset.top-=(isFixed?scrollY:0)}return offset},_findPos:function(obj){while(obj&&(obj.type=="hidden"||obj.nodeType!=1)){obj=obj.nextSibling}var position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input,duration){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return}var rangeSelect=this._get(inst,"rangeSelect");if(rangeSelect&&inst.stayOpen){this._selectDate("#"+inst.id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))}inst.stayOpen=false;if(this._datepickerShowing){duration=(duration!=null?duration:this._get(inst,"duration"));var showAnim=this._get(inst,"showAnim");var postProcess=function(){$.datepicker._tidyDialog(inst)};if(duration!=""&&$.effects&&$.effects[showAnim]){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(duration==""?"hide":(showAnim=="slideDown"?"slideUp":(showAnim=="fadeIn"?"fadeOut":"hide")))](duration,postProcess)}if(duration==""){this._tidyDialog(inst)
}var onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}this._datepickerShowing=false;this._lastInput=null;inst.settings.prompt=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}this._curInst=null},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker");$("."+this._promptClass,inst.dpDiv).remove()},_checkExternalClick:function(event){if(!$.datepicker._curInst){return}var $target=$(event.target);if(($target.parents("#"+$.datepicker._mainDivId).length==0)&&!$target.hasClass($.datepicker.markerClassName)&&!$target.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)){$.datepicker._hideDatepicker(null,"")}},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);this._adjustInstDate(inst,offset,period);
this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst._selectingMonthYear=false;inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_clickMonthYear:function(id){var target=$(id);var inst=this._getInst(target[0]);if(inst.input&&inst._selectingMonthYear&&!$.browser.msie){inst.input[0].focus()}inst._selectingMonthYear=!inst._selectingMonthYear
},_changeFirstDay:function(id,day){var target=$(id);var inst=this._getInst(target[0]);inst.settings.firstDay=day;this._updateDatepicker(inst)},_selectDay:function(id,month,year,td){if($(td).hasClass(this._unselectableClass)){return}var target=$(id);var inst=this._getInst(target[0]);var rangeSelect=this._get(inst,"rangeSelect");if(rangeSelect){inst.stayOpen=!inst.stayOpen;if(inst.stayOpen){$(".ui-datepicker td",inst.dpDiv).removeClass(this._currentClass);$(td).addClass(this._currentClass)}}inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;if(inst.stayOpen){inst.endDay=inst.endMonth=inst.endYear=null}else{if(rangeSelect){inst.endDay=inst.currentDay;inst.endMonth=inst.currentMonth;inst.endYear=inst.currentYear}}this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear));if(inst.stayOpen){inst.rangeStart=new Date(inst.currentYear,inst.currentMonth,inst.currentDay);this._updateDatepicker(inst)
}else{if(rangeSelect){inst.selectedDay=inst.currentDay=inst.rangeStart.getDate();inst.selectedMonth=inst.currentMonth=inst.rangeStart.getMonth();inst.selectedYear=inst.currentYear=inst.rangeStart.getFullYear();inst.rangeStart=null;if(inst.inline){this._updateDatepicker(inst)}}}},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"mandatory")){return}inst.stayOpen=false;inst.endDay=inst.endMonth=inst.endYear=inst.rangeStart=null;this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(this._get(inst,"rangeSelect")&&dateStr){dateStr=(inst.rangeStart?this._formatDate(inst,inst.rangeStart):dateStr)+this._get(inst,"rangeSeparator")+dateStr}if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")
}}if(inst.inline){this._updateDatepicker(inst)}else{if(!inst.stayOpen){this._hideDatepicker(null,this._get(inst,"duration"));this._lastInput=inst.input[0];if(typeof(inst.input[0])!="object"){inst.input[0].focus()}this._lastInput=null}}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat");var date=this._getDate(inst);dateStr=(isArray(date)?(!date[0]&&!date[1]?"":this.formatDate(altFormat,date[0],this._getFormatConfig(inst))+this._get(inst,"rangeSeparator")+this.formatDate(altFormat,date[1]||date[0],this._getFormatConfig(inst))):this.formatDate(altFormat,date,this._getFormatConfig(inst)));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var checkDate=new Date(date.getFullYear(),date.getMonth(),date.getDate(),(date.getTimezoneOffset()/-60));var firstMon=new Date(checkDate.getFullYear(),1-1,4);var firstDay=firstMon.getDay()||7;
firstMon.setDate(firstMon.getDate()+1-firstDay);if(firstDay<4&&checkDate<firstMon){checkDate.setDate(checkDate.getDate()-3);return $.datepicker.iso8601Week(checkDate)}else{if(checkDate>new Date(checkDate.getFullYear(),12-1,28)){firstDay=new Date(checkDate.getFullYear()+1,1-1,4).getDay()||7;if(firstDay>4&&(checkDate.getDay()||7)<firstDay-3){return 1}}}return Math.floor(((checkDate-firstMon)/86400000)/7)+1},dateStatus:function(date,inst){return $.datepicker.formatDate($.datepicker._get(inst,"dateStatus"),date,$.datepicker._getFormatConfig(inst))},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value=="object"?value.toString():value+"");if(value==""){return null}var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;
var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var getNumber=function(match){lookAhead(match);var origSize=(match=="@"?14:(match=="y"?4:(match=="o"?3:2)));var size=origSize;var num=0;while(size>0&&iValue<value.length&&value.charAt(iValue)>="0"&&value.charAt(iValue)<="9"){num=num*10+parseInt(value.charAt(iValue++),10);size--}if(size==origSize){throw"Missing number at position "+iValue}return num};var getName=function(match,shortNames,longNames){var names=(lookAhead(match)?longNames:shortNames);var size=0;for(var j=0;j<names.length;j++){size=Math.max(size,names[j].length)}var name="";var iInit=iValue;while(size>0&&iValue<value.length){name+=value.charAt(iValue++);for(var i=0;i<names.length;i++){if(name==names[i]){return i+1}}size--}throw"Unknown name at position "+iInit
};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)
}var date=new Date(year,month-1,day);if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TIMESTAMP:"@",W3C:"yy-mm-dd",formatDate:function(format,date,settings){if(!date){return""}var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num
};var formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])};var output="";var literal=false;if(date){for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":var doy=date.getDate();for(var m=date.getMonth()-1;m>=0;m--){doy+=this._getDaysInMonth(date.getFullYear(),m)}output+=formatNumber("o",doy,3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)
}}}}return output},_possibleChars:function(format){var chars="";var literal=false;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst){var dateFormat=this._get(inst,"dateFormat");var dates=inst.input?inst.input.val().split(this._get(inst,"rangeSeparator")):null;inst.endDay=inst.endMonth=inst.endYear=null;var date=defaultDate=this._getDefaultDate(inst);if(dates.length>0){var settings=this._getFormatConfig(inst);if(dates.length>1){date=this.parseDate(dateFormat,dates[1],settings)||defaultDate;inst.endDay=date.getDate();
inst.endMonth=date.getMonth();inst.endYear=date.getFullYear()}try{date=this.parseDate(dateFormat,dates[0],settings)||defaultDate}catch(e){this.log(e);date=defaultDate}}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates[0]?date.getDate():0);inst.currentMonth=(dates[0]?date.getMonth():0);inst.currentYear=(dates[0]?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){var date=this._determineDate(this._get(inst,"defaultDate"),new Date());var minDate=this._getMinMaxDate(inst,"min",true);var maxDate=this._getMinMaxDate(inst,"max");date=(minDate&&date<minDate?minDate:date);date=(maxDate&&date>maxDate?maxDate:date);return date},_determineDate:function(date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setUTCDate(date.getUTCDate()+offset);return date};var offsetString=function(offset,getDaysInMonth){var date=new Date();var year=date.getFullYear();
var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};date=(date==null?defaultDate:(typeof date=="string"?offsetString(date,this._getDaysInMonth):(typeof date=="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):date)));return(date&&date.toString()=="Invalid Date"?defaultDate:date)},_setDate:function(inst,date,endDate){var clear=!(date);var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;date=this._determineDate(date,new Date());inst.selectedDay=inst.currentDay=date.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=date.getMonth();
inst.drawYear=inst.selectedYear=inst.currentYear=date.getFullYear();if(this._get(inst,"rangeSelect")){if(endDate){endDate=this._determineDate(endDate,null);inst.endDay=endDate.getDate();inst.endMonth=endDate.getMonth();inst.endYear=endDate.getFullYear()}else{inst.endDay=inst.currentDay;inst.endMonth=inst.currentMonth;inst.endYear=inst.currentYear}}if(origMonth!=inst.selectedMonth||origYear!=inst.selectedYear){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst)+(!this._get(inst,"rangeSelect")?"":this._get(inst,"rangeSeparator")+this._formatDate(inst,inst.endDay,inst.endMonth,inst.endYear)))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:new Date(inst.currentYear,inst.currentMonth,inst.currentDay));if(this._get(inst,"rangeSelect")){return[inst.rangeStart||startDate,(!inst.endYear?inst.rangeStart||startDate:new Date(inst.endYear,inst.endMonth,inst.endDay))]}else{return startDate
}},_generateHTML:function(inst){var today=new Date();today=new Date(today.getFullYear(),today.getMonth(),today.getDate());var showStatus=this._get(inst,"showStatus");var initStatus=this._get(inst,"initStatus")||"&#xa0;";var isRTL=this._get(inst,"isRTL");var clear=(this._get(inst,"mandatory")?"":'<div class="ui-datepicker-clear"><a onclick="jQuery.datepicker._clearDate(\'#'+inst.id+"');\""+this._addStatus(showStatus,inst.id,this._get(inst,"clearStatus"),initStatus)+">"+this._get(inst,"clearText")+"</a></div>");var controls='<div class="ui-datepicker-control">'+(isRTL?"":clear)+'<div class="ui-datepicker-close"><a onclick="jQuery.datepicker._hideDatepicker();"'+this._addStatus(showStatus,inst.id,this._get(inst,"closeStatus"),initStatus)+">"+this._get(inst,"closeText")+"</a></div>"+(isRTL?clear:"")+"</div>";var prompt=this._get(inst,"prompt");var closeAtTop=this._get(inst,"closeAtTop");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");
var showBigPrevNext=this._get(inst,"showBigPrevNext");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var stepBigMonths=this._get(inst,"stepBigMonths");var isMultiMonth=(numMonths[0]!=1||numMonths[1]!=1);var currentDate=(!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay));var minDate=this._getMinMaxDate(inst,"min",true);var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[1]+1,maxDate.getDate());maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(new Date(drawYear,drawMonth,1)>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}var prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,new Date(drawYear,drawMonth-stepMonths,1),this._getFormatConfig(inst)));
var prevBigText=(showBigPrevNext?this._get(inst,"prevBigText"):"");prevBigText=(!navigationAsDateFormat?prevBigText:this.formatDate(prevBigText,new Date(drawYear,drawMonth-stepBigMonths,1),this._getFormatConfig(inst)));var prev='<div class="ui-datepicker-prev">'+(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?(showBigPrevNext?"<a onclick=\"jQuery.datepicker._adjustDate('#"+inst.id+"', -"+stepBigMonths+", 'M');\""+this._addStatus(showStatus,inst.id,this._get(inst,"prevBigStatus"),initStatus)+">"+prevBigText+"</a>":"")+"<a onclick=\"jQuery.datepicker._adjustDate('#"+inst.id+"', -"+stepMonths+", 'M');\""+this._addStatus(showStatus,inst.id,this._get(inst,"prevStatus"),initStatus)+">"+prevText+"</a>":(hideIfNoPrevNext?"":"<label>"+prevBigText+"</label><label>"+prevText+"</label>"))+"</div>";var nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,new Date(drawYear,drawMonth+stepMonths,1),this._getFormatConfig(inst)));var nextBigText=(showBigPrevNext?this._get(inst,"nextBigText"):"");
nextBigText=(!navigationAsDateFormat?nextBigText:this.formatDate(nextBigText,new Date(drawYear,drawMonth+stepBigMonths,1),this._getFormatConfig(inst)));var next='<div class="ui-datepicker-next">'+(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?"<a onclick=\"jQuery.datepicker._adjustDate('#"+inst.id+"', +"+stepMonths+", 'M');\""+this._addStatus(showStatus,inst.id,this._get(inst,"nextStatus"),initStatus)+">"+nextText+"</a>"+(showBigPrevNext?"<a onclick=\"jQuery.datepicker._adjustDate('#"+inst.id+"', +"+stepBigMonths+", 'M');\""+this._addStatus(showStatus,inst.id,this._get(inst,"nextBigStatus"),initStatus)+">"+nextBigText+"</a>":""):(hideIfNoPrevNext?"":"<label>"+nextText+"</label><label>"+nextBigText+"</label>"))+"</div>";var currentText=this._get(inst,"currentText");var gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));var html=(prompt?'<div class="'+this._promptClass+'">'+prompt+"</div>":"")+(closeAtTop&&!inst.inline?controls:"")+'<div class="ui-datepicker-links">'+(isRTL?next:prev)+(this._isInRange(inst,gotoDate)?'<div class="ui-datepicker-current"><a onclick="jQuery.datepicker._gotoToday(\'#'+inst.id+"');\""+this._addStatus(showStatus,inst.id,this._get(inst,"currentStatus"),initStatus)+">"+currentText+"</a></div>":"")+(isRTL?prev:next)+"</div>";
var firstDay=this._get(inst,"firstDay");var changeFirstDay=this._get(inst,"changeFirstDay");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var beforeShowDay=this._get(inst,"beforeShowDay");var highlightWeek=this._get(inst,"highlightWeek");var showOtherMonths=this._get(inst,"showOtherMonths");var showWeeks=this._get(inst,"showWeeks");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var weekStatus=this._get(inst,"weekStatus");var status=(showStatus?this._get(inst,"dayStatus")||initStatus:"");var dateStatus=this._get(inst,"statusForDate")||this.dateStatus;var endDate=inst.endDay?new Date(inst.endYear,inst.endMonth,inst.endDay):currentDate;for(var row=0;row<numMonths[0];row++){for(var col=0;col<numMonths[1];col++){var selectedDate=new Date(drawYear,drawMonth,inst.selectedDay);html+='<div class="ui-datepicker-one-month'+(col==0?" ui-datepicker-new-row":"")+'">'+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,selectedDate,row>0||col>0,showStatus,initStatus,monthNames)+'<table class="ui-datepicker" cellpadding="0" cellspacing="0"><thead><tr class="ui-datepicker-title-row">'+(showWeeks?"<td"+this._addStatus(showStatus,inst.id,weekStatus,initStatus)+">"+this._get(inst,"weekHeader")+"</td>":"");
for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;var dayStatus=(status.indexOf("DD")>-1?status.replace(/DD/,dayNames[day]):status.replace(/D/,dayNamesShort[day]));html+="<td"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end-cell"':"")+">"+(!changeFirstDay?"<span":"<a onclick=\"jQuery.datepicker._changeFirstDay('#"+inst.id+"', "+day+');"')+this._addStatus(showStatus,inst.id,dayStatus,initStatus)+' title="'+dayNames[day]+'">'+dayNamesMin[day]+(changeFirstDay?"</a>":"</span>")+"</td>"}html+="</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var tzDate=new Date(drawYear,drawMonth,1-leadDays);var utcDate=new Date(drawYear,drawMonth,1-leadDays);var printDate=utcDate;var numRows=(isMultiMonth?6:Math.ceil((leadDays+daysInMonth)/7));for(var dRow=0;dRow<numRows;dRow++){html+='<tr class="ui-datepicker-days-row">'+(showWeeks?'<td class="ui-datepicker-week-col"'+this._addStatus(showStatus,inst.id,weekStatus,initStatus)+">"+calculateWeek(printDate)+"</td>":"");
for(var dow=0;dow<7;dow++){var daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);var otherMonth=(printDate.getMonth()!=drawMonth);var unselectable=otherMonth||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);html+='<td class="ui-datepicker-days-cell'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end-cell":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth?" ui-datepicker-days-cell-over":"")+(unselectable?" "+this._unselectableClass:"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()>=currentDate.getTime()&&printDate.getTime()<=endDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?(highlightWeek?" onmouseover=\"jQuery(this).parent().addClass('ui-datepicker-week-over');\" onmouseout=\"jQuery(this).parent().removeClass('ui-datepicker-week-over');\"":""):" onmouseover=\"jQuery(this).addClass('ui-datepicker-days-cell-over')"+(highlightWeek?".parent().addClass('ui-datepicker-week-over')":"")+";"+(!showStatus||(otherMonth&&!showOtherMonths)?"":"jQuery('#ui-datepicker-status-"+inst.id+"').html('"+(dateStatus.apply((inst.input?inst.input[0]:null),[printDate,inst])||initStatus)+"');")+"\" onmouseout=\"jQuery(this).removeClass('ui-datepicker-days-cell-over')"+(highlightWeek?".parent().removeClass('ui-datepicker-week-over')":"")+";"+(!showStatus||(otherMonth&&!showOtherMonths)?"":"jQuery('#ui-datepicker-status-"+inst.id+"').html('"+initStatus+"');")+'" onclick="jQuery.datepicker._selectDay(\'#'+inst.id+"',"+drawMonth+","+drawYear+', this);"')+">"+(otherMonth?(showOtherMonths?printDate.getDate():"&#xa0;"):(unselectable?printDate.getDate():"<a>"+printDate.getDate()+"</a>"))+"</td>";
tzDate.setDate(tzDate.getDate()+1);utcDate.setUTCDate(utcDate.getUTCDate()+1);printDate=(tzDate.getHours()==0?tzDate:utcDate)}html+="</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}html+="</tbody></table></div>"}}html+=(showStatus?'<div style="clear: both;"></div><div id="ui-datepicker-status-'+inst.id+'" class="ui-datepicker-status">'+initStatus+"</div>":"")+(!closeAtTop&&!inst.inline?controls:"")+'<div style="clear: both;"></div>'+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover"></iframe>':"");return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,selectedDate,secondary,showStatus,initStatus,monthNames){minDate=(inst.rangeStart&&minDate&&selectedDate<minDate?selectedDate:minDate);var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-header">';var monthHtml="";if(secondary||!this._get(inst,"changeMonth")){monthHtml+=monthNames[drawMonth]+"&#xa0;"
}else{var inMinYear=(minDate&&minDate.getFullYear()==drawYear);var inMaxYear=(maxDate&&maxDate.getFullYear()==drawYear);monthHtml+='<select class="ui-datepicker-new-month" onchange="jQuery.datepicker._selectMonthYear(\'#'+inst.id+"', this, 'M');\" onclick=\"jQuery.datepicker._clickMonthYear('#"+inst.id+"');\""+this._addStatus(showStatus,inst.id,this._get(inst,"monthStatus"),initStatus)+">";for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNames[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml}if(secondary||!this._get(inst,"changeYear")){html+=drawYear}else{var years=this._get(inst,"yearRange").split(":");var year=0;var endYear=0;if(years.length!=2){year=drawYear-10;endYear=drawYear+10}else{if(years[0].charAt(0)=="+"||years[0].charAt(0)=="-"){year=endYear=new Date().getFullYear();year+=parseInt(years[0],10);
endYear+=parseInt(years[1],10)}else{year=parseInt(years[0],10);endYear=parseInt(years[1],10)}}year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);html+='<select class="ui-datepicker-new-year" onchange="jQuery.datepicker._selectMonthYear(\'#'+inst.id+"', this, 'Y');\" onclick=\"jQuery.datepicker._clickMonthYear('#"+inst.id+"');\""+this._addStatus(showStatus,inst.id,this._get(inst,"yearStatus"),initStatus)+">";for(;year<=endYear;year++){html+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}html+="</select>"}if(showMonthAfterYear){html+=monthHtml}html+="</div>";return html},_addStatus:function(showStatus,id,text,initStatus){return(showStatus?" onmouseover=\"jQuery('#ui-datepicker-status-"+id+"').html('"+(text||initStatus)+"');\" onmouseout=\"jQuery('#ui-datepicker-status-"+id+"').html('"+initStatus+"');\"":"")},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);
var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=new Date(year,month,day);var minDate=this._getMinMaxDate(inst,"min",true);var maxDate=this._getMinMaxDate(inst,"max");date=(minDate&&date<minDate?minDate:date);date=(maxDate&&date>maxDate?maxDate:date);inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y"){this._notifyChange(inst)}},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths=="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax,checkRange){var date=this._determineDate(this._get(inst,minMax+"Date"),null);
if(date){date.setHours(0);date.setMinutes(0);date.setSeconds(0);date.setMilliseconds(0)}return(!checkRange||!inst.rangeStart?date:(!date||inst.rangeStart>date?inst.rangeStart:date))},_getDaysInMonth:function(year,month){return 32-new Date(year,month,32).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=new Date(curYear,curMonth+(offset<0?offset:numMonths[1]),1);if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var newMinDate=(!inst.rangeStart?null:new Date(inst.selectedYear,inst.selectedMonth,inst.selectedDay));newMinDate=(newMinDate&&inst.rangeStart<newMinDate?inst.rangeStart:newMinDate);var minDate=newMinDate||this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return((!minDate||date>=minDate)&&(!maxDate||date<=maxDate))
},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day=="object"?day:new Date(year,month,day)):new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}function isArray(a){return(a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))))
}$.fn.datepicker=function(options){if(!$.datepicker.initialized){$(document.body).append($.datepicker.dpDiv).mousedown($.datepicker._checkExternalClick);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime()})(jQuery);eval(function(h,b,j,d,g,f){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(j--){f[g(j)]=d[j]||g(j)}d=[function(a){return f[a]}];g=function(){return"\\w+"};j=1}while(j--){if(d[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),d[j])
}}return h}("(r($){r 1n(){p.Y=[];p.26=[];p.26['']={1c:B,1d:':',1o:'',Z:['3J','3K'],2C:['3L','3M 2D','3N 2D','3O','3P']};p.1B={2E:'',1C:B,27:[1,1,1],2F:0,2G:L,2H:v,2I:v,2J:v,2K:'3Q.3R',1p:[20,20,8],2L:'',1D:[40,40,16],2M:B,28:[3S,3T],2N:v,2O:v};$.1q(p.1B,p.26[''])}7 m='o';$.1q(1n.2P,{1e:'3U',3V:r(a){1E(p.1B,a||{});u p},2Q:r(b,c){7 d=$(b);q(d.2R(p.1e)){u}7 e={};e.1r=$.1q({},c);e.E=0;e.13=0;e.14=0;e.x=0;e.w=$(b);$.y(b,m,e);7 f=p.t(e,'2K');7 g=p.t(e,'3W');7 h=p.t(e,'1p');7 i=p.t(e,'2E');7 j=(!f?v:$('<15 1F=\"3X\" 2S=\"3Y: 3Z-41; '+'29: 2T(\\''+f+'\\') 0 0 2U-2V; '+'2a: '+h[0]+'O; 2W: '+h[1]+'O;'+($.K.2X&&$.K.42<'1.9'?' 2Y-U: '+h[0]+'O; 2Y-43: '+(h[1]-18)+'O;':'')+'\"></15>'));d.44('<15 1F=\"45\"></15>').2Z(i?'<15 1F=\"47\">'+i+'</15>':'').2Z(j||'');d.49(p.1e).17('2b.o',p.2c).17('4a.o',p.30).17('4b.o',p.31).17('4c.o',p.32).17('4d.o',p.33);q($.K.2X){d.17('w.o',r(a){$.o.1f(e)})}q($.K.2d){d.17('4e.o',r(a){1G(r(){$.o.1f(e)},1)})}q(p.t(e,'2G')&&$.1H.2e){d.2e(p.34)}q(j){j.3a(p.2f).2g(p.1I).4f(p.3b).2h(p.1I).3c(p.2i)}},4g:r(a){p.2j(a,B)},4h:r(a){p.2j(a,L)},2j:r(b,c){7 d=$.y(b,m);q(!d){u}b.3d=c;q(b.2k&&b.2k.1J.1g()=='15'){$.o.1K(d,b.2k,(c?5:-1))}$.o.Y=$.3e($.o.Y,r(a){u(a==b?v:a)});q(c){$.o.Y.4i(b)}},1s:r(a){u $.3f(a,p.Y)>-1},4j:r(a,b,c){7 d=$.y(a,m);q(d){q(1h b=='1L'){7 e=b;b={};b[e]=c}7 f=p.1i(d);1E(d.1r,b||{});q(f){p.19(d,F J(0,0,0,f[0],f[1],f[2]))}}$.y(a,m,d)},4k:r(b){$w=$(b);q(!$w.2R(p.1e)){u}$w.4l(p.1e).4m('.o');q($.1H.2e){$w.4n()}p.Y=$.3e(p.Y,r(a){u(a==b?v:a)});$w.4o().4p($w);$.4q(b,m)},4r:r(a,b){7 c=$.y(a,m);q(c){p.19(c,b?(1h b=='4s'?F J(b.2l()):b):v)}},3g:r(a){7 b=$.y(a,m);7 c=(b?p.1i(b):v);u(!c?v:F J(0,0,0,c[0],c[1],c[2]))},4t:r(a){7 b=$.y(a,m);7 c=(b?p.1i(b):v);u(!c?0:(c[0]*4u+c[1]*2m+c[2])*3h)},2c:r(a){7 b=(a.1J&&a.1J.1g()=='w'?a:p);q($.o.P==b||$.o.1s(b)){$.o.1M=B;u}7 c=$.y(b,m);$.o.1M=L;$.o.P=b;$.o.1j=v;7 d=$.o.t(c,'2N');1E(c.1r,(d?d.1N(b,[b]):{}));$.y(b,m,c);$.o.1f(c);1G(r(){$.o.1a(c)},10)},30:r(a){$.o.1j=$.o.P;$.o.P=v},31:r(b){7 c=b.1k;7 d=$.y(c,m);q(!$.o.1M){7 e=$.o.t(d,'1d').G+2;d.x=0;q(c.3i!=v){1O(7 f=0;f<=I.1l(1,d.V,d.D);f++){7 g=(f!=d.D?(f*e)+2:(d.D*e)+$.o.t(d,'1o').G+$.o.t(d,'Z')[0].G);d.x=f;q(c.3i<g){C}}}N q(c.1P){7 h=$(b.3j);7 i=c.1P();7 j=r(a){u{4v:2,4w:4,4x:6}[a]||a};7 k=b.3k+1t.2n.1u-(h.1Q().U+Q(j(h.1v('4y-U-2a')),10))-i.2o;1O(7 f=0;f<=I.1l(1,d.V,d.D);f++){7 g=(f!=d.D?(f*e)+2:(d.D*e)+$.o.t(d,'1o').G+$.o.t(d,'Z')[0].G);i.4z();i.3l('2p',g);d.x=f;q(k<i.4A){C}}}}$.y(c,m,d);$.o.1a(d);$.o.1M=B},32:r(a){q(a.2q>=48){u L}7 b=$.y(a.1k,m);2r(a.2q){A 9:u(a.4B?$.o.W(b,-1,L):$.o.W(b,+1,L));A 35:q(a.3m){$.o.1R(b,'')}N{b.x=I.1l(1,b.V,b.D);$.o.R(b,0)}C;A 36:q(a.3m){$.o.19(b)}N{b.x=0;$.o.R(b,0)}C;A 37:$.o.W(b,-1,B);C;A 38:$.o.R(b,+1);C;A 39:$.o.W(b,+1,B);C;A 40:$.o.R(b,-1);C;A 46:$.o.1R(b,'');C}u B},33:r(a){7 b=4C.4D(a.3n==4E?a.2q:a.3n);q(b<' '){u L}7 c=$.y(a.1k,m);$.o.3o(c,b);u B},34:r(a,b){q($.o.1s(a.1k)){u}b=($.K.3p?-b/I.1S(b):($.K.2s?b/I.1S(b):b));7 c=$.y(a.1k,m);c.w.2b();q(!c.w.T()){$.o.1f(c)}$.o.R(c,b);a.4F()},3b:r(b){7 c=$.o.1b(b);7 d=$.y($.o.1m(c),m);7 e=$.o.t(d,'2L');q(e){d.1T=L;7 f=$(c).1Q();7 g=v;$(c).3q().2t(r(){7 a=$(p);q(a.1v('1w')=='4G'||a.1v('1w')=='3r'){g=a.1Q()}u!g});7 h=$.o.t(d,'1p');7 i=$.o.t(d,'1D');$('<3s 1F=\"4H\" 2S=\"1w: 3r; U: '+(f.U-(i[0]-h[0])/2-(g?g.U:0))+'O; 1x: '+(f.1x-(i[1]-h[1])/2-(g?g.1x:0))+'O; 2a: '+i[0]+'O; 2W: '+i[1]+'O; 29: 4I 2T('+e+') 2U-2V 2u 2u; z-4J: 10;\"></3s>').3a($.o.2f).2g($.o.1I).2h($.o.3t).3c($.o.2i).4K(c)}},1m:r(a){u $(a).4L('.'+$.o.1e)[0]},2i:r(a){7 b=$.o.1b(a);7 c=$.y($.o.1m(b),m);b.4M=$.o.t(c,'2C')[$.o.2v(c,a)]},2f:r(a){7 b=$.o.1b(a);7 c=$.o.1m(b);q($.o.1s(c)){u}q(c==$.o.1j){$.o.P=c;$.o.1j=v}7 d=$.y(c,m);$.o.2c(c);7 e=$.o.2v(d,a);$.o.1K(d,b,e);$.o.2w(d,e);$.o.X=v;$.o.1U=L;7 f=$.o.t(d,'28');q(e>=3&&f[0]){$.o.X=1G(r(){$.o.2x(d,e)},f[0]);$(b).3u('2h',$.o.2y).3u('2g',$.o.2y)}},2w:r(a,b){q(!a.w.T()){$.o.1f(a)}2r(b){A 0:p.19(a);C;A 1:p.W(a,-1,B);C;A 2:p.W(a,+1,B);C;A 3:p.R(a,+1);C;A 4:p.R(a,-1);C}},2x:r(a,b){q(!$.o.X){u}$.o.P=$.o.1j;p.2w(a,b);p.X=1G(r(){$.o.2x(a,b)},p.t(a,'28')[1])},2y:r(a){4N($.o.X);$.o.X=v},3t:r(a){$.o.X=v;7 b=$.o.1b(a);7 c=$.o.1m(b);7 d=$.y(c,m);$(b).4O();d.1T=B},1I:r(a){$.o.X=v;7 b=$.o.1b(a);7 c=$.o.1m(b);7 d=$.y(c,m);q(!$.o.1s(c)){$.o.1K(d,b,-1)}q($.o.1U){$.o.P=$.o.1j}q($.o.P&&$.o.1U){$.o.1a(d)}$.o.1U=B},1b:r(a){u a.1k||a.3j},2v:r(a,b){7 c=p.1b(b);7 d=($.K.3p||$.K.2s?$.o.3v(c):$(c).1Q());7 e=($.K.2s?$.o.3w(c):[1t.2n.1u||1t.3x.1u,1t.2n.1V||1t.3x.1V]);7 f=p.t(a,'2M');7 g=(f?3y:b.3k+e[0]-d.U-($.K.2d?2:0));7 h=b.4P+e[1]-d.1x-($.K.2d?2:0);7 i=p.t(a,(a.1T?'1D':'1p'));7 j=(f?3y:i[0]-1-g);7 k=i[1]-1-h;q(i[2]>0&&I.1S(g-j)<=i[2]&&I.1S(h-k)<=i[2]){u 0}7 l=I.3z(g,h,j,k);u(l==g?1:(l==j?2:(l==h?3:4)))},1K:r(a,b,c){$(b).1v('29-1w','-'+((c+1)*p.t(a,(a.1T?'1D':'1p'))[0])+'O 2u')},3v:r(a){7 b=1W=0;q(a.3A){b=a.2o;1W=a.3B;2z(a=a.3A){7 c=b;b+=a.2o;q(b<0){b=c}1W+=a.3B}}u{U:b,1x:1W}},3w:r(a){7 b=B;$(a).3q().2t(r(){b|=$(p).1v('1w')=='4Q'});q(b){u[0,0]}7 c=a.1u;7 d=a.1V;2z(a=a.4R){c+=a.1u||0;d+=a.1V||0}u[c,d]},t:r(a,b){u(a.1r[b]!=v?a.1r[b]:$.o.1B[b])},1f:r(a){7 b=p.1i(a);7 c=p.t(a,'1C');q(b){a.E=b[0];a.13=b[1];a.14=b[2]}N{7 d=p.1y(a);a.E=d[0];a.13=d[1];a.14=(c?d[2]:0)}a.V=(c?2:-1);a.D=(p.t(a,'1c')?-1:(c?3:2));a.1X='';a.x=I.1l(0,I.3z(I.1l(1,a.V,a.D),p.t(a,'2F')));q(a.w.T()!=''){p.2A(a)}},1i:r(a,b){b=b||a.w.T();7 c=p.t(a,'1d');7 d=b.4S(c);q(c==''&&b!=''){d[0]=b.1z(0,2);d[1]=b.1z(2,4);d[2]=b.1z(4,6)}7 e=p.t(a,'Z');7 f=p.t(a,'1c');q(d.G>=2){7 g=!f&&(b.3C(e[0])>-1);7 h=!f&&(b.3C(e[1])>-1);7 i=Q(d[0],10);i=(2B(i)?0:i);i=((g||h)&&i==12?0:i)+(h?12:0);7 j=Q(d[1],10);j=(2B(j)?0:j);7 k=(d.G>=3?Q(d[2],10):0);k=(2B(k)||!p.t(a,'1C')?0:k);u p.1y(a,[i,j,k])}u v},1y:r(a,b){7 c=(b!=v);q(!c){7 d=p.1A(a,p.t(a,'2H'))||F J();b=[d.1Y(),d.1Z(),d.21()]}7 e=B;7 f=p.t(a,'27');1O(7 i=0;i<f.G;i++){q(e){b[i]=0}N q(f[i]>1){b[i]=I.4T(b[i]/f[i])*f[i];e=L}}u b},2A:r(a){7 b=p.t(a,'1c');7 c=p.t(a,'1d');7 d=(p.22(b?a.E:((a.E+11)%12)+1)+c+p.22(a.13)+(p.t(a,'1C')?c+p.22(a.14):'')+(b?'':p.t(a,'1o')+p.t(a,'Z')[(a.E<12?0:1)]));p.1R(a,d);p.1a(a)},1a:r(a){7 b=a.w[0];q(a.w.4U(':4V')||$.o.P!=b){u}7 c=p.t(a,'1d');7 d=c.G+2;7 e=(a.x!=a.D?(a.x*d):(a.D*d)-c.G+p.t(a,'1o').G);7 f=e+(a.x!=a.D?2:p.t(a,'Z')[0].G);q(b.3D){b.3D(e,f)}N q(b.1P){7 g=b.1P();g.4W('2p',e);g.3l('2p',f-a.w.T().G);g.4X()}q(!b.3d){b.2b()}},22:r(a){u(a<10?'0':'')+a},1R:r(a,b){q(b!=a.w.T()){a.w.T(b).4Y('4Z')}},W:r(a,b,c){7 d=(a.w.T()==''||a.x==(b==-1?0:I.1l(1,a.V,a.D)));q(!d){a.x+=b}p.1a(a);a.1X='';$.y(a.w[0],m,a);u(d&&c)},R:r(a,b){q(a.w.T()==''){b=0}7 c=p.t(a,'27');p.19(a,F J(0,0,0,a.E+(a.x==0?b*c[0]:0)+(a.x==a.D?b*12:0),a.13+(a.x==1?b*c[1]:0),a.14+(a.x==a.V?b*c[2]:0)))},19:r(a,b){b=p.1A(a,b);7 c=p.1y(a,b?[b.1Y(),b.1Z(),b.21()]:v);b=F J(0,0,0,c[0],c[1],c[2]);7 b=p.25(b);7 d=p.25(p.1A(a,p.t(a,'2I')));7 e=p.25(p.1A(a,p.t(a,'2J')));b=(d&&b<d?d:(e&&b>e?e:b));7 f=p.t(a,'2O');q(f){b=f.1N(a.w[0],[p.3g(a.w[0]),b,d,e])}a.E=b.1Y();a.13=b.1Z();a.14=b.21();p.2A(a);$.y(a.w[0],m,a)},25:r(a){q(!a){u v}a.50(51);a.52(0);a.53(0);u a},1A:r(i,j){7 k=r(a){7 b=F J();b.54(b.2l()+a*3h);u b};7 l=r(a){7 b=$.o.1i(i,a);7 c=F J();7 d=(b?b[0]:c.1Y());7 e=(b?b[1]:c.1Z());7 f=(b?b[2]:c.21());q(!b){7 g=/([+-]?[0-9]+)\\s*(s|S|m|M|h|H)?/g;7 h=g.3E(a);2z(h){2r(h[2]||'s'){A's':A'S':f+=Q(h[1],10);C;A'm':A'M':e+=Q(h[1],10);C;A'h':A'H':d+=Q(h[1],10);C}h=g.3E(a)}}c=F J(0,0,10,d,e,f,0);q(/^!/.55(a)){q(c.3F()>10){c=F J(0,0,10,23,59,59)}N q(c.3F()<10){c=F J(0,0,10,0,0,0)}}u c};u(j?(1h j=='1L'?l(j):(1h j=='56'?k(j):j)):v)},3o:r(a,b){q(b==p.t(a,'1d')){p.W(a,+1,B)}N q(b>='0'&&b<='9'){7 c=Q(b,10);7 d=Q(a.1X+b,10);7 e=p.t(a,'1c');7 f=(a.x!=0?a.E:(e?(d<24?d:c):(d>=1&&d<=12?d:(c>0?c:a.E))%12+(a.E>=12?12:0)));7 g=(a.x!=1?a.13:(d<2m?d:c));7 h=(a.x!=a.V?a.14:(d<2m?d:c));7 i=p.1y(a,[f,g,h]);p.19(a,F J(0,0,0,i[0],i[1],i[2]));a.1X=b}N q(!p.t(a,'1c')){b=b.1g();7 j=p.t(a,'Z');q((b==j[0].1z(0,1).1g()&&a.E>=12)||(b==j[1].1z(0,1).1g()&&a.E<12)){7 k=a.x;a.x=a.D;p.R(a,+1);a.x=k;p.1a(a)}}}});r 1E(a,b){$.1q(a,b);1O(7 c 57 b){q(b[c]==v){a[c]=v}}u a}7 n=['58','2l','5a'];$.1H.o=r(c){7 d=5b.2P.5c.5d(5e,1);q(1h c=='1L'&&$.3f(c,n)>-1){u $.o['3G'+c+'1n'].1N($.o,[p[0]].3H(d))}u p.2t(r(){7 a=p.1J.1g();q(a=='w'){q(1h c=='1L'){$.o['3G'+c+'1n'].1N($.o,[p].3H(d))}N{7 b=($.1H.3I?$(p).3I():{});$.o.2Q(p,$.1q(b,c))}}})};$.o=F 1n()})(5f);",62,326,"|||||||var|||||||||||||||||timeEntry|this|if|function||_get|return|null|input|_field|data||case|false|break|_ampmField|_selectedHour|new|length||Math|Date|browser|true||else|px|_lastInput|parseInt|_adjustField||val|left|_secondField|_changeField|_timer|_disabledInputs|ampmNames||||_selectedMinute|_selectedSecond|span||bind||_setTime|_showField|_getSpinnerTarget|show24Hours|separator|markerClassName|_parseTime|toLowerCase|typeof|_extractTime|_blurredInput|target|max|_getInput|TimeEntry|ampmPrefix|spinnerSize|extend|options|_isDisabledTimeEntry|document|scrollLeft|css|position|top|_constrainTime|substring|_determineTime|_defaults|showSeconds|spinnerBigSize|extendRemove|class|setTimeout|fn|_endSpinner|nodeName|_changeSpinner|string|_focussed|apply|for|createTextRange|offset|_setValue|abs|_expanded|_handlingSpinner|scrollTop|curTop|_lastChr|getHours|getMinutes||getSeconds|_formatNumber|||_normaliseTime|regional|timeSteps|spinnerRepeat|background|width|focus|_doFocus|msie|mousewheel|_handleSpinner|mouseup|mouseout|_describeSpinner|_enableDisable|nextSibling|getTime|60|documentElement|offsetLeft|character|keyCode|switch|safari|each|0px|_getSpinnerRegion|_actionSpinner|_repeatSpinner|_releaseSpinner|while|_showTime|isNaN|spinnerTexts|field|appendText|initialField|useMouseWheel|defaultTime|minTime|maxTime|spinnerImage|spinnerBigImage|spinnerIncDecOnly|beforeShow|beforeSetTime|prototype|_connectTimeEntry|hasClass|style|url|no|repeat|height|mozilla|padding|after|_doBlur|_doClick|_doKeyDown|_doKeyPress|_doMouseWheel||||||mousedown|_expandSpinner|mousemove|disabled|map|inArray|_getTimeTimeEntry|1000|selectionStart|srcElement|clientX|moveEnd|ctrlKey|charCode|_handleKeyPress|opera|parents|absolute|div|_endExpand|one|_findPos|_findScroll|body|99|min|offsetParent|offsetTop|indexOf|setSelectionRange|exec|getDate|_|concat|metadata|AM|PM|Now|Previous|Next|Increment|Decrement|spinnerDefault|png|500|250|hasTimeEntry|setDefaults|spinnerText|timeEntry_control|display|inline||block|version|bottom|wrap|timeEntry_wrap||timeEntry_append||addClass|blur|click|keydown|keypress|paste|mouseover|_enableTimeEntry|_disableTimeEntry|push|_changeTimeEntry|_destroyTimeEntry|removeClass|unbind|unmousewheel|parent|replaceWith|removeData|_setTimeTimeEntry|object|_getOffsetTimeEntry|3600|thin|medium|thick|border|collapse|boundingWidth|shiftKey|String|fromCharCode|undefined|preventDefault|relative|timeEntry_expand|transparent|index|insertAfter|siblings|title|clearTimeout|remove|clientY|fixed|parentNode|split|round|is|hidden|moveStart|select|trigger|change|setFullYear|1900|setMonth|setDate|setTime|test|number|in|getOffset||isDisabled|Array|slice|call|arguments|jQuery".split("|"),0,{}));
(function(b,g){var d={};function c(m,n){var l,j=[];for(var k=0;k<m.length;++k){l=d[m[k]]||e(m[k]);if(!l){throw"module definition dependecy not found: "+m[k]}j.push(l)}n.apply(null,j)}function h(l,k,j){if(typeof l!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(k===g){throw"invalid module definition, dependencies must be specified"}if(j===g){throw"invalid module definition, definition function must be specified"}c(k,function(){d[l]=j.apply(null,arguments)})}function f(j){return !!d[j]}function e(m){var k=b;var j=m.split(/[.\/]/);for(var l=0;l<j.length;++l){if(!k[j[l]]){return}k=k[j[l]]}return k}function a(l){for(var k=0;k<l.length;k++){var m=b;var o=l[k];var j=o.split(/[.\/]/);for(var n=0;n<j.length-1;++n){if(m[j[n]]===g){m[j[n]]={}}m=m[j[n]]}m[j[j.length-1]]=d[o]}}h("moxie/core/utils/Basic",[],function(){var s=function(x){var w;if(x===w){return"undefined"}else{if(x===null){return"null"}else{if(x.nodeType){return"node"}}}return({}).toString.call(x).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()
};var o=function(x){var w;q(arguments,function(y,z){if(z>0){q(y,function(B,A){if(B!==w){if(s(x[A])===s(B)&&!!~v(s(B),["array","object"])){o(x[A],B)}else{x[A]=B}}})}});return x};var q=function(B,C){var A,y,x,z;if(B){try{A=B.length}catch(w){A=z}if(A===z){for(y in B){if(B.hasOwnProperty(y)){if(C(B[y],y)===false){return}}}}else{for(x=0;x<A;x++){if(C(B[x],x)===false){return}}}}};var t=function(w){var x;if(!w||s(w)!=="object"){return true}for(x in w){return false}return true};var m=function(x,w){var y=0,z=x.length;if(s(w)!=="function"){w=function(){}}if(!x||!x.length){w()}function A(B){if(s(x[B])==="function"){x[B](function(C){++B<z&&!C?A(B):w(C)})}}A(y)};var j=function(x,w){var z=0,y=x.length,A=new Array(y);q(x,function(C,B){C(function(E){if(E){return w(E)}var D=[].slice.call(arguments);D.shift();A[B]=D;z++;if(z===y){A.unshift(null);w.apply(this,A)}})})};var v=function(y,z){if(z){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(z,y)}for(var w=0,x=z.length;w<x;w++){if(z[w]===y){return w
}}}return -1};var r=function(x,z){var y=[];if(s(x)!=="array"){x=[x]}if(s(z)!=="array"){z=[z]}for(var w in x){if(v(x[w],z)===-1){y.push(x[w])}}return y.length?y:false};var u=function(y,x){var w=[];q(y,function(z){if(v(z,x)!==-1){w.push(z)}});return w.length?w:null};var n=function(y){var x,w=[];for(x=0;x<y.length;x++){w[x]=y[x]}return w};var p=(function(){var w=0;return function(z){var x=new Date().getTime().toString(32),y;for(y=0;y<5;y++){x+=Math.floor(Math.random()*65535).toString(32)}return(z||"o_")+x+(w++).toString(32)}}());var k=function(w){if(!w){return w}return String.prototype.trim?String.prototype.trim.call(w):w.toString().replace(/^\s*/,"").replace(/\s*$/,"")};var l=function(w){if(typeof(w)!=="string"){return w}var y={t:1099511627776,g:1073741824,m:1048576,k:1024},x;w=/^([0-9]+)([mgk]?)$/.exec(w.toLowerCase().replace(/[^0-9mkg]/g,""));x=w[2];w=+w[1];if(y.hasOwnProperty(x)){w*=y[x]}return w};return{guid:p,typeOf:s,extend:o,each:q,isEmptyObj:t,inSeries:m,inParallel:j,inArray:v,arrayDiff:r,arrayIntersect:u,toArray:n,trim:k,parseSizeStr:l}
});h("moxie/core/I18n",["moxie/core/utils/Basic"],function(k){var j={};return{addI18n:function(l){return k.extend(j,l)},translate:function(l){return j[l]||l},_:function(l){return this.translate(l)},sprintf:function(m){var l=[].slice.call(arguments,1);return m.replace(/%[a-z]/g,function(){var n=l.shift();return k.typeOf(n)!=="undefined"?n:""})}}});h("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(m,l){var j="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe";
var k={mimes:{},extensions:{},addMimeType:function(n){var o=n.split(/,/),p,r,q;for(p=0;p<o.length;p+=2){q=o[p+1].split(/ /);for(r=0;r<q.length;r++){this.mimes[q[r]]=o[p]}this.extensions[o[p]]=q}},extList2mimes:function(t,u){var o=this,s,p,r,q,n=[];for(p=0;p<t.length;p++){s=t[p].extensions.split(/\s*,\s*/);for(r=0;r<s.length;r++){if(s[r]==="*"){return[]}q=o.mimes[s[r]];if(!q){if(u&&/^\w+$/.test(s[r])){n.push("."+s[r])}else{return[]}}else{if(m.inArray(q,n)===-1){n.push(q)}}}}return n},mimes2exts:function(n){var o=this,p=[];m.each(n,function(r){if(r==="*"){p=[];return false}var q=r.match(/^(\w+)\/(\*|\w+)$/);if(q){if(q[2]==="*"){m.each(o.extensions,function(s,t){if((new RegExp("^"+q[1]+"/")).test(t)){[].push.apply(p,o.extensions[t])}})}else{if(o.extensions[r]){[].push.apply(p,o.extensions[r])}}}});return p},mimes2extList:function(n){var p=[],o=[];if(m.typeOf(n)==="string"){n=m.trim(n).split(/\s*,\s*/)}o=this.mimes2exts(n);p.push({title:l.translate("Files"),extensions:o.length?o.join(","):"*"});
p.mimes=n;return p},getFileExtension:function(o){var n=o&&o.match(/\.([^.]+)$/);if(n){return n[1].toLowerCase()}return""},getFileMime:function(n){return this.mimes[this.getFileExtension(n)]||""}};k.addMimeType(j);return k});h("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(n){var l=(function(s){var I="",H="?",C="function",u="undefined",q="object",r="major",D="model",t="name",z="type",x="vendor",F="version",o="architecture",v="console",B="mobile",G="tablet";var p={has:function(K,J){return J.toLowerCase().indexOf(K.toLowerCase())!==-1},lowerize:function(J){return J.toLowerCase()}};var E={rgx:function(){for(var T,N=0,M,L,K,J,O,P,Q=arguments;N<Q.length;N+=2){var S=Q[N],R=Q[N+1];if(typeof(T)===u){T={};for(K in R){J=R[K];if(typeof(J)===q){T[J[0]]=s}else{T[J]=s}}}for(M=L=0;M<S.length;M++){O=S[M].exec(this.getUA());if(!!O){for(K=0;K<R.length;K++){P=O[++L];J=R[K];if(typeof(J)===q&&J.length>0){if(J.length==2){if(typeof(J[1])==C){T[J[0]]=J[1].call(this,P)}else{T[J[0]]=J[1]}}else{if(J.length==3){if(typeof(J[1])===C&&!(J[1].exec&&J[1].test)){T[J[0]]=P?J[1].call(this,P,J[2]):s
}else{T[J[0]]=P?P.replace(J[1],J[2]):s}}else{if(J.length==4){T[J[0]]=P?J[3].call(this,P.replace(J[1],J[2])):s}}}}else{T[J]=P?P:s}}break}}if(!!O){break}}return T},str:function(M,L){for(var K in L){if(typeof(L[K])===q&&L[K].length>0){for(var J=0;J<L[K].length;J++){if(p.has(L[K][J],M)){return(K===H)?s:K}}}else{if(p.has(L[K],M)){return(K===H)?s:K}}}return M}};var A={browser:{oldsafari:{major:{"1":["/8","/1","/3"],"2":"/4","?":"/"},version:{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0","2000":"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0","7":"NT 6.1","8":"NT 6.2","8.1":"NT 6.3",RT:"ARM"}}}};var y={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[t,F,r],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[t,"Opera"],F,r],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[t,F,r],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[t,"IE"],F,r],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[t,"Yandex"],F,r],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[t,/_/g," "],F,r],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[t,F,r],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[t,"Dolphin"],F,r],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[t,"Chrome"],F,r],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[t,"Android Browser"],F,r],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[F,r,[t,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[F,r,t],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[t,[r,E.str,A.browser.oldsafari.major],[F,E.str,A.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[t,F,r],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[t,"Netscape"],F,r],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[t,F,r]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[t,F],[/rv\:([\w\.]+).*(gecko)/i],[F,t]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[t,[F,E.str,A.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[t,"Windows"],[F,E.str,A.os.windows.version]],[/\((bb)(10);/i],[[t,"BlackBerry"],F],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[t,F],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[t,"Symbian"],F],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[t,"Firefox OS"],F],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[t,F],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[t,"Chromium OS"],F],[/(sunos)\s?([\w\.]+\d)*/i],[[t,"Solaris"],F],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[t,F],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[t,"iOS"],[F,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[t,[F,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[t,F]]};
var w=function(J){var K=J||((window&&window.navigator&&window.navigator.userAgent)?window.navigator.userAgent:I);this.getBrowser=function(){return E.rgx.apply(this,y.browser)};this.getEngine=function(){return E.rgx.apply(this,y.engine)};this.getOS=function(){return E.rgx.apply(this,y.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return K};this.setUA=function(L){K=L;return this};this.setUA(K)};return new w().getResult()})();function k(w,u,p){var t=0,v=0,o=0,q={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},r=function(x){x=(""+x).replace(/[_\-+]/g,".");x=x.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return(!x.length?[-8]:x.split("."))},s=function(x){return !x?0:(isNaN(x)?q[x]||-7:parseInt(x,10))};w=r(w);u=r(u);v=Math.max(w.length,u.length);for(t=0;t<v;t++){if(w[t]==u[t]){continue}w[t]=s(w[t]);u[t]=s(u[t]);if(w[t]<u[t]){o=-1;break}else{if(w[t]>u[t]){o=1;break}}}if(!p){return o
}switch(p){case">":case"gt":return(o>0);case">=":case"ge":return(o>=0);case"<=":case"le":return(o<=0);case"==":case"=":case"eq":return(o===0);case"<>":case"!=":case"ne":return(o!==0);case"":case"<":case"lt":return(o<0);default:return null}}var m=(function(){var o={define_property:(function(){return false}()),create_canvas:(function(){var p=document.createElement("canvas");return !!(p.getContext&&p.getContext("2d"))}()),return_response_type:function(p){try{if(n.inArray(p,["","text","document"])!==-1){return true}else{if(window.XMLHttpRequest){var r=new XMLHttpRequest();r.open("get","/");if("responseType" in r){r.responseType=p;if(r.responseType!==p){return false}return true}}}}catch(q){}return false},use_data_uri:(function(){var p=new Image();p.onload=function(){o.use_data_uri=(p.width===1&&p.height===1)};setTimeout(function(){p.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return false}()),use_data_uri_over32kb:function(){return o.use_data_uri&&(j.browser!=="IE"||j.version>=9)
},use_data_uri_of:function(p){return(o.use_data_uri&&p<33000||o.use_data_uri_over32kb())},use_fileinput:function(){var p=document.createElement("input");p.setAttribute("type","file");return !p.disabled}};return function(q){var p=[].slice.call(arguments);p.shift();return n.typeOf(o[q])==="function"?o[q].apply(this,p):!!o[q]}}());var j={can:m,browser:l.browser.name,version:parseFloat(l.browser.major),os:l.os.name,osVersion:l.os.version,verComp:k,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};j.OS=j.os;return j});h("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(k){var l=function(r){if(typeof r!=="string"){return r}return document.getElementById(r)};var m=function(t,s){if(!t.className){return false}var r=new RegExp("(^|\\s+)"+s+"(\\s+|$)");return r.test(t.className)};var n=function(s,r){if(!m(s,r)){s.className=!s.className?r:s.className.replace(/\s+$/,"")+" "+r}};var q=function(t,s){if(t.className){var r=new RegExp("(^|\\s+)"+s+"(\\s+|$)");
t.className=t.className.replace(r,function(v,u,w){return u===" "&&w===" "?" ":""})}};var j=function(s,r){if(s.currentStyle){return s.currentStyle[r]}else{if(window.getComputedStyle){return window.getComputedStyle(s,null)[r]}}};var p=function(s,w){var z=0,v=0,B,A=document,t,u;s=s;w=w||A.body;function r(F){var D,E,C=0,G=0;if(F){E=F.getBoundingClientRect();D=A.compatMode==="CSS1Compat"?A.documentElement:A.body;C=E.left+D.scrollLeft;G=E.top+D.scrollTop}return{x:C,y:G}}if(s&&s.getBoundingClientRect&&k.browser==="IE"&&(!A.documentMode||A.documentMode<8)){t=r(s);u=r(w);return{x:t.x-u.x,y:t.y-u.y}}B=s;while(B&&B!=w&&B.nodeType){z+=B.offsetLeft||0;v+=B.offsetTop||0;B=B.offsetParent}B=s.parentNode;while(B&&B!=w&&B.nodeType){z-=B.scrollLeft||0;v-=B.scrollTop||0;B=B.parentNode}return{x:z,y:v}};var o=function(r){return{w:r.offsetWidth||r.clientWidth,h:r.offsetHeight||r.clientHeight}};return{get:l,hasClass:m,addClass:n,removeClass:q,getStyle:j,getPos:p,getSize:o}});h("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(k){function j(n,m){var l;
for(l in n){if(n[l]===m){return l}}return null}return{RuntimeError:(function(){var l={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};function m(n){this.code=n;this.name=j(l,n);this.message=this.name+": RuntimeError "+this.code}k.extend(m,l);m.prototype=Error.prototype;return m}()),OperationNotAllowedException:(function(){function l(m){this.code=m;this.name="OperationNotAllowedException"}k.extend(l,{NOT_ALLOWED_ERR:1});l.prototype=Error.prototype;return l}()),ImageError:(function(){var l={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};function m(n){this.code=n;this.name=j(l,n);this.message=this.name+": ImageError "+this.code}k.extend(m,l);m.prototype=Error.prototype;return m}()),FileException:(function(){var l={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};function m(n){this.code=n;this.name=j(l,n);this.message=this.name+": FileException "+this.code}k.extend(m,l);m.prototype=Error.prototype;return m}()),DOMException:(function(){var l={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};
function m(n){this.code=n;this.name=j(l,n);this.message=this.name+": DOMException "+this.code}k.extend(m,l);m.prototype=Error.prototype;return m}()),EventException:(function(){function l(m){this.code=m;this.name="EventException"}k.extend(l,{UNSPECIFIED_EVENT_TYPE_ERR:0});l.prototype=Error.prototype;return l}())}});h("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],function(j,k){function l(){var m={};k.extend(this,{uid:null,init:function(){if(!this.uid){this.uid=k.guid("uid_")}},addEventListener:function(r,q,o,p){var n=this,s;r=k.trim(r);if(/\s/.test(r)){k.each(r.split(/\s+/),function(t){n.addEventListener(t,q,o,p)});return}r=r.toLowerCase();o=parseInt(o,10)||0;s=m[this.uid]&&m[this.uid][r]||[];s.push({fn:q,priority:o,scope:p||this});if(!m[this.uid]){m[this.uid]={}}m[this.uid][r]=s},hasEventListener:function(n){return n?!!(m[this.uid]&&m[this.uid][n]):!!m[this.uid]},removeEventListener:function(p,o){p=p.toLowerCase();var q=m[this.uid]&&m[this.uid][p],n;if(q){if(o){for(n=q.length-1;
n>=0;n--){if(q[n].fn===o){q.splice(n,1);break}}}else{q=[]}if(!q.length){delete m[this.uid][p];if(k.isEmptyObj(m[this.uid])){delete m[this.uid]}}}},removeAllEventListeners:function(){if(m[this.uid]){delete m[this.uid]}},dispatchEvent:function(s){var p,q,r,t,u={},v=true,n;if(k.typeOf(s)!=="string"){t=s;if(k.typeOf(t.type)==="string"){s=t.type;if(t.total!==n&&t.loaded!==n){u.total=t.total;u.loaded=t.loaded}u.async=t.async||false}else{throw new j.EventException(j.EventException.UNSPECIFIED_EVENT_TYPE_ERR)}}if(s.indexOf("::")!==-1){(function(w){p=w[0];s=w[1]}(s.split("::")))}else{p=this.uid}s=s.toLowerCase();q=m[p]&&m[p][s];if(q){q.sort(function(x,w){return w.priority-x.priority});r=[].slice.call(arguments);r.shift();u.type=s;r.unshift(u);var o=[];k.each(q,function(w){r[0].target=w.scope;if(u.async){o.push(function(x){setTimeout(function(){x(w.fn.apply(w.scope,r)===false)},1)})}else{o.push(function(x){x(w.fn.apply(w.scope,r)===false)})}});if(o.length){k.inSeries(o,function(w){v=!w})}}return v
},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(n){var p;if(k.typeOf(n)!=="array"){n=[n]}for(var o=0;o<n.length;o++){p="on"+n[o];if(k.typeOf(this[p])==="function"){this.addEventListener(n[o],this[p])}else{if(k.typeOf(this[p])==="undefined"){this[p]=null}}}}})}l.instance=new l();return l});h("moxie/core/utils/Encode",[],function(){var l=function(n){return unescape(encodeURIComponent(n))};var m=function(n){return decodeURIComponent(escape(n))};var k=function(u,z){if(typeof(window.atob)==="function"){return z?m(window.atob(u)):window.atob(u)}var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var p,o,n,y,x,w,v,A,t=0,B=0,r="",s=[];if(!u){return u}u+="";do{y=q.indexOf(u.charAt(t++));x=q.indexOf(u.charAt(t++));w=q.indexOf(u.charAt(t++));
v=q.indexOf(u.charAt(t++));A=y<<18|x<<12|w<<6|v;p=A>>16&255;o=A>>8&255;n=A&255;if(w==64){s[B++]=String.fromCharCode(p)}else{if(v==64){s[B++]=String.fromCharCode(p,o)}else{s[B++]=String.fromCharCode(p,o,n)}}}while(t<u.length);r=s.join("");return z?m(r):r};var j=function(w,B){if(B){l(w)}if(typeof(window.btoa)==="function"){return window.btoa(w)}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var q,p,o,A,z,y,x,C,v=0,D=0,u="",t=[];if(!w){return w}do{q=w.charCodeAt(v++);p=w.charCodeAt(v++);o=w.charCodeAt(v++);C=q<<16|p<<8|o;A=C>>18&63;z=C>>12&63;y=C>>6&63;x=C&63;t[D++]=s.charAt(A)+s.charAt(z)+s.charAt(y)+s.charAt(x)}while(v<w.length);u=t.join("");var n=w.length%3;return(n?u.slice(0,n-3):u)+"===".slice(n||3)};return{utf8_encode:l,utf8_decode:m,atob:k,btoa:j}});h("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(n,m,o){var j={},k={};function l(x,u,s,r,q){var w=this,p,v=n.guid(u+"_"),t=q||"browser";x=x||{};k[v]=this;
s=n.extend({access_binary:false,access_image_binary:false,display_media:false,do_cors:false,drag_and_drop:false,filter_by_extension:true,resize_image:false,report_upload_progress:false,return_response_headers:false,return_response_type:false,return_status_code:true,send_custom_headers:false,select_file:false,select_folder:false,select_multiple:true,send_binary_string:false,send_browser_cookies:true,send_multipart:true,slice_blob:false,stream_upload:false,summon_file_dialog:false,upload_filesize:true,use_http_method:true},s);if(x.preferred_caps){t=l.getMode(r,x.preferred_caps,t)}p=(function(){var y={};return{exec:function(B,z,C,A){if(p[z]){if(!y[B]){y[B]={context:this,instance:new p[z]()}}if(y[B].instance[C]){return y[B].instance[C].apply(this,A)}}},removeInstance:function(z){delete y[z]},removeAllInstances:function(){var z=this;n.each(y,function(B,A){if(n.typeOf(B.instance.destroy)==="function"){B.instance.destroy.call(B.context)}z.removeInstance(A)})}}}());n.extend(this,{initialized:false,uid:v,type:u,mode:l.getMode(r,(x.required_caps),t),shimid:v+"_container",clients:0,options:x,can:function(A,B){var y=arguments[2]||s;
if(n.typeOf(A)==="string"&&n.typeOf(B)==="undefined"){A=l.parseCaps(A)}if(n.typeOf(A)==="object"){for(var z in A){if(!this.can(z,A[z],y)){return false}}return true}if(n.typeOf(y[A])==="function"){return y[A].call(this,B)}else{return(B===y[A])}},getShimContainer:function(){var y,z=m.get(this.shimid);if(!z){y=this.options.container?m.get(this.options.container):document.body;z=document.createElement("div");z.id=this.shimid;z.className="moxie-shim moxie-shim-"+this.type;n.extend(z.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});y.appendChild(z);y=null}return z},getShim:function(){return p},shimExec:function(z,A){var y=[].slice.call(arguments,2);return w.getShim().exec.call(this,this.uid,z,A,y)},exec:function(z,A){var y=[].slice.call(arguments,2);if(w[z]&&w[z][A]){return w[z][A].apply(this,y)}return w.shimExec.apply(this,arguments)},destroy:function(){if(!w){return}var y=m.get(this.shimid);if(y){y.parentNode.removeChild(y)}if(p){p.removeAllInstances()
}this.unbindAll();delete k[this.uid];this.uid=null;v=w=p=y=null}});if(this.mode&&x.required_caps&&!this.can(x.required_caps)){this.mode=false}}l.order="html5,flash,silverlight,html4";l.getRuntime=function(p){return k[p]?k[p]:false};l.addConstructor=function(q,p){p.prototype=o.instance;j[q]=p};l.getConstructor=function(p){return j[p]||null};l.getInfo=function(p){var q=l.getRuntime(p);if(q){return{uid:q.uid,type:q.type,mode:q.mode,can:function(){return q.can.apply(q,arguments)}}}return null};l.parseCaps=function(p){var q={};if(n.typeOf(p)!=="string"){return p||{}}n.each(p.split(","),function(r){q[r]=true});return q};l.can=function(q,s){var r,p=l.getConstructor(q),t;if(p){r=new p({required_caps:s});t=r.mode;r.destroy();return !!t}return false};l.thatCan=function(r,s){var q=(s||l.order).split(/\s*,\s*/);for(var p in q){if(l.can(q[p],r)){return q[p]}}return null};l.getMode=function(p,s,q){var r=null;if(n.typeOf(q)==="undefined"){q="browser"}if(s&&!n.isEmptyObj(p)){n.each(s,function(v,t){if(p.hasOwnProperty(t)){var u=p[t](v);
if(typeof(u)==="string"){u=[u]}if(!r){r=u}else{if(!(r=n.arrayIntersect(r,u))){return(r=false)}}}});if(r){return n.inArray(q,r)!==-1?q:r[0]}else{if(r===false){return false}}}return q};l.capTrue=function(){return true};l.capFalse=function(){return false};l.capTest=function(p){return function(){return !!p}};return l});h("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(j,m,l){return function k(){var n;m.extend(this,{connectRuntime:function(r){var p=this,q;function o(s){var u,t;if(!s.length){p.trigger("RuntimeError",new j.RuntimeError(j.RuntimeError.NOT_INIT_ERR));n=null;return}u=s.shift();t=l.getConstructor(u);if(!t){o(s);return}n=new t(r);n.bind("Init",function(){n.initialized=true;setTimeout(function(){n.clients++;p.trigger("RuntimeInit",n)},1)});n.bind("Error",function(){n.destroy();o(s)});if(!n.mode){n.trigger("Error");return}n.init()}if(m.typeOf(r)==="string"){q=r}else{if(m.typeOf(r.ruid)==="string"){q=r.ruid}}if(q){n=l.getRuntime(q);
if(n){n.clients++;return n}else{throw new j.RuntimeError(j.RuntimeError.NOT_INIT_ERR)}}o((r.runtime_order||l.order).split(/\s*,\s*/))},getRuntime:function(){if(n&&n.uid){return n}n=null;return null},disconnectRuntime:function(){if(n&&--n.clients<=0){n.destroy();n=null}}})}});h("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(m,k,l){var j={};function n(q,p){function o(v,r,t){var s,u=j[this.uid];if(m.typeOf(u)!=="string"||!u.length){return null}s=new n(null,{type:t,size:r-v});s.detach(u.substr(v,s.size));return s}l.call(this);if(q){this.connectRuntime(q)}if(!p){p={}}else{if(m.typeOf(p)==="string"){p={data:p}}}m.extend(this,{uid:p.uid||m.guid("uid_"),ruid:q,size:p.size||0,type:p.type||"",slice:function(t,r,s){if(this.isDetached()){return o.apply(this,arguments)}return this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,r,s)},getSource:function(){if(!j[this.uid]){return null}return j[this.uid]},detach:function(s){if(this.ruid){this.getRuntime().exec.call(this,"Blob","destroy",j[this.uid]);
this.disconnectRuntime();this.ruid=null}s=s||"";var r=s.match(/^data:([^;]*);base64,/);if(r){this.type=r[1];s=k.atob(s.substring(s.indexOf("base64,")+7))}this.size=s.length;j[this.uid]=s},isDetached:function(){return !this.ruid&&m.typeOf(j[this.uid])==="string"},destroy:function(){this.detach();delete j[this.uid]}});if(p.data){this.detach(p.data)}else{j[this.uid]=p}}return n});h("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(l,k,m){function j(o,p){var n,q;if(!p){p={}}if(p.type&&p.type!==""){q=p.type}else{q=k.getFileMime(p.name)}if(p.name){n=p.name.replace(/\\/g,"/");n=n.substr(n.lastIndexOf("/")+1)}else{var r=q.split("/")[0];n=l.guid((r!==""?r:"file")+"_");if(k.extensions[q]){n+="."+k.extensions[q][0]}}m.apply(this,arguments);l.extend(this,{type:q||"",name:n||l.guid("file_"),lastModifiedDate:p.lastModifiedDate||(new Date()).toLocaleString()})}j.prototype=m.prototype;return j});h("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/file/File","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(k,n,m,r,t,l,p,j,q){var s=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];
function o(x){var v=this,u,w,y;if(k.inArray(k.typeOf(x),["string","node"])!==-1){x={browse_button:x}}w=m.get(x.browse_button);if(!w){throw new r.DOMException(r.DOMException.NOT_FOUND_ERR)}y={accept:[{title:l.translate("All Files"),extensions:"*"}],name:"file",multiple:false,required_caps:false,container:w.parentNode||document.body};x=k.extend({},y,x);if(typeof(x.required_caps)==="string"){x.required_caps=j.parseCaps(x.required_caps)}if(typeof(x.accept)==="string"){x.accept=n.mimes2extList(x.accept)}u=m.get(x.container);if(!u){u=document.body}if(m.getStyle(u,"position")==="static"){u.style.position="relative"}u=w=null;q.call(v);k.extend(v,{uid:k.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){v.convertEventPropsToHandlers(s);v.bind("RuntimeInit",function(A,z){v.ruid=z.uid;v.shimid=z.shimid;v.bind("Ready",function(){v.trigger("Refresh")},999);v.bind("Change",function(){var B=z.exec.call(v,"FileInput","getFiles");v.files=[];k.each(B,function(C){if(C.size===0){return true}v.files.push(new p(v.ruid,C))
})},999);v.bind("Refresh",function(){var E,D,C,B;C=m.get(x.browse_button);B=m.get(z.shimid);if(C){E=m.getPos(C,m.get(x.container));D=m.getSize(C);if(B){k.extend(B.style,{top:E.y+"px",left:E.x+"px",width:D.w+"px",height:D.h+"px"})}}B=C=null});z.exec.call(v,"FileInput","init",x)});v.connectRuntime(k.extend({},x,{required_caps:{select_file:true}}))},disable:function(A){var z=this.getRuntime();if(z){z.exec.call(this,"FileInput","disable",k.typeOf(A)==="undefined"?true:A)}},refresh:function(){v.trigger("Refresh")},destroy:function(){var z=this.getRuntime();if(z){z.exec.call(this,"FileInput","destroy");this.disconnectRuntime()}if(k.typeOf(this.files)==="array"){k.each(this.files,function(A){A.destroy()})}this.files=null}})}o.prototype=t.instance;return o});h("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(l,m,q,j,o,p,s,n){var r=["ready","dragenter","dragleave","drop","error"];
function k(u){var t=this,v;if(typeof(u)==="string"){u={drop_zone:u}}v={accept:[{title:l.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:true}};u=typeof(u)==="object"?j.extend({},v,u):v;u.container=m.get(u.drop_zone)||document.body;if(m.getStyle(u.container,"position")==="static"){u.container.style.position="relative"}if(typeof(u.accept)==="string"){u.accept=n.mimes2extList(u.accept)}p.call(t);j.extend(t,{uid:j.guid("uid_"),ruid:null,files:null,init:function(){t.convertEventPropsToHandlers(r);t.bind("RuntimeInit",function(x,w){t.ruid=w.uid;t.bind("Drop",function(){var y=w.exec.call(t,"FileDrop","getFiles");t.files=[];j.each(y,function(z){t.files.push(new o(t.ruid,z))})},999);w.exec.call(t,"FileDrop","init",u);t.dispatchEvent("ready")});t.connectRuntime(u)},destroy:function(){var w=this.getRuntime();if(w){w.exec.call(this,"FileDrop","destroy");this.disconnectRuntime()}this.files=null}})}k.prototype=s.instance;return k});h("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(l,k,m){function j(){this.uid=l.guid("uid_");
k.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}j.prototype=m.instance;return j});h("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/runtime/RuntimeTarget"],function(j,n,p,r,m,o,l){var q=["loadstart","progress","load","abort","error","loadend"];function k(){var s=this,u;j.extend(this,{uid:j.guid("uid_"),readyState:k.EMPTY,result:null,error:null,readAsBinaryString:function(v){t.call(this,"readAsBinaryString",v)},readAsDataURL:function(v){t.call(this,"readAsDataURL",v)},readAsText:function(v){t.call(this,"readAsText",v)},abort:function(){this.result=null;if(j.inArray(this.readyState,[k.EMPTY,k.DONE])!==-1){return}else{if(this.readyState===k.LOADING){this.readyState=k.DONE}}if(u){u.getRuntime().exec.call(this,"FileReader","abort")}this.trigger("abort");this.trigger("loadend")},destroy:function(){this.abort();if(u){u.getRuntime().exec.call(this,"FileReader","destroy");
u.disconnectRuntime()}s=u=null}});function t(A,w){u=new l();function y(B){s.readyState=k.DONE;s.error=B;s.trigger("error");x()}function x(){u.destroy();u=null;s.trigger("loadend")}function v(B){u.bind("Error",function(D,C){y(C)});u.bind("Progress",function(C){s.result=B.exec.call(u,"FileReader","getResult");s.trigger(C)});u.bind("Load",function(C){s.readyState=k.DONE;s.result=B.exec.call(u,"FileReader","getResult");s.trigger(C);x()});B.exec.call(u,"FileReader","read",A,w)}this.convertEventPropsToHandlers(q);if(this.readyState===k.LOADING){return y(new p.DOMException(p.DOMException.INVALID_STATE_ERR))}this.readyState=k.LOADING;this.trigger("loadstart");if(w instanceof m){if(w.isDetached()){var z=w.getSource();switch(A){case"readAsText":case"readAsBinaryString":this.result=z;break;case"readAsDataURL":this.result="data:"+w.type+";base64,"+n.btoa(z);break}this.readyState=k.DONE;this.trigger("load");x()}else{v(u.connectRuntime(w.ruid))}}else{y(new p.DOMException(p.DOMException.NOT_FOUND_ERR))
}}}k.EMPTY=0;k.LOADING=1;k.DONE=2;k.prototype=r.instance;return k});h("moxie/core/utils/Url",[],function(){var j=function(n,u){var t=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],q=t.length,r={http:80,https:443},o={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,p=s.exec(n||"");while(q--){if(p[q]){o[t[q]]=p[q]}}if(!o.scheme){if(!u||typeof(u)==="string"){u=j(u||document.location.href)}o.scheme=u.scheme;o.host=u.host;o.port=u.port;var v="";if(/^[^\/]/.test(o.path)){v=u.path;if(!/(\/|\/[^\.]+)$/.test(v)){v=v.replace(/\/[^\/]+$/,"/")}else{v+="/"}}o.path=v+(o.path||"")}if(!o.port){o.port=r[o.scheme]||80}o.port=parseInt(o.port,10);if(!o.path){o.path="/"}delete o.source;return o};var l=function(n){var o={http:80,https:443},m=j(n);return m.scheme+"://"+m.host+(m.port!==o[m.scheme]?":"+m.port:"")+m.path+(m.query?m.query:"")
};var k=function(n){function m(o){return[o.scheme,o.host,o.port].join("/")}if(typeof n==="string"){n=j(n)}return m(j())===m(n)};return{parseUrl:j,resolveUrl:l,hasSameOrigin:k}});h("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(l,k,j){return function(){k.call(this);l.extend(this,{uid:l.guid("uid_"),readAsBinaryString:function(n){return m.call(this,"readAsBinaryString",n)},readAsDataURL:function(n){return m.call(this,"readAsDataURL",n)},readAsText:function(n){return m.call(this,"readAsText",n)}});function m(t,p){if(p.isDetached()){var s=p.getSource();switch(t){case"readAsBinaryString":return s;case"readAsDataURL":return"data:"+p.type+";base64,"+j.btoa(s);case"readAsText":var o="";for(var q=0,r=s.length;q<r;q++){o+=String.fromCharCode(s[q])}return o}}else{var n=this.connectRuntime(p.ruid).exec.call(this,"FileReaderSync","read",t,p);this.disconnectRuntime();return n}}}});h("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(j,k,m){function l(){var n,o=[];
k.extend(this,{append:function(q,r){var p=this,s=k.typeOf(r);if(r instanceof m){n={name:q,value:r}}else{if("array"===s){q+="[]";k.each(r,function(t){p.append(q,t)})}else{if("object"===s){k.each(r,function(u,t){p.append(q+"["+t+"]",u)})}else{if("null"===s||"undefined"===s||"number"===s&&isNaN(r)){p.append(q,"false")}else{o.push({name:q,value:r.toString()})}}}}},hasBlob:function(){return !!this.getBlob()},getBlob:function(){return n&&n.value||null},getBlobName:function(){return n&&n.name||null},each:function(p){k.each(o,function(q){p(q.value,q.name)});if(n){p(n.value,n.name)}},destroy:function(){n=null;o=[]}})}return l});h("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(r,s,q,z,v,p,t,o,y,A,j,u){var k={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};
function n(){this.uid=r.guid("uid_")}n.prototype=q.instance;var m=["loadstart","progress","abort","error","load","timeout","loadend"];var l=1,B=2;function w(){var S=this,F={timeout:0,readyState:w.UNSENT,withCredentials:false,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},Y=true,K,Q,R={},T,H,J=null,L=null,ab=false,C=false,x=false,M=false,E=false,I=false,O,X,W=null,Z=null,U={},P,V="",D;r.extend(this,F,{uid:r.guid("uid_"),upload:new n(),open:function(ah,af,ag,ad,ae){var ac;if(!ah||!af){throw new s.DOMException(s.DOMException.SYNTAX_ERR)}if(/[\u0100-\uffff]/.test(ah)||z.utf8_encode(ah)!==ah){throw new s.DOMException(s.DOMException.SYNTAX_ERR)}if(!!~r.inArray(ah.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])){Q=ah.toUpperCase()}if(!!~r.inArray(Q,["CONNECT","TRACE","TRACK"])){throw new s.DOMException(s.DOMException.SECURITY_ERR)}af=z.utf8_encode(af);ac=v.parseUrl(af);I=v.hasSameOrigin(ac);K=v.resolveUrl(af);if((ad||ae)&&!I){throw new s.DOMException(s.DOMException.INVALID_ACCESS_ERR)
}T=ad||ac.user;H=ae||ac.pass;Y=ag||true;if(Y===false&&(aa("timeout")||aa("withCredentials")||aa("responseType")!=="")){throw new s.DOMException(s.DOMException.INVALID_ACCESS_ERR)}ab=!Y;C=false;R={};N.call(this);aa("readyState",w.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(ae,ad){var ac=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(aa("readyState")!==w.OPENED||C){throw new s.DOMException(s.DOMException.INVALID_STATE_ERR)}if(/[\u0100-\uffff]/.test(ae)||z.utf8_encode(ae)!==ae){throw new s.DOMException(s.DOMException.SYNTAX_ERR)}ae=r.trim(ae).toLowerCase();if(!!~r.inArray(ae,ac)||/^(proxy\-|sec\-)/.test(ae)){return false}if(!R[ae]){R[ae]=ad}else{R[ae]+=", "+ad
}return true},getAllResponseHeaders:function(){return V||""},getResponseHeader:function(ac){ac=ac.toLowerCase();if(E||!!~r.inArray(ac,["set-cookie","set-cookie2"])){return null}if(V&&V!==""){if(!D){D={};r.each(V.split(/\r\n/),function(ad){var ae=ad.split(/:\s+/);if(ae.length===2){ae[0]=r.trim(ae[0]);D[ae[0].toLowerCase()]={header:ae[0],value:r.trim(ae[1])}}})}if(D.hasOwnProperty(ac)){return D[ac].header+": "+D[ac].value}}return null},overrideMimeType:function(ad){var ac,ae;if(!!~r.inArray(aa("readyState"),[w.LOADING,w.DONE])){throw new s.DOMException(s.DOMException.INVALID_STATE_ERR)}ad=r.trim(ad.toLowerCase());if(/;/.test(ad)&&(ac=ad.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))){ad=ac[1];if(ac[2]){ae=ac[2]}}if(!u.mimes[ad]){throw new s.DOMException(s.DOMException.SYNTAX_ERR)}W=ad;Z=ae},send:function(ae,ad){if(r.typeOf(ad)==="string"){U={ruid:ad}}else{if(!ad){U={}}else{U=ad}}this.convertEventPropsToHandlers(m);this.upload.convertEventPropsToHandlers(m);if(this.readyState!==w.OPENED||C){throw new s.DOMException(s.DOMException.INVALID_STATE_ERR)
}if(ae instanceof o){U.ruid=ae.ruid;L=ae.type||"application/octet-stream"}else{if(ae instanceof A){if(ae.hasBlob()){var ac=ae.getBlob();U.ruid=ac.ruid;L=ac.type||"application/octet-stream"}}else{if(typeof ae==="string"){J="UTF-8";L="text/plain;charset=UTF-8";ae=z.utf8_encode(ae)}}}if(!this.withCredentials){this.withCredentials=(U.required_caps&&U.required_caps.send_browser_cookies)&&!I}x=(!ab&&this.upload.hasEventListener());E=false;M=!ae;if(!ab){C=true}G.call(this,ae)},abort:function(){E=true;ab=false;if(!~r.inArray(aa("readyState"),[w.UNSENT,w.OPENED,w.DONE])){aa("readyState",w.DONE);C=false;if(P){P.getRuntime().exec.call(P,"XMLHttpRequest","abort",M)}else{throw new s.DOMException(s.DOMException.INVALID_STATE_ERR)}M=true}else{aa("readyState",w.UNSENT)}},destroy:function(){if(P){if(r.typeOf(P.destroy)==="function"){P.destroy()}P=null}this.unbindAll();if(this.upload){this.upload.unbindAll();this.upload=null}}});function aa(ad,ac){if(!F.hasOwnProperty(ad)){return}if(arguments.length===1){return j.can("define_property")?F[ad]:S[ad]
}else{if(j.can("define_property")){F[ad]=ac}else{S[ad]=ac}}}function G(af){var ad=this;O=new Date().getTime();P=new t();function ae(){P.destroy();P=null;ad.dispatchEvent("loadend");ad=null}function ac(ag){P.bind("LoadStart",function(ah){aa("readyState",w.LOADING);ad.dispatchEvent("readystatechange");ad.dispatchEvent(ah);if(x){ad.upload.dispatchEvent(ah)}});P.bind("Progress",function(ah){if(aa("readyState")!==w.LOADING){aa("readyState",w.LOADING);ad.dispatchEvent("readystatechange")}ad.dispatchEvent(ah)});P.bind("UploadProgress",function(ah){if(x){ad.upload.dispatchEvent({type:"progress",lengthComputable:false,total:ah.total,loaded:ah.loaded})}});P.bind("Load",function(ah){aa("readyState",w.DONE);aa("status",Number(ag.exec.call(P,"XMLHttpRequest","getStatus")||0));aa("statusText",k[aa("status")]||"");aa("response",ag.exec.call(P,"XMLHttpRequest","getResponse",aa("responseType")));if(!!~r.inArray(aa("responseType"),["text",""])){aa("responseText",aa("response"))}else{if(aa("responseType")==="document"){aa("responseXML",aa("response"))
}}V=ag.exec.call(P,"XMLHttpRequest","getAllResponseHeaders");ad.dispatchEvent("readystatechange");if(aa("status")>0){if(x){ad.upload.dispatchEvent(ah)}ad.dispatchEvent(ah)}else{E=true;ad.dispatchEvent("error")}ae()});P.bind("Abort",function(ah){ad.dispatchEvent(ah);ae()});P.bind("Error",function(ah){E=true;aa("readyState",w.DONE);ad.dispatchEvent("readystatechange");M=true;ad.dispatchEvent(ah);ae()});ag.exec.call(P,"XMLHttpRequest","send",{url:K,method:Q,async:Y,user:T,password:H,headers:R,mimeType:L,encoding:J,responseType:ad.responseType,withCredentials:ad.withCredentials,options:U},af)}if(typeof(U.required_caps)==="string"){U.required_caps=p.parseCaps(U.required_caps)}U.required_caps=r.extend({},U.required_caps,{return_response_type:ad.responseType});if(af instanceof A){U.required_caps.send_multipart=true}if(!I){U.required_caps.do_cors=true}if(U.ruid){ac(P.connectRuntime(U))}else{P.bind("RuntimeInit",function(ah,ag){ac(ag)});P.bind("RuntimeError",function(ah,ag){ad.dispatchEvent("RuntimeError",ag)
});P.connectRuntime(U)}}function N(){aa("responseText","");aa("responseXML",null);aa("response",null);aa("status",0);aa("statusText","");O=X=null}}w.UNSENT=0;w.OPENED=1;w.HEADERS_RECEIVED=2;w.LOADING=3;w.DONE=4;w.prototype=q.instance;return w});h("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(m,j,k,n){function l(){var s,q,o,t,w,v;k.call(this);m.extend(this,{uid:m.guid("uid_"),state:l.IDLE,result:null,transport:function(B,A,z){var y=this;z=m.extend({chunk_size:204798},z);if((s=z.chunk_size%3)){z.chunk_size+=3-s}v=z.chunk_size;u.call(this);o=B;t=B.length;if(m.typeOf(z)==="string"||z.ruid){r.call(y,A,this.connectRuntime(z))}else{var x=function(D,C){y.unbind("RuntimeInit",x);r.call(y,A,C)};this.bind("RuntimeInit",x);this.connectRuntime(z)}},abort:function(){var x=this;x.state=l.IDLE;if(q){q.exec.call(x,"Transporter","clear");x.trigger("TransportingAborted")}u.call(x)},destroy:function(){this.unbindAll();
q=null;this.disconnectRuntime();u.call(this)}});function u(){t=w=0;o=this.result=null}function r(y,z){var x=this;q=z;x.bind("TransportingProgress",function(A){w=A.loaded;if(w<t&&m.inArray(x.state,[l.IDLE,l.DONE])===-1){p.call(x)}},999);x.bind("TransportingComplete",function(){w=t;x.state=l.DONE;o=null;x.result=q.exec.call(x,"Transporter","getAsBlob",y||"")},999);x.state=l.BUSY;x.trigger("TransportingStarted");p.call(x)}function p(){var x=this,y,z=t-w;if(v>z){v=z}y=j.btoa(o.substr(w,v));q.exec.call(x,"Transporter","receive",y,t)}}l.IDLE=0;l.BUSY=1;l.DONE=2;l.prototype=n.instance;return l});h("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(l,o,u,s,v,k,t,n,r,y,m,q,p){var w=["progress","load","error","resize","embedded"];
function j(){t.call(this);l.extend(this,{uid:l.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){z.call(this)},999);this.convertEventPropsToHandlers(w);A.apply(this,arguments)},downsize:function(H,D,G,E){try{if(!this.size){throw new u.DOMException(u.DOMException.INVALID_STATE_ERR)}if(this.width>j.MAX_RESIZE_WIDTH||this.height>j.MAX_RESIZE_HEIGHT){throw new u.ImageError(u.ImageError.MAX_RESOLUTION_ERR)}if(!H&&!D||l.typeOf(G)==="undefined"){G=false}H=H||this.width;D=D||this.height;E=(l.typeOf(E)==="undefined"?true:!!E);this.getRuntime().exec.call(this,"Image","downsize",H,D,G,E)}catch(F){this.trigger("error",F)}},crop:function(F,D,E){this.downsize(F,D,true,E)},getAsCanvas:function(){if(!r.can("create_canvas")){throw new u.RuntimeError(u.RuntimeError.NOT_SUPPORTED_ERR)}var D=this.connectRuntime(this.ruid);return D.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(D,E){if(!this.size){throw new u.DOMException(u.DOMException.INVALID_STATE_ERR)
}if(!D){D="image/jpeg"}if(D==="image/jpeg"&&!E){E=90}return this.getRuntime().exec.call(this,"Image","getAsBlob",D,E)},getAsDataURL:function(D,E){if(!this.size){throw new u.DOMException(u.DOMException.INVALID_STATE_ERR)}return this.getRuntime().exec.call(this,"Image","getAsDataURL",D,E)},getAsBinaryString:function(D,F){var E=this.getAsDataURL(D,F);return p.atob(E.substring(E.indexOf("base64,")+7))},embed:function(G){var O=this,L,K,M,I,P=arguments[1]||{},F=this.width,N=this.height,H;function E(){if(r.can("create_canvas")){var Q=L.getAsCanvas();if(Q){G.appendChild(Q);Q=null;L.destroy();O.trigger("embedded");return}}var S=L.getAsDataURL(K,M);if(!S){throw new u.ImageError(u.ImageError.WRONG_FORMAT)}if(r.can("use_data_uri_of",S.length)){G.innerHTML='<img src="'+S+'" width="'+L.width+'" height="'+L.height+'" />';L.destroy();O.trigger("embedded")}else{var R=new n();R.bind("TransportingComplete",function(){H=O.connectRuntime(this.result.ruid);O.bind("Embedded",function(){l.extend(H.getShimContainer().style,{top:"0px",left:"0px",width:L.width+"px",height:L.height+"px"});
H=null},999);H.exec.call(O,"ImageView","display",this.result.uid,F,N);L.destroy()});R.transport(p.atob(S.substring(S.indexOf("base64,")+7)),K,l.extend({},P,{required_caps:{display_media:true},runtime_order:"flash,silverlight",container:G}))}}try{if(!(G=o.get(G))){throw new u.DOMException(u.DOMException.INVALID_NODE_TYPE_ERR)}if(!this.size){throw new u.DOMException(u.DOMException.INVALID_STATE_ERR)}if(this.width>j.MAX_RESIZE_WIDTH||this.height>j.MAX_RESIZE_HEIGHT){throw new u.ImageError(u.ImageError.MAX_RESOLUTION_ERR)}K=P.type||this.type||"image/jpeg";M=P.quality||90;I=l.typeOf(P.crop)!=="undefined"?P.crop:false;if(P.width){F=P.width;N=P.height||F}else{var D=o.getSize(G);if(D.w&&D.h){F=D.w;N=D.h}}L=new j();L.bind("Resize",function(){E.call(O)});L.bind("Load",function(){L.downsize(F,N,I,false)});L.clone(this,false);return L}catch(J){this.trigger("error",J)}},destroy:function(){if(this.ruid){this.getRuntime().exec.call(this,"Image","destroy");this.disconnectRuntime()}this.unbindAll()}});function z(D){if(!D){D=this.getRuntime().exec.call(this,"Image","getInfo")
}this.size=D.size;this.width=D.width;this.height=D.height;this.type=D.type;this.meta=D.meta;if(this.name===""){this.name=D.name}}function A(F){var E=l.typeOf(F);try{if(F instanceof j){if(!F.size){throw new u.DOMException(u.DOMException.INVALID_STATE_ERR)}x.apply(this,arguments)}else{if(F instanceof m){if(!~l.inArray(F.type,["image/jpeg","image/png"])){throw new u.ImageError(u.ImageError.WRONG_FORMAT)}B.apply(this,arguments)}else{if(l.inArray(E,["blob","file"])!==-1){A.call(this,new q(null,F),arguments[1])}else{if(E==="string"){if(/^data:[^;]*;base64,/.test(F)){A.call(this,new m(null,{data:F}),arguments[1])}else{C.apply(this,arguments)}}else{if(E==="node"&&F.nodeName.toLowerCase()==="img"){A.call(this,F.src,arguments[1])}else{throw new u.DOMException(u.DOMException.TYPE_MISMATCH_ERR)}}}}}}catch(D){this.trigger("error",D)}}function x(D,E){var F=this.connectRuntime(D.ruid);this.ruid=F.uid;F.exec.call(this,"Image","loadFromImage",D,(l.typeOf(E)==="undefined"?true:E))}function B(F,G){var E=this;
E.name=F.name||"";function D(H){E.ruid=H.uid;H.exec.call(E,"Image","loadFromBlob",F)}if(F.isDetached()){this.bind("RuntimeInit",function(I,H){D(H)});if(G&&typeof(G.required_caps)==="string"){G.required_caps=k.parseCaps(G.required_caps)}this.connectRuntime(l.extend({required_caps:{access_image_binary:true,resize_image:true}},G))}else{D(this.connectRuntime(F.ruid))}}function C(F,E){var D=this,G;G=new v();G.open("get",F);G.responseType="blob";G.onprogress=function(H){D.trigger(H)};G.onload=function(){B.call(D,G.response,true)};G.onerror=function(H){D.trigger(H)};G.onloadend=function(){G.destroy()};G.bind("RuntimeError",function(I,H){D.trigger("RuntimeError",H)});G.send(null,E)}}j.MAX_RESIZE_WIDTH=6500;j.MAX_RESIZE_HEIGHT=6500;j.prototype=y.instance;return j});h("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(o,j,l,k){var n="html5",m={};function p(r){var q=this,u=l.capTest,t=l.capTrue;var s=o.extend({access_binary:u(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return q.can("access_binary")&&!!m.Image
},display_media:u(k.can("create_canvas")||k.can("use_data_uri_over32kb")),do_cors:u(window.XMLHttpRequest&&"withCredentials" in new XMLHttpRequest()),drag_and_drop:u(function(){var v=document.createElement("div");return(("draggable" in v)||("ondragstart" in v&&"ondrop" in v))&&(k.browser!=="IE"||k.version>9)}()),filter_by_extension:u(function(){return(k.browser==="Chrome"&&k.version>=28)||(k.browser==="IE"&&k.version>=10)}()),return_response_headers:t,return_response_type:function(v){if(v==="json"&&!!window.JSON){return true}return k.can("return_response_type",v)},return_status_code:t,report_upload_progress:u(window.XMLHttpRequest&&new XMLHttpRequest().upload),resize_image:function(){return q.can("access_binary")&&k.can("create_canvas")},select_file:function(){return k.can("use_fileinput")&&window.File},select_folder:function(){return q.can("select_file")&&k.browser==="Chrome"&&k.version>=21},select_multiple:function(){return q.can("select_file")&&!(k.browser==="Safari"&&k.os==="Windows")&&!(k.os==="iOS"&&k.verComp(k.osVersion,"7.0.4","<"))
},send_binary_string:u(window.XMLHttpRequest&&(new XMLHttpRequest().sendAsBinary||(window.Uint8Array&&window.ArrayBuffer))),send_custom_headers:u(window.XMLHttpRequest),send_multipart:function(){return !!(window.XMLHttpRequest&&new XMLHttpRequest().upload&&window.FormData)||q.can("send_binary_string")},slice_blob:u(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return q.can("slice_blob")&&q.can("send_multipart")},summon_file_dialog:u(function(){return(k.browser==="Firefox"&&k.version>=4)||(k.browser==="Opera"&&k.version>=12)||(k.browser==="IE"&&k.version>=10)||!!~o.inArray(k.browser,["Chrome","Safari"])}()),upload_filesize:t},arguments[2]);l.call(this,r,(arguments[1]||n),s);o.extend(this,{init:function(){this.trigger("Init")},destroy:(function(v){return function(){v.call(q);v=q=null}}(this.destroy))});o.extend(this.getShim(),m)}l.addConstructor(n,p);return m});h("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(k,l){function j(){function m(o,r,n){var p;
if(window.File.prototype.slice){try{o.slice();return o.slice(r,n)}catch(q){return o.slice(r,n-r)}}else{if((p=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)){return p.call(o,r,n)}else{return null}}}this.slice=function(){return new l(this.getRuntime().uid,m.apply(this,arguments))}}return(k.Blob=j)});h("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(p){var q={},m="moxie_"+p.guid();function l(){this.returnValue=false}function k(){this.cancelBubble=true}var n=function(v,r,w,t){var u,s;r=r.toLowerCase();if(v.addEventListener){u=w;v.addEventListener(r,u,false)}else{if(v.attachEvent){u=function(){var x=window.event;if(!x.target){x.target=x.srcElement}x.preventDefault=l;x.stopPropagation=k;w(x)};v.attachEvent("on"+r,u)}}if(!v[m]){v[m]=p.guid()}if(!q.hasOwnProperty(v[m])){q[v[m]]={}}s=q[v[m]];if(!s.hasOwnProperty(r)){s[r]=[]}s[r].push({func:u,orig:w,key:t})};var o=function(w,r,x){var u,t;r=r.toLowerCase();if(w[m]&&q[w[m]]&&q[w[m]][r]){u=q[w[m]][r]}else{return}for(var s=u.length-1;
s>=0;s--){if(u[s].orig===x||u[s].key===x){if(w.removeEventListener){w.removeEventListener(r,u[s].func,false)}else{if(w.detachEvent){w.detachEvent("on"+r,u[s].func)}}u[s].orig=null;u[s].func=null;u.splice(s,1);if(x!==t){break}}}if(!u.length){delete q[w[m]][r]}if(p.isEmptyObj(q[w[m]])){delete q[w[m]];try{delete w[m]}catch(v){w[m]=t}}};var j=function(s,r){if(!s||!s[m]){return}p.each(q[s[m]],function(u,t){o(s,t,r)})};return{addEvent:n,removeEvent:o,removeAllEvents:j}});h("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(n,p,m,k,l,j){function o(){var r=[],q;p.extend(this,{init:function(B){var s=this,z=s.getRuntime(),y,u,v,A,x,w;q=B;r=[];v=q.accept.mimes||l.extList2mimes(q.accept,z.can("filter_by_extension"));u=z.getShimContainer();u.innerHTML='<input id="'+z.uid+'" type="file" style="font-size:999px;opacity:0;"'+(q.multiple&&z.can("select_multiple")?"multiple":"")+(q.directory&&z.can("select_folder")?"webkitdirectory directory":"")+(v?' accept="'+v.join(",")+'"':"")+" />";
y=m.get(z.uid);p.extend(y.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});A=m.get(q.browse_button);if(z.can("summon_file_dialog")){if(m.getStyle(A,"position")==="static"){A.style.position="relative"}x=parseInt(m.getStyle(A,"z-index"),10)||1;A.style.zIndex=x;u.style.zIndex=x-1;k.addEvent(A,"click",function(D){var C=m.get(z.uid);if(C&&!C.disabled){C.click()}D.preventDefault()},s.uid)}w=z.can("summon_file_dialog")?A:u;k.addEvent(w,"mouseover",function(){s.trigger("mouseenter")},s.uid);k.addEvent(w,"mouseout",function(){s.trigger("mouseleave")},s.uid);k.addEvent(w,"mousedown",function(){s.trigger("mousedown")},s.uid);k.addEvent(m.get(q.container),"mouseup",function(){s.trigger("mouseup")},s.uid);y.onchange=function t(){r=[];if(q.directory){p.each(this.files,function(D){if(D.name!=="."){r.push(D)}})}else{r=[].slice.call(this.files)}if(j.browser!=="IE"){this.value=""}else{var C=this.cloneNode(true);this.parentNode.replaceChild(C,this);C.onchange=t}s.trigger("change")};s.trigger({type:"ready",async:true});
u=null},getFiles:function(){return r},disable:function(u){var t=this.getRuntime(),s;if((s=m.get(t.uid))){s.disabled=!!u}},destroy:function(){var t=this.getRuntime(),u=t.getShim(),s=t.getShimContainer();k.removeAllEvents(s,this.uid);k.removeAllEvents(q&&m.get(q.container),this.uid);k.removeAllEvents(q&&m.get(q.browse_button),this.uid);if(s){s.innerHTML=""}u.removeInstance(this.uid);r=q=s=u=null}})}return(n.FileInput=o)});h("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(m,n,l,j,k){function o(){var q=[],s=[],w;n.extend(this,{init:function(z){var y=this,A;w=z;s=r(w.accept);A=w.container;j.addEvent(A,"dragover",function(B){B.preventDefault();B.stopPropagation();B.dataTransfer.dropEffect="copy"},y.uid);j.addEvent(A,"drop",function(B){B.preventDefault();B.stopPropagation();q=[];if(B.dataTransfer.items&&B.dataTransfer.items[0].webkitGetAsEntry){v(B.dataTransfer.items,function(){y.trigger("drop")
})}else{n.each(B.dataTransfer.files,function(C){if(u(C)){q.push(C)}});y.trigger("drop")}},y.uid);j.addEvent(A,"dragenter",function(B){B.preventDefault();B.stopPropagation();y.trigger("dragenter")},y.uid);j.addEvent(A,"dragleave",function(B){B.preventDefault();B.stopPropagation();y.trigger("dragleave")},y.uid)},getFiles:function(){return q},destroy:function(){j.removeAllEvents(w&&l.get(w.container),this.uid);q=s=w=null}});function r(A){var z=[];for(var y=0;y<A.length;y++){[].push.apply(z,A[y].extensions.split(/\s*,\s*/))}return n.inArray("*",z)===-1?z:[]}function u(y){var z=k.getFileExtension(y.name);return !z||!s.length||n.inArray(z,s)!==-1}function v(A,z){var y=[];n.each(A,function(D){var C=D.webkitGetAsEntry();if(C){if(C.isFile){var B=D.getAsFile();if(u(B)){q.push(B)}}else{y.push(C)}}});if(y.length){t(y,z)}else{z()}}function t(A,z){var y=[];n.each(A,function(B){y.push(function(C){p(B,C)})});n.inSeries(y,function(){z()})}function p(z,y){if(z.isFile){z.file(function(A){if(u(A)){q.push(A)
}y()},function(){y()})}else{if(z.isDirectory){x(z,y)}else{y()}}}function x(C,z){var y=[],B=C.createReader();function A(D){B.readEntries(function(E){if(E.length){[].push.apply(y,E);A(D)}else{D()}},D)}A(function(){t(y,z)})}}return(m.FileDrop=o)});h("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(k,j,m){function l(){var o,p=false;m.extend(this,{read:function(s,q){var r=this;o=new window.FileReader();o.addEventListener("progress",function(t){r.trigger(t)});o.addEventListener("load",function(t){r.trigger(t)});o.addEventListener("error",function(t){r.trigger(t,o.error)});o.addEventListener("loadend",function(){o=null});if(m.typeOf(o[s])==="function"){p=false;o[s](q.getSource())}else{if(s==="readAsBinaryString"){p=true;o.readAsDataURL(q.getSource())}}},getResult:function(){return o&&o.result?(p?n(o.result):o.result):null},abort:function(){if(o){o.abort()}},destroy:function(){o=null}});function n(q){return j.atob(q.substring(q.indexOf("base64,")+7))
}}return(k.FileReader=l)});h("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(p,k,m,j,o,l,s,q,n){function r(){var v=this,z,x;k.extend(this,{send:function(H,E){var G=this,D=(n.browser==="Mozilla"&&n.version>=4&&n.version<7),A=n.browser==="Android Browser",F=false;x=H.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();z=y();z.open(H.method,H.url,H.async,H.user,H.password);if(E instanceof l){if(E.isDetached()){F=true}E=E.getSource()}else{if(E instanceof s){if(E.hasBlob()){if(E.getBlob().isDetached()){E=w.call(G,E);F=true}else{if((D||A)&&k.typeOf(E.getBlob().getSource())==="blob"&&window.FileReader){t.call(G,H,E);return}}}if(E instanceof s){var C=new window.FormData();E.each(function(J,I){if(J instanceof l){C.append(I,J.getSource())}else{C.append(I,J)}});E=C}}}if(z.upload){if(H.withCredentials){z.withCredentials=true
}z.addEventListener("load",function(I){G.trigger(I)});z.addEventListener("error",function(I){G.trigger(I)});z.addEventListener("progress",function(I){G.trigger(I)});z.upload.addEventListener("progress",function(I){G.trigger({type:"UploadProgress",loaded:I.loaded,total:I.total})})}else{z.onreadystatechange=function B(){switch(z.readyState){case 1:break;case 2:break;case 3:var K,I;try{if(j.hasSameOrigin(H.url)){K=z.getResponseHeader("Content-Length")||0}if(z.responseText){I=z.responseText.length}}catch(J){K=I=0}G.trigger({type:"progress",lengthComputable:!!K,total:parseInt(K,10),loaded:I});break;case 4:z.onreadystatechange=function(){};if(z.status===0){G.trigger("error")}else{G.trigger("load")}break}}}if(!k.isEmptyObj(H.headers)){k.each(H.headers,function(I,J){z.setRequestHeader(J,I)})}if(""!==H.responseType&&"responseType" in z){if("json"===H.responseType&&!n.can("return_response_type","json")){z.responseType="text"}else{z.responseType=H.responseType}}if(!F){z.send(E)}else{if(z.sendAsBinary){z.sendAsBinary(E)
}else{(function(){var I=new Uint8Array(E.length);for(var J=0;J<E.length;J++){I[J]=(E.charCodeAt(J)&255)}z.send(I.buffer)}())}}G.trigger("loadstart")},getStatus:function(){try{if(z){return z.status}}catch(A){}return 0},getResponse:function(C){var B=this.getRuntime();try{switch(C){case"blob":var E=new o(B.uid,z.response);var F=z.getResponseHeader("Content-Disposition");if(F){var A=F.match(/filename=([\'\"'])([^\1]+)\1/);if(A){x=A[2]}}E.name=x;if(!E.type){E.type=m.getFileMime(x)}return E;case"json":if(!n.can("return_response_type","json")){return z.status===200&&!!window.JSON?JSON.parse(z.responseText):null}return z.response;case"document":return u(z);default:return z.responseText!==""?z.responseText:null}}catch(D){return null}},getAllResponseHeaders:function(){try{return z.getAllResponseHeaders()}catch(A){}return""},abort:function(){if(z){z.abort()}},destroy:function(){v=x=null}});function t(E,C){var D=this,B,A;B=C.getBlob().getSource();A=new window.FileReader();A.onload=function(){C.append(C.getBlobName(),new l(null,{type:B.type,data:A.result}));
v.send.call(D,E,C)};A.readAsBinaryString(B)}function y(){if(window.XMLHttpRequest&&!(n.browser==="IE"&&n.version<8)){return new window.XMLHttpRequest()}else{return(function(){var A=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"];for(var C=0;C<A.length;C++){try{return new ActiveXObject(A[C])}catch(B){}}})()}}function u(B){var C=B.responseXML;var A=B.responseText;if(n.browser==="IE"&&A&&C&&!C.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(B.getResponseHeader("Content-Type"))){C=new window.ActiveXObject("Microsoft.XMLDOM");C.async=false;C.validateOnParse=false;C.loadXML(A)}if(C){if((n.browser==="IE"&&C.parseError!==0)||!C.documentElement||C.documentElement.tagName==="parsererror"){return null}}return C}function w(C){var F="----moxieboundary"+new Date().getTime(),D="--",E="\r\n",A="",B=this.getRuntime();if(!B.can("send_binary_string")){throw new q.RuntimeError(q.RuntimeError.NOT_SUPPORTED_ERR)}z.setRequestHeader("Content-Type","multipart/form-data; boundary="+F);C.each(function(H,G){if(H instanceof l){A+=D+F+E+'Content-Disposition: form-data; name="'+G+'"; filename="'+unescape(encodeURIComponent(H.name||"blob"))+'"'+E+"Content-Type: "+(H.type||"application/octet-stream")+E+E+H.getSource()+E
}else{A+=D+F+E+'Content-Disposition: form-data; name="'+G+'"'+E+E+unescape(encodeURIComponent(H))+E}});A+=D+F+D+E;return A}}return(p.XMLHttpRequest=r)});h("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){var m=false,k;function n(p,r){var o=m?0:-8*(r-1),s=0,q;for(q=0;q<r;q++){s|=(k.charCodeAt(p+q)<<Math.abs(o+q*8))}return s}function j(q,o,p){p=arguments.length===3?p:k.length-o-1;k=k.substr(0,o)+q+k.substr(p+o)}function l(p,q,s){var t="",o=m?0:-8*(s-1),r;for(r=0;r<s;r++){t+=String.fromCharCode((q>>Math.abs(o+r*8))&255)}j(t,p,s)}return{II:function(o){if(o===g){return m}else{m=o}},init:function(o){m=false;k=o},SEGMENT:function(o,q,p){switch(arguments.length){case 1:return k.substr(o,k.length-o-1);case 2:return k.substr(o,q);case 3:j(p,o,q);break;default:return k}},BYTE:function(o){return n(o,1)},SHORT:function(o){return n(o,2)},LONG:function(o,p){if(p===g){return n(o,4)}else{l(o,p,4)}},SLONG:function(o){var p=n(o,4);return(p>2147483647?p-4294967296:p)},STRING:function(o,p){var q="";
for(p+=o;o<p;o++){q+=String.fromCharCode(n(o,1))}return q}}}});h("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],function(k){return function j(p){var q=[],o,l,m,n=0;o=new k();o.init(p);if(o.SHORT(0)!==65496){return}l=2;while(l<=p.length){m=o.SHORT(l);if(m>=65488&&m<=65495){l+=2;continue}if(m===65498||m===65497){break}n=o.SHORT(l+2)+2;if(m>=65505&&m<=65519){q.push({hex:m,name:"APP"+(m&15),start:l,length:n,segment:o.SEGMENT(l,n)})}l+=n}o.init(null);return{headers:q,restore:function(t){var r,s;o.init(t);l=o.SHORT(2)==65504?4+o.SHORT(4):2;for(s=0,r=q.length;s<r;s++){o.SEGMENT(l,0,q[s].segment);l+=q[s].length}t=o.SEGMENT();o.init(null);return t},strip:function(t){var u,r,s;r=new j(t);u=r.headers;r.purge();o.init(t);s=u.length;while(s--){o.SEGMENT(u[s].start,u[s].length,"")}t=o.SEGMENT();o.init(null);return t},get:function(s){var u=[];for(var t=0,r=q.length;t<r;t++){if(q[t].name===s.toUpperCase()){u.push(q[t].segment)}}return u},set:function(s,v){var w=[],t,u,r;
if(typeof(v)==="string"){w.push(v)}else{w=v}for(t=u=0,r=q.length;t<r;t++){if(q[t].name===s.toUpperCase()){q[t].segment=w[u];q[t].length=w[u].length;u++}if(u>=w.length){break}}},purge:function(){q=[];o.init(null);o=null}}}});h("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(l,k){return function j(){var q,n,m,o={},t;q=new k();n={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};
t={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};
function p(u,C){var w=q.SHORT(u),z,F,G,B,A,v,x,D,E=[],y={};for(z=0;z<w;z++){x=v=u+12*z+2;G=C[q.SHORT(x)];if(G===g){continue}B=q.SHORT(x+=2);A=q.LONG(x+=2);x+=4;E=[];switch(B){case 1:case 7:if(A>4){x=q.LONG(x)+o.tiffHeader}for(F=0;F<A;F++){E[F]=q.BYTE(x+F)}break;case 2:if(A>4){x=q.LONG(x)+o.tiffHeader}y[G]=q.STRING(x,A-1);continue;case 3:if(A>2){x=q.LONG(x)+o.tiffHeader}for(F=0;F<A;F++){E[F]=q.SHORT(x+F*2)}break;case 4:if(A>1){x=q.LONG(x)+o.tiffHeader}for(F=0;F<A;F++){E[F]=q.LONG(x+F*4)}break;case 5:x=q.LONG(x)+o.tiffHeader;for(F=0;F<A;F++){E[F]=q.LONG(x+F*4)/q.LONG(x+F*4+4)}break;case 9:x=q.LONG(x)+o.tiffHeader;for(F=0;F<A;F++){E[F]=q.SLONG(x+F*4)}break;case 10:x=q.LONG(x)+o.tiffHeader;for(F=0;F<A;F++){E[F]=q.SLONG(x+F*4)/q.SLONG(x+F*4+4)}break;default:continue}D=(A==1?E[0]:E);if(t.hasOwnProperty(G)&&typeof D!="object"){y[G]=t[G][D]}else{y[G]=D}}return y}function s(){var u=o.tiffHeader;q.II(q.SHORT(u)==18761);if(q.SHORT(u+=2)!==42){return false}o.IFD0=o.tiffHeader+q.LONG(u+=2);m=p(o.IFD0,n.tiff);
if("ExifIFDPointer" in m){o.exifIFD=o.tiffHeader+m.ExifIFDPointer;delete m.ExifIFDPointer}if("GPSInfoIFDPointer" in m){o.gpsIFD=o.tiffHeader+m.GPSInfoIFDPointer;delete m.GPSInfoIFDPointer}return true}function r(B,D,A){var y,w,v,u=0;if(typeof(D)==="string"){var C=n[B.toLowerCase()];for(var x in C){if(C[x]===D){D=x;break}}}y=o[B.toLowerCase()+"IFD"];w=q.SHORT(y);for(var z=0;z<w;z++){v=y+12*z+2;if(q.SHORT(v)==D){u=v+8;break}}if(!u){return false}q.LONG(u,A);return true}return{init:function(u){o={tiffHeader:10};if(u===g||!u.length){return false}q.init(u);if(q.SHORT(0)===65505&&q.STRING(4,5).toUpperCase()==="EXIF\0"){return s()}return false},TIFF:function(){return m},EXIF:function(){var v;v=p(o.exifIFD,n.exif);if(v.ExifVersion&&l.typeOf(v.ExifVersion)==="array"){for(var w=0,u="";w<v.ExifVersion.length;w++){u+=String.fromCharCode(v.ExifVersion[w])}v.ExifVersion=u}return v},GPS:function(){var u;u=p(o.gpsIFD,n.gps);if(u.GPSVersionID&&l.typeOf(u.GPSVersionID)==="array"){u.GPSVersionID=u.GPSVersionID.join(".")
}return u},setExif:function(u,v){if(u!=="PixelXDimension"&&u!=="PixelYDimension"){return false}return r("exif",u,v)},getBinary:function(){return q.SEGMENT()},purge:function(){q.init(null);q=m=null;o={}}}}});h("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(o,j,l,n,k){function m(x){var q,s,u,t,w,p;function v(){var y=0,z,A;while(y<=q.length){z=s.SHORT(y+=2);if(z>=65472&&z<=65475){y+=5;return{height:s.SHORT(y),width:s.SHORT(y+=2)}}A=s.SHORT(y+=2);y+=A-2}return null}q=x;s=new n();s.init(q);if(s.SHORT(0)!==65496){throw new j.ImageError(j.ImageError.WRONG_FORMAT)}u=new l(x);t=new k();p=!!t.init(u.get("app1")[0]);w=v.call(this);o.extend(this,{type:"image/jpeg",size:q.length,width:w&&w.width||0,height:w&&w.height||0,setExif:function(y,z){if(!p){return false}if(o.typeOf(y)==="object"){o.each(y,function(B,A){t.setExif(A,B)})}else{t.setExif(y,z)
}u.set("app1",t.getBinary())},writeHeaders:function(){if(!arguments.length){return(q=u.restore(q))}return u.restore(arguments[0])},stripHeaders:function(y){return u.strip(y)},purge:function(){r.call(this)}});if(p){this.meta={tiff:t.TIFF(),exif:t.EXIF(),gps:t.GPS()}}function r(){if(!t||!u||!s){return}t.purge();u.purge();s.init(null);q=w=u=t=s=null}}return m});h("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(j,m,l){function k(v){var o,q,s,r,u;o=v;q=new l();q.init(o);(function(){var w=0,y=0,x=[35152,20039,3338,6666];for(y=0;y<x.length;y++,w+=2){if(x[y]!=q.SHORT(w)){throw new j.ImageError(j.ImageError.WRONG_FORMAT)}}}());function t(){var x,w;x=n.call(this,8);if(x.type=="IHDR"){w=x.start;return{width:q.LONG(w),height:q.LONG(w+=4)}}return null}function p(){if(!q){return}q.init(null);o=u=s=r=q=null}u=t.call(this);m.extend(this,{type:"image/png",size:o.length,width:u.width,height:u.height,purge:function(){p.call(this)
}});p.call(this);function n(w){var z,y,A,x;z=q.LONG(w);y=q.STRING(w+=4,4);A=w+=4;x=q.LONG(w+z);return{length:z,type:y,start:A,CRC:x}}}return k});h("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(m,j,l,k){return function(o){var p=[l,k],n;n=(function(){for(var r=0;r<p.length;r++){try{return new p[r](o)}catch(q){}}throw new j.ImageError(j.ImageError.WRONG_FORMAT)}());m.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(q){return q},stripHeaders:function(q){return q},purge:function(){}});m.extend(this,n);this.purge=function(){n.purge();n=null}}});h("moxie/runtime/html5/image/MegaPixel",[],function(){function j(J,n,o){var q=J.naturalWidth,w=J.naturalHeight;var D=o.width,A=o.height;var s=o.x||0,r=o.y||0;var E=n.getContext("2d");if(k(J)){q/=2;w/=2}var H=1024;var m=document.createElement("canvas");m.width=m.height=H;var p=m.getContext("2d");var F=l(J,q,w);
var z=0;while(z<w){var I=z+H>w?w-z:H;var B=0;while(B<q){var C=B+H>q?q-B:H;p.clearRect(0,0,H,H);p.drawImage(J,-B,-z);var u=(B*D/q+s)<<0;var v=Math.ceil(C*D/q);var t=(z*A/w/F+r)<<0;var G=Math.ceil(I*A/w/F);E.drawImage(m,0,0,C,I,u,t,v,G);B+=H}z+=H}m=p=null}function k(o){var n=o.naturalWidth,q=o.naturalHeight;if(n*q>1024*1024){var p=document.createElement("canvas");p.width=p.height=1;var m=p.getContext("2d");m.drawImage(o,-n+1,0);return m.getImageData(0,0,1,1).data[3]===0}else{return false}}function l(q,n,v){var m=document.createElement("canvas");m.width=1;m.height=v;var w=m.getContext("2d");w.drawImage(q,0,0);var p=w.getImageData(0,0,1,v).data;var t=0;var r=v;var u=v;while(u>t){var o=p[(u-1)*4+3];if(o===0){r=u}else{t=u}u=(r+t)>>1}m=null;var s=(u/v);return(s===0)?1:s}return{isSubsampled:k,renderTo:j}});h("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/MegaPixel","moxie/core/utils/Mime","moxie/core/utils/Env"],function(p,j,q,l,n,s,r,k,m){function o(){var D=this,C,H,B,x,F,J=false,u=true;
j.extend(this,{loadFromBlob:function(M){var L=this,N=L.getRuntime(),K=arguments.length>1?arguments[1]:true;if(!N.can("access_binary")){throw new q.RuntimeError(q.RuntimeError.NOT_SUPPORTED_ERR)}F=M;if(M.isDetached()){x=M.getSource();A.call(this,x);return}else{G.call(this,M.getSource(),function(O){if(K){x=I(O)}A.call(L,O)})}},loadFromImage:function(K,L){this.meta=K.meta;F=new n(null,{name:K.name,size:K.size,type:K.type});A.call(this,L?(x=K.getAsBinaryString()):K.getAsDataURL())},getInfo:function(){var K=this.getRuntime(),L;if(!H&&x&&K.can("access_image_binary")){H=new s(x)}L={width:y().width||0,height:y().height||0,type:F.type||k.getFileMime(F.name),size:x&&x.length||F.size||0,name:F.name||"",meta:H&&H.meta||this.meta||{}};return L},downsize:function(){t.apply(this,arguments)},getAsCanvas:function(){if(B){B.id=this.uid+"_canvas"}return B},getAsBlob:function(K,L){if(K!==this.type){t.call(this,this.width,this.height,false)}return new n(null,{name:F.name||"",type:K,data:D.getAsBinaryString.call(this,K,L)})
},getAsDataURL:function(L){var M=arguments[1]||90;if(!J){return C.src}if("image/jpeg"!==L){return B.toDataURL("image/png")}else{try{return B.toDataURL("image/jpeg",M/100)}catch(K){return B.toDataURL("image/jpeg")}}},getAsBinaryString:function(L,N){if(!J){if(!x){x=I(D.getAsDataURL(L,N))}return x}if("image/jpeg"!==L){x=I(D.getAsDataURL(L,N))}else{var M;if(!N){N=90}try{M=B.toDataURL("image/jpeg",N/100)}catch(K){M=B.toDataURL("image/jpeg")}x=I(M);if(H){x=H.stripHeaders(x);if(u){if(H.meta&&H.meta.exif){H.setExif({PixelXDimension:this.width,PixelYDimension:this.height})}x=H.writeHeaders(x)}H.purge();H=null}}J=false;return x},destroy:function(){D=null;v.call(this);this.getRuntime().getShim().removeInstance(this.uid)}});function y(){if(!B&&!C){throw new q.ImageError(q.DOMException.INVALID_STATE_ERR)}return B||C}function I(K){return l.atob(K.substring(K.indexOf("base64,")+7))}function E(L,K){return"data:"+(K||"")+";base64,"+l.btoa(L)}function A(L){var K=this;C=new Image();C.onerror=function(){v.call(this);
K.trigger("error",new q.ImageError(q.ImageError.WRONG_FORMAT))};C.onload=function(){K.trigger("load")};C.src=/^data:[^;]*;base64,/.test(L)?L:E(L,F.type)}function G(M,N){var L=this,K;if(window.FileReader){K=new FileReader();K.onload=function(){N(this.result)};K.onerror=function(){L.trigger("error",new q.FileException(q.FileException.NOT_READABLE_ERR))};K.readAsDataURL(M)}else{return N(M.getAsDataURL())}}function t(L,W,R,T){var X=this,O,N,U=0,S=0,Q,V,M,K;u=T;K=(this.meta&&this.meta.tiff&&this.meta.tiff.Orientation)||1;if(j.inArray(K,[5,6,7,8])!==-1){var P=L;L=W;W=P}Q=y();N=!R?Math.min:Math.max;O=N(L/Q.width,W/Q.height);if(O>1&&(!R||T)){this.trigger("Resize");return}if(!B){B=document.createElement("canvas")}V=Math.round(Q.width*O);M=Math.round(Q.height*O);if(R){B.width=L;B.height=W;if(V>L){U=Math.round((V-L)/2)}if(M>W){S=Math.round((M-W)/2)}}else{B.width=V;B.height=M}if(!u){z(B.width,B.height,K)}w.call(this,Q,B,-U,-S,V,M);this.width=B.width;this.height=B.height;J=true;X.trigger("Resize")}function w(N,O,K,Q,M,P){if(m.OS==="iOS"){r.renderTo(N,O,{width:M,height:P,x:K,y:Q})
}else{var L=O.getContext("2d");L.drawImage(N,K,Q,M,P)}}function z(N,K,M){switch(M){case 5:case 6:case 7:case 8:B.width=K;B.height=N;break;default:B.width=N;B.height=K}var L=B.getContext("2d");switch(M){case 2:L.translate(N,0);L.scale(-1,1);break;case 3:L.translate(N,K);L.rotate(Math.PI);break;case 4:L.translate(0,K);L.scale(1,-1);break;case 5:L.rotate(0.5*Math.PI);L.scale(1,-1);break;case 6:L.rotate(0.5*Math.PI);L.translate(0,-K);break;case 7:L.rotate(0.5*Math.PI);L.translate(N,-K);L.scale(-1,1);break;case 8:L.rotate(-0.5*Math.PI);L.translate(-N,0);break}}function v(){if(H){H.purge();H=null}x=C=B=F=null;J=false}}return(p.Image=o)});h("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(k,n,l,q,j){var o="flash",p={};function m(){var s;try{s=navigator.plugins["Shockwave Flash"];s=s.description}catch(u){try{s=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(t){s="0.0"
}}s=s.match(/\d+/g);return parseFloat(s[0]+"."+s[1])}function r(t){var s=this,u;t=k.extend({swf_url:n.swf_url},t);j.call(this,t,o,{access_binary:function(v){return v&&s.mode==="browser"},access_image_binary:function(v){return v&&s.mode==="browser"},display_media:j.capTrue,do_cors:j.capTrue,drag_and_drop:false,report_upload_progress:function(){return s.mode==="client"},resize_image:j.capTrue,return_response_headers:false,return_response_type:function(v){if(v==="json"&&!!window.JSON){return true}return !k.arrayDiff(v,["","text","document"])||s.mode==="browser"},return_status_code:function(v){return s.mode==="browser"||!k.arrayDiff(v,[200,404])},select_file:j.capTrue,select_multiple:j.capTrue,send_binary_string:function(v){return v&&s.mode==="browser"},send_browser_cookies:function(v){return v&&s.mode==="browser"},send_custom_headers:function(v){return v&&s.mode==="browser"},send_multipart:j.capTrue,slice_blob:j.capTrue,stream_upload:function(v){return v&&s.mode==="browser"},summon_file_dialog:false,upload_filesize:function(v){return k.parseSizeStr(v)<=2097152||s.mode==="client"
},use_http_method:function(v){return !k.arrayDiff(v,["GET","POST"])}},{access_binary:function(v){return v?"browser":"client"},access_image_binary:function(v){return v?"browser":"client"},report_upload_progress:function(v){return v?"browser":"client"},return_response_type:function(v){return k.arrayDiff(v,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(v){return k.arrayDiff(v,[200,404])?"browser":["client","browser"]},send_binary_string:function(v){return v?"browser":"client"},send_browser_cookies:function(v){return v?"browser":"client"},send_custom_headers:function(v){return v?"browser":"client"},stream_upload:function(v){return v?"client":"browser"},upload_filesize:function(v){return k.parseSizeStr(v)>=2097152?"client":"browser"}},"client");if(m()<10){this.mode=false}k.extend(this,{getShim:function(){return l.get(this.uid)},shimExec:function(w,x){var v=[].slice.call(arguments,2);return s.getShim().exec(this.uid,w,x,v)},init:function(){var w,x,v;
v=this.getShimContainer();k.extend(v.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});w='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+t.swf_url+'" ';if(n.browser==="IE"){w+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}w+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+t.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+n.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(n.browser==="IE"){x=document.createElement("div");v.appendChild(x);x.outerHTML=w;x=v=null}else{v.innerHTML=w}u=setTimeout(function(){if(s&&!s.initialized){s.trigger("Error",new q.RuntimeError(q.RuntimeError.NOT_INIT_ERR))}},5000)},destroy:(function(v){return function(){v.call(s);clearTimeout(u);t=u=v=s=null}}(this.destroy))},p)}j.addConstructor(o,r);return p});h("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(k,l){var j={slice:function(o,q,m,p){var n=this.getRuntime();
if(q<0){q=Math.max(o.size+q,0)}else{if(q>0){q=Math.min(q,o.size)}}if(m<0){m=Math.max(o.size+m,0)}else{if(m>0){m=Math.min(m,o.size)}}o=n.shimExec.call(this,"Blob","slice",q,m,p||"");if(o){o=new l(n.uid,o)}return o}};return(k.Blob=j)});h("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(j){var k={init:function(l){this.getRuntime().shimExec.call(this,"FileInput","init",{name:l.name,accept:l.accept,multiple:l.multiple});this.trigger("ready")}};return(j.FileInput=k)});h("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(m,j){var k="";function l(o,p){switch(p){case"readAsText":return j.atob(o,"utf8");case"readAsBinaryString":return j.atob(o);case"readAsDataURL":return o}return null}var n={read:function(r,p){var q=this,o=q.getRuntime();if(r==="readAsDataURL"){k="data:"+(p.type||"")+";base64,"}q.bind("Progress",function(t,s){if(s){k+=l(s,r)}});return o.shimExec.call(this,"FileReader","readAsBase64",p.uid)},getResult:function(){return k
},destroy:function(){k=null}};return(m.FileReader=n)});h("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(l,j){function k(n,o){switch(o){case"readAsText":return j.atob(n,"utf8");case"readAsBinaryString":return j.atob(n);case"readAsDataURL":return n}return null}var m={read:function(q,p){var n,o=this.getRuntime();n=o.shimExec.call(this,"FileReaderSync","readAsBase64",p.uid);if(!n){return null}if(q==="readAsDataURL"){n="data:"+(p.type||"")+";base64,"+n}return k(n,q,p.type)}};return(l.FileReaderSync=m)});h("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter"],function(k,n,q,j,p,o,m){var l={send:function(y,t){var v=this,z=v.getRuntime();function s(){y.transport=z.mode;z.shimExec.call(v,"XMLHttpRequest","send",y,t)}function u(B,A){z.shimExec.call(v,"XMLHttpRequest","appendBlob",B,A.uid);
t=null;s()}function w(B,A){var C=new m();C.bind("TransportingComplete",function(){A(this.result)});C.transport(B.getSource(),B.type,{ruid:z.uid})}if(!n.isEmptyObj(y.headers)){n.each(y.headers,function(A,B){z.shimExec.call(v,"XMLHttpRequest","setRequestHeader",B,A.toString())})}if(t instanceof o){var x;t.each(function(B,A){if(B instanceof q){x=A}else{z.shimExec.call(v,"XMLHttpRequest","append",A,B)}});if(!t.hasBlob()){t=null;s()}else{var r=t.getBlob();if(r.isDetached()){w(r,function(A){r.destroy();u(x,A)})}else{u(x,r)}}}else{if(t instanceof q){if(t.isDetached()){w(t,function(A){t.destroy();t=A.uid;s()})}else{t=t.uid;s()}}else{s()}}},getResponse:function(u){var r,t,s=this.getRuntime();t=s.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob");if(t){t=new j(s.uid,t);if("blob"===u){return t}try{r=new p();if(!!~n.inArray(u,["","text"])){return r.readAsText(t)}else{if("json"===u&&!!window.JSON){return JSON.parse(r.readAsText(t))}}}finally{t.destroy()}}return null},abort:function(s){var r=this.getRuntime();
r.shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}};return(k.XMLHttpRequest=l)});h("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(j,l){var k={getAsBlob:function(o){var n=this.getRuntime(),m=n.shimExec.call(this,"Transporter","getAsBlob",o);if(m){return new l(n.uid,m)}return null}};return(j.Transporter=k)});h("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(k,m,l,o,n){var j={loadFromBlob:function(s){var r=this,q=r.getRuntime();function p(u){q.shimExec.call(r,"Image","loadFromBlob",u.uid);r=q=null}if(s.isDetached()){var t=new l();t.bind("TransportingComplete",function(){p(t.result.getSource())});t.transport(s.getSource(),s.type,{ruid:q.uid})}else{p(s.getSource())}},loadFromImage:function(q){var p=this.getRuntime();return p.shimExec.call(this,"Image","loadFromImage",q.uid)
},getAsBlob:function(r,s){var q=this.getRuntime(),p=q.shimExec.call(this,"Image","getAsBlob",r,s);if(p){return new o(q.uid,p)}return null},getAsDataURL:function(){var r=this.getRuntime(),q=r.Image.getAsBlob.apply(this,arguments),p;if(!q){return null}p=new n();return p.readAsDataURL(q)}};return(k.Image=j)});h("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(k,n,m,q,j){var o="silverlight",p={};function r(A){var D=false,w=null,s,t,u,C,v,y=0;try{try{w=new ActiveXObject("AgControl.AgControl");if(w.IsVersionSupported(A)){D=true}w=null}catch(z){var x=navigator.plugins["Silverlight Plug-In"];if(x){s=x.description;if(s==="1.0.30226.2"){s="2.0.30226.2"}t=s.split(".");while(t.length>3){t.pop()}while(t.length<4){t.push(0)}u=A.split(".");while(u.length>4){u.pop()}do{C=parseInt(u[y],10);v=parseInt(t[y],10);y++}while(y<u.length&&C===v);if(C<=v&&!isNaN(C)){D=true}}}}catch(B){D=false}return D
}function l(t){var s=this,u;t=k.extend({xap_url:n.xap_url},t);j.call(this,t,o,{access_binary:j.capTrue,access_image_binary:j.capTrue,display_media:j.capTrue,do_cors:j.capTrue,drag_and_drop:false,report_upload_progress:j.capTrue,resize_image:j.capTrue,return_response_headers:function(v){return v&&s.mode==="client"},return_response_type:function(v){if(v!=="json"){return true}else{return !!window.JSON}},return_status_code:function(v){return s.mode==="client"||!k.arrayDiff(v,[200,404])},select_file:j.capTrue,select_multiple:j.capTrue,send_binary_string:j.capTrue,send_browser_cookies:function(v){return v&&s.mode==="browser"},send_custom_headers:function(v){return v&&s.mode==="client"},send_multipart:j.capTrue,slice_blob:j.capTrue,stream_upload:true,summon_file_dialog:false,upload_filesize:j.capTrue,use_http_method:function(v){return s.mode==="client"||!k.arrayDiff(v,["GET","POST"])}},{return_response_headers:function(v){return v?"client":"browser"},return_status_code:function(v){return k.arrayDiff(v,[200,404])?"client":["client","browser"]
},send_browser_cookies:function(v){return v?"browser":"client"},send_custom_headers:function(v){return v?"client":"browser"},use_http_method:function(v){return k.arrayDiff(v,["GET","POST"])?"client":["client","browser"]}});if(!r("2.0.31005.0")||n.browser==="Opera"){this.mode=false}k.extend(this,{getShim:function(){return m.get(this.uid).content.Moxie},shimExec:function(w,x){var v=[].slice.call(arguments,2);return s.getShim().exec(this.uid,w,x,v)},init:function(){var v;v=this.getShimContainer();v.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+t.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+n.global_event_dispatcher+'"/></object>';u=setTimeout(function(){if(s&&!s.initialized){s.trigger("Error",new q.RuntimeError(q.RuntimeError.NOT_INIT_ERR))
}},n.OS!=="Windows"?10000:5000)},destroy:(function(v){return function(){v.call(s);clearTimeout(u);t=u=v=s=null}}(this.destroy))},p)}j.addConstructor(o,l);return p});h("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(j,k,l){return(j.Blob=k.extend({},l))});h("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(j){var k={init:function(m){function l(o){var p="";for(var n=0;n<o.length;n++){p+=(p!==""?"|":"")+o[n].title+" | *."+o[n].extensions.replace(/,/g,";*.")}return p}this.getRuntime().shimExec.call(this,"FileInput","init",l(m.accept),m.name,m.multiple);this.trigger("ready")}};return(j.FileInput=k)});h("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(l,k,j){var m={init:function(){var o=this,n=o.getRuntime(),p;p=n.getShimContainer();j.addEvent(p,"dragover",function(q){q.preventDefault();
q.stopPropagation();q.dataTransfer.dropEffect="copy"},o.uid);j.addEvent(p,"dragenter",function(r){r.preventDefault();var q=k.get(n.uid).dragEnter(r);if(q){r.stopPropagation()}},o.uid);j.addEvent(p,"drop",function(r){r.preventDefault();var q=k.get(n.uid).dragDrop(r);if(q){r.stopPropagation()}},o.uid);return n.shimExec.call(this,"FileDrop","init")}};return(l.FileDrop=m)});h("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(j,l,k){return(j.FileReader=l.extend({},k))});h("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(j,k,l){return(j.FileReaderSync=k.extend({},l))});h("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(j,l,k){return(j.XMLHttpRequest=l.extend({},k))});h("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(j,l,k){return(j.Transporter=l.extend({},k))
});h("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(k,l,j){return(k.Image=l.extend({},j,{getInfo:function(){var n=this.getRuntime(),o=["tiff","exif","gps"],p={meta:{}},m=n.shimExec.call(this,"Image","getInfo");if(m.meta){l.each(o,function(r){var v=m.meta[r],q,s,t,u;if(v&&v.keys){p.meta[r]={};for(s=0,t=v.keys.length;s<t;s++){q=v.keys[s];u=v[q];if(u){if(/^(\d|[1-9]\d+)$/.test(u)){u=parseInt(u,10)}else{if(/^\d*\.\d+$/.test(u)){u=parseFloat(u)}}p.meta[r][q]=u}}}})}p.width=parseInt(m.width,10);p.height=parseInt(m.height,10);p.size=parseInt(m.size,10);p.type=m.type;p.name=m.name;return p}}))});h("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(p,j,m,l){var o="html4",n={};function k(r){var q=this,t=m.capTest,s=m.capTrue;m.call(this,r,o,{access_binary:t(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:false,display_media:t(n.Image&&(l.can("create_canvas")||l.can("use_data_uri_over32kb"))),do_cors:false,drag_and_drop:false,filter_by_extension:t(function(){return(l.browser==="Chrome"&&l.version>=28)||(l.browser==="IE"&&l.version>=10)
}()),resize_image:function(){return n.Image&&q.can("access_binary")&&l.can("create_canvas")},report_upload_progress:false,return_response_headers:false,return_response_type:function(u){if(u==="json"&&!!window.JSON){return true}return !!~p.inArray(u,["text","document",""])},return_status_code:function(u){return !p.arrayDiff(u,[200,404])},select_file:function(){return l.can("use_fileinput")},select_multiple:false,send_binary_string:false,send_custom_headers:false,send_multipart:true,slice_blob:false,stream_upload:function(){return q.can("select_file")},summon_file_dialog:t(function(){return(l.browser==="Firefox"&&l.version>=4)||(l.browser==="Opera"&&l.version>=12)||!!~p.inArray(l.browser,["Chrome","Safari"])}()),upload_filesize:s,use_http_method:function(u){return !p.arrayDiff(u,["GET","POST"])}});p.extend(this,{init:function(){this.trigger("Init")},destroy:(function(u){return function(){u.call(q);u=q=null}}(this.destroy))});p.extend(this.getShim(),n)}m.addConstructor(o,k);return n});h("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(n,p,m,k,l,j){function o(){var t,r=[],u=[],q;
function s(){var x=this,A=x.getRuntime(),z,y,v,C,w,B;B=p.guid("uid_");z=A.getShimContainer();if(t){v=m.get(t+"_form");if(v){p.extend(v.style,{top:"100%"})}}C=document.createElement("form");C.setAttribute("id",B+"_form");C.setAttribute("method","post");C.setAttribute("enctype","multipart/form-data");C.setAttribute("encoding","multipart/form-data");p.extend(C.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});w=document.createElement("input");w.setAttribute("id",B);w.setAttribute("type","file");w.setAttribute("name",q.name||"Filedata");w.setAttribute("accept",u.join(","));p.extend(w.style,{fontSize:"999px",opacity:0});C.appendChild(w);z.appendChild(C);p.extend(w.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});if(j.browser==="IE"&&j.version<10){p.extend(w.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"})}w.onchange=function(){var E;if(!this.value){return}if(this.files){E=this.files[0]}else{E={name:this.value}}r=[E];
this.onchange=function(){};s.call(x);x.bind("change",function D(){var F=m.get(B),H=m.get(B+"_form"),G;x.unbind("change",D);if(x.files.length&&F&&H){G=x.files[0];F.setAttribute("id",G.uid);H.setAttribute("id",G.uid+"_form");H.setAttribute("target",G.uid+"_iframe")}F=H=null},998);w=C=null;x.trigger("change")};if(A.can("summon_file_dialog")){y=m.get(q.browse_button);k.removeEvent(y,"click",x.uid);k.addEvent(y,"click",function(D){if(w&&!w.disabled){w.click()}D.preventDefault()},x.uid)}t=B;z=v=y=null}p.extend(this,{init:function(y){var v=this,x=v.getRuntime(),w;q=y;u=y.accept.mimes||l.extList2mimes(y.accept,x.can("filter_by_extension"));w=x.getShimContainer();(function(){var z,B,A;z=m.get(y.browse_button);if(x.can("summon_file_dialog")){if(m.getStyle(z,"position")==="static"){z.style.position="relative"}B=parseInt(m.getStyle(z,"z-index"),10)||1;z.style.zIndex=B;w.style.zIndex=B-1}A=x.can("summon_file_dialog")?z:w;k.addEvent(A,"mouseover",function(){v.trigger("mouseenter")},v.uid);k.addEvent(A,"mouseout",function(){v.trigger("mouseleave")
},v.uid);k.addEvent(A,"mousedown",function(){v.trigger("mousedown")},v.uid);k.addEvent(m.get(y.container),"mouseup",function(){v.trigger("mouseup")},v.uid);z=null}());s.call(this);w=null;v.trigger({type:"ready",async:true})},getFiles:function(){return r},disable:function(w){var v;if((v=m.get(t))){v.disabled=!!w}},destroy:function(){var w=this.getRuntime(),x=w.getShim(),v=w.getShimContainer();k.removeAllEvents(v,this.uid);k.removeAllEvents(q&&m.get(q.container),this.uid);k.removeAllEvents(q&&m.get(q.browse_button),this.uid);if(v){v.innerHTML=""}x.removeInstance(this.uid);t=r=u=q=v=x=null}})}return(n.FileInput=o)});h("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(j,k){return(j.FileReader=k)});h("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(n,k,m,j,o,q,l,r){function p(){var u,s,v;
function t(w){var B=this,z,A,x,y,C=false;if(!v){return}z=v.id.replace(/_iframe$/,"");A=m.get(z+"_form");if(A){x=A.getElementsByTagName("input");y=x.length;while(y--){switch(x[y].getAttribute("type")){case"hidden":x[y].parentNode.removeChild(x[y]);break;case"file":C=true;break}}x=[];if(!C){A.parentNode.removeChild(A)}A=null}setTimeout(function(){q.removeEvent(v,"load",B.uid);if(v.parentNode){v.parentNode.removeChild(v)}var D=B.getRuntime().getShimContainer();if(!D.children.length){D.parentNode.removeChild(D)}D=v=null;w()},1)}k.extend(this,{send:function(E,y){var A=this,D=A.getRuntime(),z,x,C,w;u=s=null;function B(){var F=D.getShimContainer()||document.body,G=document.createElement("div");G.innerHTML='<iframe id="'+z+'_iframe" name="'+z+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';v=G.firstChild;F.appendChild(v);q.addEvent(v,"load",function(){var I;try{I=v.contentWindow.document||v.contentDocument||window.frames[v.id].document;if(/^4(0[0-9]|1[0-7]|2[2346])\s/.test(I.title)){u=I.title.replace(/^(\d+).*$/,"$1")
}else{u=200;s=k.trim(I.body.innerHTML);A.trigger({type:"progress",loaded:s.length,total:s.length});if(w){A.trigger({type:"uploadprogress",loaded:w.size||1025,total:w.size||1025})}}}catch(H){if(j.hasSameOrigin(E.url)){u=404}else{t.call(A,function(){A.trigger("error")});return}}t.call(A,function(){A.trigger("load")})},A.uid)}if(y instanceof r&&y.hasBlob()){w=y.getBlob();z=w.uid;C=m.get(z);x=m.get(z+"_form");if(!x){throw new o.DOMException(o.DOMException.NOT_FOUND_ERR)}}else{z=k.guid("uid_");x=document.createElement("form");x.setAttribute("id",z+"_form");x.setAttribute("method",E.method);x.setAttribute("enctype","multipart/form-data");x.setAttribute("encoding","multipart/form-data");x.setAttribute("target",z+"_iframe");D.getShimContainer().appendChild(x)}if(y instanceof r){y.each(function(H,F){if(H instanceof l){if(C){C.setAttribute("name",F)}}else{var G=document.createElement("input");k.extend(G,{type:"hidden",name:F,value:H});if(C){x.insertBefore(G,C)}else{x.appendChild(G)}}})}x.setAttribute("action",E.url);
B();x.submit();A.trigger("loadstart")},getStatus:function(){return u},getResponse:function(w){if("json"===w){if(k.typeOf(s)==="string"&&!!window.JSON){try{return JSON.parse(s.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(x){return null}}}else{if("document"===w){}}return s},abort:function(){var w=this;if(v&&v.contentWindow){if(v.contentWindow.stop){v.contentWindow.stop()}else{if(v.contentWindow.document.execCommand){v.contentWindow.document.execCommand("Stop")}else{v.src="about:blank"}}}t.call(this,function(){w.dispatchEvent("abort")})}})}return(n.XMLHttpRequest=p)});h("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(k,j){return(k.Image=j)});a(["moxie/core/utils/Basic","moxie/core/I18n","moxie/core/utils/Mime","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/file/File","moxie/file/FileInput","moxie/file/FileDrop","moxie/runtime/RuntimeTarget","moxie/file/FileReader","moxie/core/utils/Url","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/runtime/Transporter","moxie/image/Image","moxie/core/utils/Events"])
})(this);(function(){var c={},b=moxie.core.utils.Basic.inArray;(function a(e){var d,f;for(d in e){f=typeof(e[d]);if(f==="object"&&!~b(d,["Exceptions","Env","Mime"])){a(e[d])}else{if(f==="function"){c[d]=e[d]}}}})(window.moxie);c.Env=window.moxie.core.utils.Env;c.Mime=window.moxie.core.utils.Mime;c.Exceptions=window.moxie.core.Exceptions;window.mOxie=c;if(!window.o){window.o=c}return c})();(function(f,h,e){var d=f.setTimeout,g={};function a(k){var j=k.required_features,l={};function m(o,p,n){var q={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};if(q[o]){l[q[o]]=p}else{if(!n){l[o]=p}}}if(typeof(j)==="string"){c.each(j.split(/\s*,\s*/),function(n){m(n,true)})}else{if(typeof(j)==="object"){c.each(j,function(o,n){m(n,o)})}else{if(j===true){if(!k.multipart){l.send_binary_string=true
}if(k.chunk_size>0){l.slice_blob=true}if(k.resize.enabled){l.send_binary_string=true}c.each(k,function(o,n){m(n,!!o,true)})}}}return l}var c={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:h.mimes,ua:h.ua,typeOf:h.typeOf,extend:h.extend,guid:h.guid,get:function b(m){var k=[],l;if(h.typeOf(m)!=="array"){m=[m]}var j=m.length;while(j--){l=h.get(m[j]);if(l){k.push(l)}}return k.length?k:null},each:h.each,getPos:h.getPos,getSize:h.getSize,xmlEncode:function(k){var l={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},j=/[<>&\"\']/g;return k?(""+k).replace(j,function(m){return l[m]?"&"+l[m]+";":m}):k},toArray:h.toArray,inArray:h.inArray,addI18n:h.addI18n,translate:h.translate,isEmptyObj:h.isEmptyObj,hasClass:h.hasClass,addClass:h.addClass,removeClass:h.removeClass,getStyle:h.getStyle,addEvent:h.addEvent,removeEvent:h.removeEvent,removeAllEvents:h.removeAllEvents,cleanName:function(j){var k,l;
l=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(k=0;k<l.length;k+=2){j=j.replace(l[k],l[k+1])}j=j.replace(/\s+/g,"_");j=j.replace(/[^a-z0-9_\-\.]+/gi,"");return j},buildUrl:function(k,j){var l="";c.each(j,function(n,m){l+=(l?"&":"")+encodeURIComponent(m)+"="+encodeURIComponent(n)});if(l){k+=(k.indexOf("?")>0?"&":"?")+l}return k},formatSize:function(k){if(k===e||/\D/.test(k)){return c.translate("N/A")}function j(n,m){return Math.round(n*Math.pow(10,m))/Math.pow(10,m)}var l=Math.pow(1024,4);if(k>l){return j(k/l,1)+" "+c.translate("tb")}if(k>(l/=1024)){return j(k/l,1)+" "+c.translate("gb")}if(k>(l/=1024)){return j(k/l,1)+" "+c.translate("mb")}if(k>1024){return Math.round(k/1024)+" "+c.translate("kb")}return k+" "+c.translate("b")},parseSize:h.parseSizeStr,predictRuntime:function(l,k){var j,m;j=new c.Uploader(l);
m=h.Runtime.thatCan(j.getOption().required_features,k||l.runtimes);j.destroy();return m},addFileFilter:function(k,j){g[k]=j}};c.addFileFilter("mime_types",function(l,k,j){if(l.length&&!l.regexp.test(k.name)){this.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),file:k});j(false)}else{j(true)}});c.addFileFilter("max_file_size",function(m,k,j){var l;m=c.parseSize(m);if(k.size!==l&&m&&k.size>m){this.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:k});j(false)}else{j(true)}});c.addFileFilter("prevent_duplicates",function(m,k,j){if(m){var l=this.files.length;while(l--){if(k.name===this.files[l].name&&k.size===this.files[l].size){this.trigger("Error",{code:c.FILE_DUPLICATE_ERROR,message:c.translate("Duplicate file error."),file:k});j(false);return}}}j(true)});c.Uploader=function(m){var u=c.guid(),H,q=[],y={},G=[],x=[],D,L,o=false,w;function K(){var N,O=0,M;if(this.state==c.STARTED){for(M=0;M<q.length;M++){if(!N&&q[M].status==c.QUEUED){N=q[M];
if(this.trigger("BeforeUpload",N)){N.status=c.UPLOADING;this.trigger("UploadFile",N)}}else{O++}}if(O==q.length){if(this.state!==c.STOPPED){this.state=c.STOPPED;this.trigger("StateChanged")}this.trigger("UploadComplete",q)}}}function l(M){M.percent=M.size>0?Math.ceil(M.loaded/M.size*100):100;k()}function k(){var N,M;L.reset();for(N=0;N<q.length;N++){M=q[N];if(M.size!==e){L.size+=M.origSize;L.loaded+=M.loaded*M.origSize/M.size}else{L.size=e}if(M.status==c.DONE){L.uploaded++}else{if(M.status==c.FAILED){L.failed++}else{L.queued++}}}if(L.size===e){L.percent=q.length>0?Math.ceil(L.uploaded/q.length*100):0}else{L.bytesPerSec=Math.ceil(L.loaded/((+new Date()-D||1)/1000));L.percent=L.size>0?Math.ceil(L.loaded/L.size*100):0}}function J(){var M=G[0]||x[0];if(M){return M.getRuntime().uid}return false}function F(N,M){if(N.ruid){var O=h.Runtime.getInfo(N.ruid);if(O){return O.can(M)}}return false}function z(){this.bind("FilesAdded",I);this.bind("CancelUpload",j);this.bind("BeforeUpload",C);this.bind("UploadFile",E);
this.bind("UploadProgress",v);this.bind("StateChanged",B);this.bind("QueueChanged",k);this.bind("Error",s);this.bind("FileUploaded",t);this.bind("Destroy",r)}function A(R,O){var P=this,N=0,M=[];var Q={accept:R.filters.mime_types,runtime_order:R.runtimes,required_caps:R.required_features,preferred_caps:y,swf_url:R.flash_swf_url,xap_url:R.silverlight_xap_url};c.each(R.runtimes.split(/\s*,\s*/),function(S){if(R[S]){Q[S]=R[S]}});if(R.browse_button){c.each(R.browse_button,function(S){M.push(function(T){var U=new h.FileInput(c.extend({},Q,{name:R.file_data_name,multiple:R.multi_selection,container:R.container,browse_button:S}));U.onready=function(){var V=h.Runtime.getInfo(this.ruid);h.extend(P.features,{chunks:V.can("slice_blob"),multipart:V.can("send_multipart"),multi_selection:V.can("select_multiple")});N++;G.push(this);T()};U.onchange=function(){P.addFile(this.files)};U.bind("mouseenter mouseleave mousedown mouseup",function(V){if(!o){if(R.browse_button_hover){if("mouseenter"===V.type){h.addClass(S,R.browse_button_hover)
}else{if("mouseleave"===V.type){h.removeClass(S,R.browse_button_hover)}}}if(R.browse_button_active){if("mousedown"===V.type){h.addClass(S,R.browse_button_active)}else{if("mouseup"===V.type){h.removeClass(S,R.browse_button_active)}}}}});U.bind("error runtimeerror",function(){U=null;T()});U.init()})})}if(R.drop_element){c.each(R.drop_element,function(S){M.push(function(T){var U=new h.FileDrop(c.extend({},Q,{drop_zone:S}));U.onready=function(){var V=h.Runtime.getInfo(this.ruid);P.features.dragdrop=V.can("drag_and_drop");N++;x.push(this);T()};U.ondrop=function(){P.addFile(this.files)};U.bind("error runtimeerror",function(){U=null;T()});U.init()})})}h.inSeries(M,function(){if(typeof(O)==="function"){O(N)}})}function p(O,Q,M){var N=new h.Image();try{N.onload=function(){N.downsize(Q.width,Q.height,Q.crop,Q.preserve_headers)};N.onresize=function(){M(this.getAsBlob(O.type,Q.quality));this.destroy()};N.onerror=function(){M(O)};N.load(O)}catch(P){M(O)}}function n(O,Q,R){var N=this,M=false;function P(T,U,V){var S=H[T];
switch(T){case"max_file_size":if(T==="max_file_size"){H.max_file_size=H.filters.max_file_size=U}break;case"chunk_size":if(U=c.parseSize(U)){H[T]=U}break;case"filters":if(c.typeOf(U)==="array"){U={mime_types:U}}if(V){c.extend(H.filters,U)}else{H.filters=U}if(U.mime_types){H.filters.mime_types.regexp=(function(W){var X=[];c.each(W,function(Y){c.each(Y.extensions.split(/,/),function(Z){if(/^\s*\*\s*$/.test(Z)){X.push("\\.*")}else{X.push("\\."+Z.replace(new RegExp("["+("/^$.*+?|()[]{}\\".replace(/./g,"\\$&"))+"]","g"),"\\$&"))}})});return new RegExp("("+X.join("|")+")$","i")}(H.filters.mime_types))}break;case"resize":if(V){c.extend(H.resize,U,{enabled:true})}else{H.resize=U}break;case"prevent_duplicates":H.prevent_duplicates=H.filters.prevent_duplicates=!!U;break;case"browse_button":case"drop_element":U=c.get(U);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":H[T]=U;if(!V){M=true}break;default:H[T]=U}if(!V){N.trigger("OptionChanged",T,U,S)}}if(typeof(O)==="object"){c.each(O,function(T,S){P(S,T,R)
})}else{P(O,Q,R)}if(R){H.required_features=a(c.extend({},H));y=a(c.extend({},H,{required_features:true}))}else{if(M){N.trigger("Destroy");A.call(N,H,function(S){if(S){N.runtime=h.Runtime.getInfo(J()).type;N.trigger("Init",{runtime:N.runtime});N.trigger("PostInit")}else{N.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}})}}}function I(N,M){[].push.apply(q,M);N.trigger("QueueChanged");N.refresh()}function C(M,N){if(H.unique_names){var P=N.name.match(/\.([^.]+)$/),O="part";if(P){O=P[1]}N.target_name=N.id+"."+O}}function E(U,R){var O=U.settings.url,S=U.settings.chunk_size,V=U.settings.max_retries,P=U.features,T=0,M;if(R.loaded){T=R.loaded=S*Math.floor(R.loaded/S)}function Q(){if(V-->0){d(N,1000)}else{R.loaded=T;U.trigger("Error",{code:c.HTTP_ERROR,message:c.translate("HTTP Error."),file:R,response:w.responseText,status:w.status,responseHeaders:w.getAllResponseHeaders()})}}function N(){var Y,X,W,Z;if(R.status==c.DONE||R.status==c.FAILED||U.state==c.STOPPED){return}W={name:R.target_name||R.name};
if(S&&P.chunks&&M.size>S){Z=Math.min(S,M.size-T);Y=M.slice(T,T+Z)}else{Z=M.size;Y=M}if(S&&P.chunks){if(U.settings.send_chunk_number){W.chunk=Math.ceil(T/S);W.chunks=Math.ceil(M.size/S)}else{W.offset=T;W.total=M.size}}w=new h.XMLHttpRequest();if(w.upload){w.upload.onprogress=function(aa){R.loaded=Math.min(R.size,T+aa.loaded);U.trigger("UploadProgress",R)}}w.onload=function(){if(w.status>=400){Q();return}V=U.settings.max_retries;if(Z<M.size){Y.destroy();T+=Z;R.loaded=Math.min(T,M.size);U.trigger("ChunkUploaded",R,{offset:R.loaded,total:M.size,response:w.responseText,status:w.status,responseHeaders:w.getAllResponseHeaders()});if(h.Env.browser==="Android Browser"){U.trigger("UploadProgress",R)}}else{R.loaded=R.size}Y=X=null;if(!T||T>=M.size){if(R.size!=R.origSize){M.destroy();M=null}U.trigger("UploadProgress",R);R.status=c.DONE;U.trigger("FileUploaded",R,{response:w.responseText,status:w.status,responseHeaders:w.getAllResponseHeaders()})}else{d(N,1)}};w.onerror=function(){Q()};w.onloadend=function(){this.destroy();
w=null};if(U.settings.multipart&&P.multipart){W.name=R.target_name||R.name;w.open("post",O,true);c.each(U.settings.headers,function(ab,aa){w.setRequestHeader(aa,ab)});X=new h.FormData();c.each(c.extend(W,U.settings.multipart_params),function(ab,aa){X.append(aa,ab)});X.append(U.settings.file_data_name,Y);w.send(X,{runtime_order:U.settings.runtimes,required_caps:U.settings.required_features,preferred_caps:y,swf_url:U.settings.flash_swf_url,xap_url:U.settings.silverlight_xap_url})}else{O=c.buildUrl(U.settings.url,c.extend(W,U.settings.multipart_params));w.open("post",O,true);w.setRequestHeader("Content-Type","application/octet-stream");c.each(U.settings.headers,function(ab,aa){w.setRequestHeader(aa,ab)});w.send(Y,{runtime_order:U.settings.runtimes,required_caps:U.settings.required_features,preferred_caps:y,swf_url:U.settings.flash_swf_url,xap_url:U.settings.silverlight_xap_url})}}M=R.getSource();if(U.settings.resize.enabled&&F(M,"send_binary_string")&&!!~h.inArray(M.type,["image/jpeg","image/png"])){p.call(this,M,U.settings.resize,function(W){M=W;
R.size=W.size;N()})}else{N()}}function v(M,N){l(N)}function B(M){if(M.state==c.STARTED){D=(+new Date())}else{if(M.state==c.STOPPED){for(var N=M.files.length-1;N>=0;N--){if(M.files[N].status==c.UPLOADING){M.files[N].status=c.QUEUED;k()}}}}}function j(){if(w){w.abort()}}function t(M){k();d(function(){K.call(M)},1)}function s(M,N){if(N.file){N.file.status=c.FAILED;l(N.file);if(M.state==c.STARTED){M.trigger("CancelUpload");d(function(){K.call(M)},1)}}}function r(M){M.stop();c.each(q,function(N){N.destroy()});q=[];if(G.length){c.each(G,function(N){N.destroy()});G=[]}if(x.length){c.each(x,function(N){N.destroy()});x=[]}y={};o=false;D=w=null;L.reset()}H={runtimes:h.Runtime.order,max_retries:0,chunk_size:0,multipart:true,multi_selection:true,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:false,max_file_size:0},resize:{enabled:false,preserve_headers:true,crop:false},send_chunk_number:true};n.call(this,m,null,true);L=new c.QueueProgress();
c.extend(this,{id:u,uid:u,state:c.STOPPED,features:{},runtime:null,files:q,settings:H,total:L,init:function(){var M=this;if(typeof(H.preinit)=="function"){H.preinit(M)}else{c.each(H.preinit,function(O,N){M.bind(N,O)})}if(!H.browse_button||!H.url){this.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")});return}z.call(this);A.call(this,H,function(N){if(typeof(H.init)=="function"){H.init(M)}else{c.each(H.init,function(P,O){M.bind(O,P)})}if(N){M.runtime=h.Runtime.getInfo(J()).type;M.trigger("Init",{runtime:M.runtime});M.trigger("PostInit")}else{M.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}})},setOption:function(M,N){n.call(this,M,N,!this.runtime)},getOption:function(M){if(!M){return H}return H[M]},refresh:function(){if(G.length){c.each(G,function(M){M.trigger("Refresh")})}this.trigger("Refresh")},start:function(M){M=typeof M!=="undefined"?M:true;if(this.state!=c.STARTED){this.state=c.STARTED;this.trigger("StateChanged");if(M){K.call(this)}}},stop:function(){if(this.state!=c.STOPPED){this.state=c.STOPPED;
this.trigger("StateChanged");this.trigger("CancelUpload")}},disableBrowse:function(){o=arguments[0]!==e?arguments[0]:true;if(G.length){c.each(G,function(M){M.disable(o)})}this.trigger("DisableBrowse",o)},getFile:function(N){var M;for(M=q.length-1;M>=0;M--){if(q[M].id===N){return q[M]}}},addFile:function(Q,T){var N=this,M=[],S=[],O;function R(W,V){var U=[];h.each(N.settings.filters,function(Y,X){if(g[X]){U.push(function(Z){g[X].call(N,Y,W,function(aa){Z(!aa)})})}});h.inSeries(U,V)}function P(U){var V=h.typeOf(U);if(U instanceof h.File){if(!U.ruid&&!U.isDetached()){if(!O){return false}U.ruid=O;U.connectRuntime(O)}P(new c.File(U))}else{if(U instanceof h.Blob){P(U.getSource());U.destroy()}else{if(U instanceof c.File){if(T){U.name=T}M.push(function(W){R(U,function(X){if(!X){S.push(U);N.trigger("FileFiltered",U)}d(W,1)})})}else{if(h.inArray(V,["file","blob"])!==-1){P(new h.File(null,U))}else{if(V==="node"&&h.typeOf(U.files)==="filelist"){h.each(U.files,P)}else{if(V==="array"){T=null;h.each(U,P)
}}}}}}}O=J();P(Q);if(M.length){h.inSeries(M,function(){if(S.length){N.trigger("FilesAdded",S)}})}},removeFile:function(O,M){M=typeof M!=="undefined"?M:true;var P=typeof(O)==="string"?O:O.id;for(var N=q.length-1;N>=0;N--){if(q[N].id===P){return this.splice(N,1,M)[0]}}},splice:function(Q,N,M){M=typeof M!=="undefined"?M:true;var O=q.splice(Q===e?0:Q,N===e?q.length:N);var P=false;if(this.state==c.STARTED){P=true;this.stop()}this.trigger("FilesRemoved",O);c.each(O,function(R){R.destroy()});this.trigger("QueueChanged");this.refresh();if(P){this.start(M)}return O},bind:function(N,P,O){var M=this;c.Uploader.prototype.bind.call(this,N,function(){var Q=[].slice.call(arguments);Q.splice(0,1,M);return P.apply(this,Q)},0,O)},destroy:function(){this.trigger("Destroy");H=L=null;this.unbindAll()}})};c.Uploader.prototype=h.EventTarget.instance;c.File=(function(){var k={};function j(l){c.extend(this,{id:c.guid(),name:l.name||l.fileName,type:l.type||"",size:l.size||l.fileSize,origSize:l.size||l.fileSize,loaded:0,percent:0,status:c.QUEUED,lastModifiedDate:l.lastModifiedDate||(new Date()).toLocaleString(),getNative:function(){var m=this.getSource().getSource();
return h.inArray(h.typeOf(m),["blob","file"])!==-1?m:null},getSource:function(){if(!k[this.id]){return null}return k[this.id]},destroy:function(){var m=this.getSource();if(m){m.destroy();delete k[this.id]}}});k[this.id]=l}return j}());c.QueueProgress=function(){var j=this;j.size=0;j.loaded=0;j.uploaded=0;j.failed=0;j.queued=0;j.percent=0;j.bytesPerSec=0;j.reset=function(){j.size=j.loaded=j.uploaded=j.failed=j.queued=j.percent=j.bytesPerSec=0}};f.plupload=c}(window,mOxie));function sLinkManager(){this.full={};this.empty=[];for(var b=0;$("#edit-link-"+b).length>0;b++){var a=$("#edit-link-"+b);this.empty[b]={index:b,hiddenEl:a,displayEl:""}}this.addLink=function(d){var e=$.toJSON(d);var f=this.empty.shift();if(f){f.hiddenEl.val(e);var c=f.index;full[c]=f;return c}else{return"full"}};this.removeLink=function(c){var d=full[c];delete full[c];d.hiddenEl.val("");d.displayEl.remove();d.displayEl="";this.empty.push(d);sPopupsResizeCenter()};this.getDisplay=function(h,d){var e=full[h];var p=$.parseJSON(e.hiddenEl.val());
var l=p.link;var o=p.title;var c="link-display-"+h;var f=false;var m="";if(sCommonIsEmbed(l)){f=true;l="Embedded Media";if(o!=""){l=o+": "+l}m='<span class="embed-preview-button" id="preview-button-'+h+'">Preview</span>';var g='<span class="embed-icon inline-icon"></span>';var n=""}else{if(o!=""){o=o+": "}var g='<span class="inline-icon link-icon"><span class="icon-placeholder"></span></span>';l='<span class="link-title">'+o+"</span><span>"+l+"</span>";m='<span class="link-add-details-button" id="preview-button-'+h+'">'+Drupal.t("Get Preview")+"</span>";var n='<div class="link-preview-area" id="preview-area-'+h+'"></div>'}var j=$('<div class="link-attachment" id="'+c+'"><span class="delete-link"></span>'+m+'<span class="link-value">'+g+l+"</span>"+n+"</div>");$(".delete-link",j).data("linkManagerIndex",h);if(d!=null){var k=$(".icon-placeholder",j);k.css("background",'url("'+d+'") no-repeat');k.removeClass("icon-placeholder");k.addClass("with-fav")}if(f){sAttachEmbedPreview(j)}else{sAttachAddDetailsBehavior(j)
}e.displayEl=j;return j};this.updateDisplay=function(c,f){var j=full[c];var h=$.parseJSON(j.hiddenEl.val());var e=h.link;var k=h.title;if(k!=""){k=k+": "}var g=j.displayEl;if(j.displayEl){if(f!=null){if($(".icon-placeholder",g).length>0){var d=$(".icon-placeholder",g);d.css("background",'url("'+f+'") no-repeat');d.removeClass("icon-placeholder");d.addClass("with-fav")}}if($(".link-title",g).html()==""){$(".link-title",g).html(k)}}};this.updateLink=function(f,g){var j=f.link;var d=f.sFavPath;var l=f.title;var c=f.favUrl;var h=f.faviconId;var e=full[g];if(e){var k=$.parseJSON(e.hiddenEl.val());k.link=j;k.sFavPath=d;k.favUrl=c;k.faviconId=h;if(k.title==""){k.title=l}e.hiddenEl.val($.toJSON(k));var g=e.index;full[g]=e;return g}else{return false}};this.reset=function(){full={};this.empty=[];for(var d=0;$("#edit-link-"+d).length>0;d++){$("#edit-link-"+d).val("");var c=$("#edit-link-"+d);this.empty[d]={index:d,hiddenEl:c,displayEl:""}}};this.getCurrentInfo=function(c){var e=full[c];if(e){var d=$.parseJSON(e.hiddenEl.val());
return d}else{return false}};this.updateThumbnail=function(d,c){var f=full[d];if(f){var e=$.parseJSON(f.hiddenEl.val());e.thumb=c;f.hiddenEl.val($.toJSON(e))}else{return false}};this.updateDescription=function(c,d){var f=full[c];if(f){var e=$.parseJSON(f.hiddenEl.val());e.description=d;f.hiddenEl.val($.toJSON(e))}else{return false}};this.updateTitle=function(c,f){var e=full[c];if(e){var d=$.parseJSON(e.hiddenEl.val());d.title=f;e.hiddenEl.val($.toJSON(d))}else{return false}};this.setPostprocessAndType=function(c,g,d){var f=full[c];if(f){var e=$.parseJSON(f.hiddenEl.val());e.postprocess=g;e.type=d;f.hiddenEl.val($.toJSON(e))}else{return false}}}function sAttachAddDetailsBehavior(b,c){var a=$(".link-add-details-button:not(.sDetailsButton-processed)",b);a.addClass(".sDetailsButton-processed");a.click(function(){var f=$(this).attr("id").split("-");f=f[2];var e=$("#preview-area-"+f);if($(this).hasClass("link-fetched")){if($(this).hasClass("active")){e.hide();$(this).removeClass("active");sPopupsResizeCenter()
}else{$(this).addClass("active");e.show();sPopupsResizeCenter()}}else{$(this).addClass("link-fetched");$(this).addClass("active");e.addClass("fetching-data");e.append('<img src="/sites/all/themes/schoology_theme/images/ajax-loader.gif" alt="'+Drupal.t("Loading")+'" />');sPopupsResizeCenter();var g=lm.getCurrentInfo(f);if(typeof c=="undefined"){var d={link:escape(g.link),index:f}}else{var d=c}var d=$.toJSON(d);$.ajax({type:"POST",url:"/link_get_details",dataType:"json",data:"data="+d,success:function(h){e.empty();e.removeClass("fetching-data");if(h.status){e.append(h.data);sAttachPreviewAreaBehavior(e)}else{e.append('<div class="link-preview-error">'+Drupal.t("No preview found")+"</div>")}sPopupsResizeCenter()},error:function(){e.empty();e.removeClass("fetching-data");e.append('<div class="link-preview-error">'+Drupal.t("No preview found")+"</div>");sPopupsResizeCenter()}})}})}function sAttachPreviewAreaBehavior(a){var d=a.attr("id").split("-");d=d[2];var c=$("input.postprocess",a).val();
var b=$("input.type",a).val();lm.setPostprocessAndType(d,c,b);$(".prev-link-title:not(.sAttachmentForm-processed)",a).each(function(){var g=$(this).attr("id").split("-");g=g[2];var f=$(".link-title","#link-display-"+g);$(this).addClass("sAttachmentForm-processed");var h=$("span",$(this));var e=$("input",$(this));var j=lm.getCurrentInfo(g);h.html(j.title);e.val(j.title);h.click(function(){$(this).hide();$(this).siblings().show();f.addClass("active");$(this).siblings().focus();sPopupsResizeCenter();return false});h.siblings().blur(function(){$(this).hide();$(this).siblings().text($(this).val());$(this).siblings().show();lm.updateTitle(g,$(this).val());f.removeClass("active");sPopupsResizeCenter()});e.keyup(function(){f.html($(this).val())})});$(".link-summary:not(.sAttachmentForm-processed)",a).each(function(){$(this).addClass("sAttachmentForm-processed");var f=$("p",$(this));var e=$("textarea",f.parent());var g=e.attr("id").split("-");g=g[3];lm.updateDescription(g,e.val());f.click(function(){f.hide();
e.show();e.focus();sPopupsResizeCenter();return false});e.blur(function(){var h=e.attr("id").split("-");h=h[3];e.hide();f.text(e.val());f.show();lm.updateDescription(h,e.val());sPopupsResizeCenter()})});$(".link-thumbnail-selector:not(.sAttachmentForm-processed)",a).each(function(){$(this).addClass("sAttachmentForm-processed");var e=$(this).attr("id").split("-");e=e[3];var g=$(this).siblings(".link-thumbnails").children();var f=$(g[0]);lm.updateThumbnail(e,f.attr("src"));$("a.next").click(function(){var j=$(this).parent().siblings(".link-thumbnails");var k=j.attr("id").split("-");k=k[2];var o=j.children();var m=o.filter(":visible");m.hide();var l=m.next();if(l.length==0){l=o.eq(0)}lm.updateThumbnail(k,l.attr("src"));l.show();$(this).siblings(".edit-link-thumbnail").val(l.attr("src"));var h=$(this).siblings(".curr-thumbnail");var n=parseInt(h.text());h.text(n%(o.length)+1);sPopupsResizeCenter();return false});$("a.prev").click(function(){var j=$(this).parent().siblings(".link-thumbnails");
var k=j.attr("id").split("-");k=k[2];var o=j.children();var m=o.filter(":visible");m.hide();var l=m.prev();if(l.length==0){l=o.eq(o.length-1)}lm.updateThumbnail(k,l.attr("src"));l.show();$(this).siblings(".edit-link-thumbnail").val(l.attr("src"));var h=$(this).siblings(".curr-thumbnail");var n=parseInt(h.text());n=(n-1)%(o.length);if(n==0){n=o.length}h.text(n);sPopupsResizeCenter();return false});$(".edit-link-no-thumbnail").click(function(){if($(this).is(":checked")){$(".link-thumbnails").hide();$(".link-thumbnail-selector").hide();lm.updateThumbnail(e,"");sPopupsResizeCenter()}else{$(".link-thumbnails").show();$("link-thumbnail-selector").show();sPopupsResizeCenter()}})})}function sAttachEmbedPreview(b){var a=$(".embed-preview-button:not(.sPreviewButton-processed)",b);a.addClass(".sPreviewButton-processed");a.click(function(){var f=$(this).attr("id").split("-");f=f[2];var g=lm.getCurrentInfo(f);var d=new Popups.Popup();var c=g.link;var e={hideActive:false};d.extraClass="embed-preview-popup";
Popups.open(d,Drupal.t("Embed Preview"),c,"","500",e)})}var swfu;var uploads=[];var lm=new sLinkManager();Drupal.behaviors.sAttachmentForm=function(a){window.uploads=[];$("#attachments:not(.sAttachmentDelete-processed)",a).addClass("sAttachmentDelete-processed").on("click",".delete-attachment",function(){var b=$(this);var c=b.attr("id").split("-").pop();$(".attachment-delete-"+c,a).val(1);b.closest(".attachment-block").remove();sPopupsResizeCenter()});$(".attachment-action-links:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){$(".attachment-action-links",a).sActionLinks({hidden:true,wrapper:".attachment-links-action-links",rowClass:".attachment-links"})});$(".attachment-file:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){var m=$(this);var l=m.parents(".popups-box:first").length>0?m.parents(".popups-box:first"):$("body");if(!Drupal.settings.s_attachment){return true}var q="attachments-added-container";if(typeof Drupal.settings.s_attachment.existing_files=="object"){$.each(Drupal.settings.s_attachment.existing_files,function(u,x){var y=x.fid?x.fid:x.id;
var v={id:y,name:x.filename};var t=new FileProgress(v,q);t.setComplete();t.setExtension(x.ext);var w=$("div#"+y+".progressWrapper");$(".progressName",w).attr("id","file-"+y);sAttachmentSetupEditDetails(y,y)})}if(typeof Drupal.settings.s_attachment.basic!="undefined"){var h=0;function s(t){return t+"-"+(h++)}$("ul#attachment-selector li#file-selector:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){$(this).click(function(){$(this).addClass("active");popupLinkSelectorClose("#attachment-links ul#attachment-selector li#link-selector");$("#attachment-file").toggle();if($("#attachment-file").is(":hidden")){$("ul#attachment-selector li#file-selector").removeClass("active")}else{$(".basic-upload .form-file","#attachment-file").trigger("focus");$("ul#attachment-selector li#file-selector").addClass("active")}$("#attachment-link").hide();sPopupsResizeCenter();return false});resetAttachmentForm()});var k=$(".iframe-name",m).val(),p='<img src="/sites/all/themes/schoology_theme/images/ajax-loader.gif" class="basic-upload-loader-image" alt="'+Drupal.t("Loading")+'" />';
$(".basic-upload-field",m).change(function(){var w=$(this),v=$("<iframe/>").attr("name",s(k)).addClass("hidden"),x=null;w.parents(".basic-upload").append(p);var u=$("#edit-submit",w.parents("form"));u.attr("disabled","true").addClass("disabled");var t=Drupal.settings.s_attachment.upload_url;if($(".action-override",m).length>0){t=$(".action-override",m).val()}noSubmit=false;if($(".no-submit",m).length>0){noSubmit=$(".no-submit",m).val()}w.addClass("upload-cloned");l.append(w).append(v);w.wrap('<form class="upload-form hidden" target="'+v.attr("name")+'" enctype="multipart/form-data" action="'+t+'" method="POST" />');x=w.closest(".upload-form");if(k=="ajaxfile"){x.append($(".realm-info",m).html())}x.append('<input name="use_plain" type="hidden" value="1">');x.submit();v.unbind("load.s_attachment").on("load.s_attachment",function(){if(k=="ajaxfile"){var z;if(this.contentDocument){var C=$(this.contentDocument).find("body").html()}else{var C=$(this.contentWindow.document).find("body").html()
}C=C.split("[acup-open]");C=C[1];C=C.split("[acup-close");C=C[0];C=$.parseJSON(C);if(typeof C.file=="undefined"){$(".basic-upload-loader-image",l).remove();if(typeof C.message!="undefined"){if($(".error",l).length===0){$("#attachment-file",l).closest("form").prepend('<div class="error messages post-message">'+C.message+"</div>")}else{$("#attachment-file",l).closest("form").find(".error").text(C.message)}}sAttachmentResetBasicUploader();sPopupsResizeCenter()}if(typeof C.file=="undefined"||!C.file.url||C.file.url==""){sAttachmentResetBasicUploader();return}z=typeof C.file.type!="undefined"?C.file.type:$(".attachment-type",m).val();if(z=="image"){var A='<img src="'+String(C.file.url)+'" alt="'+Drupal.t("Preview image")+'" title="" />';tinyMCE.activeEditor.execCommand("sContentInsert",A);var y=Popups.activePopup();Popups.close(y)}else{if(z=="media"){var B=C.file.url;var E=C.file.fid?C.file.fid:"";if(B.match(/^<(object|iframe|embed).+/i)){Popups.close();tinyMCE.activeEditor.execCommand("sContentInsert",B);
return}$.ajax({url:"/media/richtext/embedcode",data:{fid:E,url:B},type:"POST",dataType:"json",success:function(H,G){var F=Popups.activePopup();Popups.close(F);tinyMCE.activeEditor.execCommand("sContentInsert",H.embedCode)},error:function(G,F,H){alert(Drupal.t("There was an internal error. Please try again in a few moments."))}})}}return}else{if(this.contentDocument){var C=$(this.contentDocument).find("pre").html()}else{var C=$(this.contentWindow.document).find("pre").html()}C=$.parseJSON(C)}if(!noSubmit){fileName=C.file.filename.split("?");fileName=fileName[0];$(".edit-file-files").val("");addFileToUploadField(C.file.fid,m);$("img.basic-upload-loader-image",m).remove();$(".basic-upload",m).prepend('<span class="basic-uploader-filename">'+fileName+"</span>");if(typeof Drupal.settings.postSuccessFunction=="string"){var D=Drupal.settings.postSuccessFunction;window[D](C.file.destination)}u.attr("disabled",false).removeClass("disabled")}$(".upload-form").hide();if(k=="pic_uploader"){location.reload()
}sPopupsResizeCenter()})});$(document).ready(function(){if($(".basic-hidden",m).length>0&&$(".basic-hidden",m).val()==0){m.css("display","block");sPopupsResizeCenter()}});if(typeof Drupal.settings.s_attachment.existing_files!="undefined"){var e=[];$.each(Drupal.settings.s_attachment.existing_files,function(t,u){if(u.type=="file"){e.push(u)}});if(e.length>0){m.show()}}return}var f=Drupal.settings.s_attachment.file_only_form?$(".upload-btn-wrapper .upload-btn-inner",a):$("#file-selector",a);if(f.length==0){return}f.find("a").click(function(t){t.preventDefault()});var r=f.outerHeight();var n=f.outerWidth();if(typeof Drupal.settings.s_attachment.override_width!="undefined"){n=Drupal.settings.s_attachment.override_width}if(r==0){r=22}if(n==0){n=44;if(Drupal.settings.s_attachment.hasOwnProperty("file_only_form")){if(Drupal.settings.s_attachment.file_only_form==true){n=81}}}var b=window.location.search.match(/swfupload_debug/)?true:false;var c=$(this).siblings("#edit-sid").val();var j={upload_url:Drupal.settings.s_attachment.upload_url,flash_url:"/sites/all/misc/swfupload/Flash/swfupload.swf",file_size_limit:Drupal.settings.s_attachment.max_filesize+" MB",file_upload_limit:Drupal.settings.s_attachment.max_num_uploads,file_types:Drupal.settings.s_attachment.file_types,file_post_name:"files[swf]",button_placeholder_id:"swf-trans-file-selector",button_text:"",button_image_url:"",button_width:n,button_height:r,button_cursor:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:b,post_params:{sid:c},preserve_relative_urls:true,file_queued_handler:fileQueued,file_queue_error_handler:fileQueueError,file_dialog_complete_handler:fileDialogComplete,file_dialog_start_handler:fileDialogStart,upload_start_handler:uploadStart,upload_progress_handler:uploadProgress,upload_error_handler:uploadError,upload_success_handler:uploadSuccess,upload_complete_handler:uploadComplete,queue_complete_handler:queueComplete,debug_handler:b?uploadDebug:null,custom_settings:{progressTarget:(q)}};
if(typeof Drupal.settings.postSuccessFunction=="string"){j.custom_settings.postSuccessFunction=Drupal.settings.postSuccessFunction}window.swfu=new SWFUpload(j);var g=$("#attachment-selector #file-selector .swfupload",a);g.css({position:"absolute",top:"0px",left:"0px"});if(!swfobject.hasFlashPlayerVersion("7.0.0")){var d=g.find(".get-flash-uploader"),o=g.closest("a");o.attr({href:d.attr("href"),target:d.attr("target"),}).addClass("download-flash-link").find(".infotip-content").text(Drupal.t("Download Flash"));d.replaceWith(d.html())}else{g.find(".get-flash-uploader").remove()}$(document).bind("popups_before_remove",function(w,v){if(typeof swfu!="object"||!swfu.movieName){return}var t=Popups.activePopup();var u=$("#"+swfu.movieName).parents(".popups-box");if(t&&u.length>0&&t.id==u.attr("id")){try{swfu.destroy()}catch(w){}}})});$(".attachment-file-chunked:not(.sAttachmentFormChunked-processed)",a).addClass("sAttachmentFormChunked-processed").each(function(){var o=$(this);var h=function(){var s=o.closest("form");
return s.length?s:o};var n="";if($(".attachments-added-container",h())){n=$(".attachments-added-container",h()).attr("id")}n=n?n:"attachments-added-container";var m=Drupal.settings.s_attachment.max_num_uploads;var f=Drupal.settings.s_attachment.custom_error_messages;var c={};var e=$("#edit-submit",h());var q=$(".submit-span-wrapper",h());var p;var g;var r={};var b={max_file_size:Drupal.settings.s_attachment.max_filesize+"mb"};var d=Drupal.settings.s_attachment.drop_element!=undefined&&Drupal.settings.s_attachment.drop_element.length>0?Drupal.settings.s_attachment.drop_element:"";var j="edit-encode-video";if(typeof Drupal.settings.s_attachment.file_types!="undefined"&&Drupal.settings.s_attachment.file_types){b.mime_types=[];b.mime_types[0]={};b.mime_types[0].title=Drupal.t("Allowed Types");b.mime_types[0].extensions=Drupal.settings.s_attachment.file_types}if(typeof Drupal.behaviors.sAttachmentMessageForm=="function"){Drupal.behaviors.sAttachmentMessageForm()}var l=$("#edit-target-DOM-id",a);
if(l.length){Drupal.settings.s_attachment.target_DOM_id=l.val()}var k=new plupload.Uploader({runtimes:"html5, html4",browse_button:(Drupal.settings.s_attachment.target_DOM_id)?Drupal.settings.s_attachment.target_DOM_id:"upload-btn",url:Drupal.settings.s_attachment.upload_url,chunk_size:Drupal.settings.s_attachment.chunk_size+"kb",drop_element:d,filters:b,multi_selection:m>1,init:{FilesAdded:function(s,v){var x=k.files.length;if(x>m){var u=Drupal.t("You have attempted to queue too many files.")+"\n";if(m>1){u+=Drupal.t("You may select up to !max_uploads files.",{"!max_uploads":m})}else{u+=Drupal.t("You may select one file.")}alert(u);var w=x-m;k.splice(x-w,w)}else{for(i in v){var t=v[i];c[t.id]=new FileProgress(t,n);c[t.id].setStatus(Drupal.t("Uploading..."));var y=$("#"+c[t.id].fileProgressID,h());y.on("removed",function(){h().trigger("sAttachmentUploader.fileRemoved",[s,v]);k.removeFile(t)})}p=$(".progressCancel",h());p.show();p.on("click",function(){var A=$(this);var z=A.parents(".progressWrapper:first").attr("id");
A.hide();c[z].setStatus(Drupal.t("Canceled"));c[z].setCancelled();k.removeFile(z)});e.attr("disabled","true").addClass("disabled");k.start()}},BeforeUpload:function(t,v){var s=k.getOption("multipart_params");s=s?s:{};s.use_plain=1;delete s.fid;delete s.encode_video;var u=sAttachmentChunkedUploadCheckEncode(j,h());if(u!==false){$.extend(s,{encode_video:u})}k.setOption("multipart_params",s)},UploadProgress:function(s,t){if(!r[t.id]){c[t.id].setProgress(t.percent)}},ChunkUploaded:function(t,u,v){response=$.parseJSON(v.response);if(!r[u.id]){r[u.id]=sAttachmentChunkedUploadCheckError(k,u,response,c)}if(!r[u.id]){var s=k.getOption("multipart_params");if(typeof s.fid=="undefined"||s.fid!=response.file.fid){k.setOption("multipart_params",$.extend(s,{use_plain:1,fid:response.file.fid}))}if(typeof response.final_phase!="undefined"&&response.final_phase){c[u.id].setStatus(Drupal.t("Finalizing Upload")+' <img class="loading-img" src="/sites/all/themes/schoology_theme/images/ajax-loader-small.gif" height="10" width="10" alt="'+Drupal.t("processing")+'" />')
}}},FileUploaded:function(t,w,v){var s={use_plain:1};h().trigger("sAttachmentUploader.fileUploaded",arguments);var u=sAttachmentChunkedUploadCheckEncode(j,h());if(u!==false){$.extend(s,{encode_video:u})}k.setOption("multipart_params",s);var x=v.response;x=x.replace(/(^<pre>|<\/pre>$)/g,"");v=$.parseJSON(x);if(!r[w.id]){r[w.id]=sAttachmentChunkedUploadCheckError(k,w,v,c)}if(!r[w.id]){c[w.id].setStatus(Drupal.t("Complete"));c[w.id].setComplete();g=$(".progressDelete");p.hide();g.show();addFileToUploadField(v.file.fid,h());addFileDetails(v.file.fid,htmlentities(w.name));sAttachmentSetupEditDetails(w.id,v.file.fid,v.file.can_skip_encode);$("#"+w.id).children().children(".progressName").attr("id","file-"+v.file.fid);e.removeAttr("disabled").removeClass("disabled");if(q.length){q.removeClass("disabled")}if(v.sAfu_insert_content&&typeof sAfu!="undefined"){sAfu.onUpload(v.file)}if(typeof Drupal.settings.postSuccessFunction=="string"){var y=Drupal.settings.postSuccessFunction;window[y](v.file.destination)
}}},Error:function(s,w){var v=w.code;var u=f&&f[v];h().trigger("sAttachmentUploader.error",arguments);if(u){sAttachmentChunkedUploadCheckError(k,w.file,{error:{code:"",message:u},file:w.file,status:w.status},c);sPopupsResizeCenter();return}if(v==-601){var x=Drupal.t("Only files of the following extensions are accepted: !ext",{"!ext":Drupal.settings.s_attachment.file_types});alert(x)}else{if(v==-200){var t={error:{code:"",message:Drupal.t("Unsupported file or directory uploaded")},file:w.file,status:w.status};sAttachmentChunkedUploadCheckError(k,w.file,t,c)}else{alert("Error code "+v+" Message "+w.message)}}},PostInit:function(s,u){var t=$("#"+d);if(s.runtime==="html5"&&t.length>0){t.bind("dragenter",function(){sAttachmentChunkedUploadToggleDropzone(d,true,h())}).bind("dragleave dragend drop",function(){sAttachmentChunkedUploadToggleDropzone(d,false,h())})}}}});k.init();$.each(Drupal.settings.s_attachment.additional_behaviors,function(s,t){if(typeof Drupal.behaviors[s][t]!=="undefined"){$.each(Drupal.behaviors[s][t],function(u,v){if(typeof u==="string"&&typeof v==="function"){k.bind(u,v)
}})}})});$("#attachment-selector #recording-selector:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){var b=$("a",this);b.click(function(f){f.preventDefault();$(document).bind("popups_close",function(){sPopupsResizeCenter()});if($("#edit-file-recording").val()!=""||$("a",$(this)).hasClass("disabled")){return}Popups.saveSettings();var d=Popups.activePopup();var c=Popups.options({href:"/s_attachment_recording",extraClass:"popups-small no-buttons attachment-recorder",updateMethod:"callback",onUpdate:"sPopupsResizeCenter"});Popups.openPath(b,c,d)})});$("#s-resource-attachments:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){resourceIds=[];$(document).unbind("popups_before_close.s_resource_attach");$(document).bind("popups_before_close.s_resource_attach",function(c,b){if(b!=null&&b.hasOwnProperty("extraClass")&&b.extraClass.indexOf("s-resource-import-attachment")!=-1){resourceIds=[]}});$(".submit-buttons .form-submit",$(this)).click(function(){var f=sAttachmentGetAddedResources();
var d=[];if(resourceIds.length>0){var g="";var c=0;$.each(resourceIds,function(k,h){var j=false;if(h.type=="template"&&$.inArray(h.nid,f.templates)===-1){f.templates.push(h.nid);j=true;g="template-delete"}else{if(h.type=="contentAppImport"){f.contentAppImports.push(h.nid);j=true;g="content-import-delete"}}if(j){var l='<div class="resource-attachment">';l+='<span class="delete-link '+g+'" id="delete-'+h.nid+'"></span>';l+='<div class="resource-value"><div class="resource-icon">'+h.icon+'</div><div class="resource-title"></div></div>';l+="</div>";l=$(l);$(".resource-title",l).text(h.title);$("#attachments-added-container").append(l);$(".delete-link",l).click(function(){var n=sAttachmentGetAddedResources();if($(this).hasClass("template-delete")){var o=parseInt($(this).attr("id").split("-").pop());var m=$.inArray(o,n.templates);if(m!==-1){n.templates.splice(m,1)}}else{if($(this).hasClass("content-import-delete")){var o=parseInt($(this).attr("id").split("-").pop());var m=$.inArray(o,n.contentAppImports);
if(m!==-1){n.contentAppImports.splice(m,1)}}}sAttachmentSetAddedResources(n);$(this).parents(".resource-attachment:first").remove();sPopupsResizeCenter()});if(h.isLTI){c++}}});sAttachmentSetAddedResources(f)}var b=Popups.activePopup();if(b.parent!=undefined&&c>0){var e=$("#"+b.parent.id);if($(".s-js-external-tool-warning",e).length==0){addMessages([{value:Drupal.t("Warning: LTI content may not load properly until the correct configurations are set. You can edit these configurations in External Tool Providers under Course Options, or edit the items individually from the gear menu.")}],"warning s-js-external-tool-warning",$(".popups-body",e))}}Popups.close(b);sPopupsResizeCenter()})});$("#collection-view-contents.s-resource-attachment-form tr td.collection-item-checkbox input:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){$(this).click(function(){var f=$(this);var b=f.val().split("_");var d=0;if(isNaN(d=parseInt(b.pop()))===false&&b.pop()=="t"){if(f.is(":checked")){var j=f.parents(".collection-row-template:first");
var h=$(".collection-item-title span.item-title",j).text();var e=$(".collection-item-icon",j).html();var g=$(".collection-item-icon span:first",j).hasClass("external-tool-icon");resourceIds.push({title:h,icon:e,nid:d,type:"template",isLTI:g})}else{resourceIds=$.grep(resourceIds,function(k,l){return k.nid!=d})}}else{if(f.hasClass("gdoc")){var c=f.val();if(f.is(":checked")){var j=f.closest(".collection-row-external");var h=$(".collection-item-title a.item-title",j).text();var e=$(".collection-item-icon span.inline-icon",j)[0].outerHTML;resourceIds.push({title:h,icon:e,nid:c,type:"gdoc"})}else{resourceIds=$.grep(resourceIds,function(k,l){return k.nid!=c})}}}})});$("#attachment-link:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){lm.reset();var d=$(this).html();var d="<fieldset>"+d+"</fieldset>";var h={linkAttach:{title:Drupal.t("Attach")},linkPopupCancel:{title:Drupal.t("Close"),func:function(){popupLinkSelectorClose("#attachment-links ul#attachment-selector li#link-selector")
}}};$(this).empty();var j=$("#attachment-links ul#attachment-selector li#link-selector:not(.sAttachmentForm-processed)",a);j.addClass("sAttachmentForm-processed");j.click(function(){if($(this).hasClass("active")){$(this).removeClass("active");return false}else{$(this).data("popupOpen",1);$(this).addClass("active");var l=new Popups.Popup();l.disableInputFocus=true;l.element=j.find("a")[0];var s={hideActive:false};l.extraClass="popups-small add-link-popup";Popups.open(l,Drupal.t("Attach Link/Embed"),d,h,"400",s);var n=$("#"+l.id);var m=$("#linkAttach",n);var t=$("#edit-link-url",n);var r=t.attr("defaulttext");var o=$("#edit-link-title",n);var q={linkLimit:{val:'<div id="too-many-links" class="messages error"><div class="message-text">'+Drupal.t("You can only attach ")+Drupal.settings.s_attachment.max_links+Drupal.t(" links.")+"</div></div>",isActive:false},ajaxError:{val:'<div class="messages error"><div class="message-text">'+Drupal.t("Sorry, no title was found")+"</div></div>",isActive:false},validUrl:{val:'<div id="not-valid-value" class="messages error"><div class="message-text">'+Drupal.t("Please enter a valid URL or Embed Code")+"</div></div>",isActive:false},embedTitle:{val:'<div class="messages error"><div class="message-text">'+Drupal.t("Titles for embedded media must be manually enterred")+"</div></div>",isActive:false}};
var p=$(".popups-body",n);p.bind("linkLimit",function(){if(q.linkLimit.isActive==false){$(".messages.error",$(this)).remove();$(this).prepend(q.linkLimit.val);q.linkLimit.isActive=true}sPopupsResizeCenter()});$("span.infotip",n).each(function(){$(this).removeClass("sCommonInfotip-processed")});sAttachBehavior("sCommonInfotip",n);t.data("linkInfo",false);t.data("linkInfoLastUpdate","");t.data("updatingInfo",false);if(t.val()==""||t.val()==r){t.val(r).addClass("pre-fill")}t.focus(function(){if(t.val()==r){t.val("");t.removeClass("pre-fill")}}).blur(function(){if(t.val()==""){t.val(r);t.addClass("pre-fill")}});t.bind("keypress",function(u){if(u.which==13){return false}});t.bind("addLink",function(){var u=$(this).val();var x=$(this).data("linkInfoLastUpdate");var w=$(this).data("linkInfo");if(w==false){w={}}w.title=htmlentities(o.val());w.link=u;var v=lm.addLink(w);if(v=="full"){p.trigger("linkLimit")}if(w!=false&&u==x){var y=lm.getDisplay(v,w.favUrl);$("#attachments-added-container").append(y);
sPopupsResizeCenter();$(".delete-link",y).click(function(){lm.removeLink($(this).data("linkManagerIndex"));sPopupsResizeCenter()})}else{var y=lm.getDisplay(v);$("#attachments-added-container").append(y);sPopupsResizeCenter();$(".delete-link",y).click(function(){lm.removeLink($(this).data("linkManagerIndex"));sPopupsResizeCenter()});$.ajax({type:"POST",url:"/link_process_ajax",dataType:"json",data:{data:$.toJSON(w)},success:function(z){if(!z.status){if(q.ajaxError.isActive==false){$(".messages.error",p).remove();p.prepend(q.ajaxError.val);sPopupsResizeCenter();q.ajaxError.isActive=true}}else{if(z.status){z.data.link=u;z.data.title=$.trim(z.data.title);lm.updateLink(z.data,v);lm.updateDisplay(v,z.data.favUrl);sPopupsResizeCenter()}}},error:function(A,z){if(q.ajaxError.isActive==false){$(".messages.error",p).remove();p.prepend(q.ajaxError.val);sPopupsResizeCenter();q.ajaxError.isActive=true}}})}});t.bind("updateLinkInfo",function(y){var v=$(this).val();var z=$(this).data("linkInfoLastUpdate");
var w=$(this).data("linkInfo");var x=true;if(w!=false&&v==z){x=false}if(x){if($(this).data("updatingInfo")==false){var u={link:escape(v)};var u=$.toJSON(u);var A=$(".populate-link-title",n);A.append('<img class="gif-loader" src="/sites/all/themes/schoology_theme/images/ajax-loader.gif" alt="'+Drupal.t("Loading")+'" />');A.addClass("disabled");$(this).data("updatingInfo",true);$.ajax({type:"POST",url:"/link_process_ajax",dataType:"json",data:"data="+u,success:function(B){if(!B.status){if(q.ajaxError.isActive==false){$(".messages.error",p).remove();p.prepend(q.ajaxError.val);sPopupsResizeCenter();q.ajaxError.isActive=true}}else{if(B.status){B.data.link=v;w=B.data;$(".messages.error",p).remove();sPopupsResizeCenter();w.title=$.trim(w.title);if(y){o.val(w.title)}t.data("linkInfo",w)}}$(".gif-loader",A).remove();A.removeClass("disabled");t.data("updatingInfo",false)},error:function(){if(q.ajaxError.isActive==false){$(".messages.error",p).remove();p.prepend(q.ajaxError.val);sPopupsResizeCenter();
q.ajaxError.isActive=true}t.data("updatingInfo",false)}});$(this).data("linkInfoLastUpdate",v)}}else{if(y){o.val(w.title)}}});m.click(function(){if(!isLinkOrEmbed(t.val())){if(q.validUrl.isActive==false){$(".messages.error",p).remove();p.prepend(q.validUrl.val);sPopupsResizeCenter();q.validUrl.isActive=true}return}t.trigger("addLink");t.blur();t.val("");o.val("");t.data("linkInfo",false);t.data("linkInfoLastUpdate","");popupLinkSelectorClose("#attachment-links ul#attachment-selector li#link-selector")});$(".popups-close a",n).click(function(u){u.preventDefault();u.stopPropagation();popupLinkSelectorClose("#attachment-links ul#attachment-selector li#link-selector")});$(".populate-link-title",n).click(function(){var u=t.val();if(u.match(/(\<(?:object|iframe|embed|script).+(?:(?:\<\/(?:object|iframe|embed|script)\>)|(?:.*\/>)))/i)){if(q.embedTitle.isActive==false){$(".messages.error",p).remove();p.prepend(q.embedTitle.val);sPopupsResizeCenter();q.embedTitle.isActive=true}return}else{if(u!=""&&!isLinkOrEmbed(u)){if(q.validUrl.isActive==false){$(".messages.error",p).remove();
p.prepend(q.validUrl.val);sPopupsResizeCenter();q.validUrl.isActive=true}return}else{t.trigger("updateLinkInfo",true)}}});return false}});$("#attachment-links ul#attachment-selector li#external-tool-selector:not(.sAttachmentForm-processed)",a).addClass("sAttachmentForm-processed").each(function(){$(this).click(function(){if(window.sExternalToolFormSettings==undefined){Popups.saveSettings();var m=Popups.activePopup();var o=Popups.options({href:$("a",this).attr("href"),extraClass:"popups-large popups-add-external-tool-link",disableInputFocus:true});Popups.openPath($("a",this),o,m)}else{var n='<div class="s-external-tool-attachment-wrapper"></div>';var l=new Popups.Popup();l.parent=Popups.activePopup();l.element=this;l.extraClass="popups-large popups-add-external-tool-link";var p=Popups.open(l,Drupal.t("Add External Tool"),n,null,null,null);sAttachBehaviors(["sExternalTool"],$("#"+p.id))}return false});if(window.sExternalToolFormSettings!=undefined){window.sExternalToolFormSettings.attachments={}
}});if(typeof Drupal.settings.s_attachment!="undefined"&&typeof Drupal.settings.s_attachment.existing_links!="undefined"){var f=$("#attachments-added-container");var k=Drupal.settings.s_attachment.existing_links;for(i in k){var b=$("#edit-link-"+i);b.val(String(k[i]));var e=$.parseJSON(k[i]);var c=$("#link-display-"+i);lm.addLink(e);var g=lm.getDisplay(i,e.favUrl);f.append(g);sPopupsResizeCenter();$(".delete-link",g).click(function(){lm.removeLink($(this).data("linkManagerIndex"));sPopupsResizeCenter()})}sPopupsResizeCenter()}})};$(document).ready(function(){$(window).bind("dragover",function(a){a=a||event;a.preventDefault()});$(window).bind("drop",function(a){a=a||event;a.preventDefault()})});function attachmentSelectorHandler(b){var a=$(b).attr("id");if($("#copy-to-courses div").length>0){$("#toggle-copy").siblings().hide();$("#toggle-copy").removeClass("active")}return false}function addFileToUploadField(e,b){uploads.push(e);var a=sAttachmentGetFileInputDom(b);var d=a.val();if(d!=""){var c=$.parseJSON(d)
}else{var c={}}c[e]="";a.val($.toJSON(c))}function isRecordedFile(d){if(!d){return false}var a=$("#edit-file-recording");var b=a.val();if(!b||b==""){return false}if(b==d){return true}var c=$.parseJSON(b);return c.id==d}function addFileDetails(g,f,d){if(isRecordedFile(g)){var b={fid:g,title:f};$("#edit-file-recording").val($.toJSON(b));return true}f=htmlentities(f);var a=sAttachmentGetFileInputDom();var e=a.val();if(e==""){return false}var c=$.parseJSON(e);if(c.hasOwnProperty(g)){if(typeof c[g]!="object"){c[g]={title:"",encode:true}}if(typeof f=="string"){c[g].title=f}if(typeof d=="boolean"){c[g].encode=d}}a.val($.toJSON(c))}function removeFileFromUploads(e){if(isRecordedFile(e)){$("#edit-file-recording").val("")}else{uploads.splice(jQuery.inArray(e,uploads),1);var a=sAttachmentGetFileInputDom();var d=a.val();if(d!=""){var c=$.parseJSON(d)}else{return false}if(c.hasOwnProperty(e)){delete c[e]}a.val($.toJSON(c))}if(swfu){var b=swfu.getStats();b.successful_uploads--;swfu.setStats(b)}}function removeTitleFromUploads(d){var a=sAttachmentGetFileInputDom();
var c=a.val();if(c!=""){var b=$.parseJSON(c)}else{return false}if(b.hasOwnProperty(d)){delete b[d]}a.val($.toJSON(b))}function resetAttachmentForm(){$("#attachment-link").hide();$("#attachment-file").hide();$("#attachment-info").hide();$("#attach-selector").click();sAttachmentGetFileInputDom().val("");$("#edit-file-recording").val("");$("#recording-selector a").removeClass("disabled");$("#edit-file-resources").val("");$(".progressWrapper").remove();var a=1;$(".url-submit a",$("#attachment-link")).css({filter:"alpha(opacity="+(a*100)+")","-moz-opacity":a,"-khtml-opacity":a,opacity:a});$("#attachments-added-container").empty();lm.reset();sPopupsResizeCenter()}function sAttachmentMoveForm(b,d,e){if($("div#attachments",b).length>0){return false}resetAttachmentForm();var c=$("div#attachments");$(".swfupload").hide();switch(e){case"append":$(d,b).append(c);break;case"before":$(d,b).before(c);break;default:$(d,b).after(c);break}var a=$(".sHideObjectEmbedPlaceholder",b);if(a.length>0){a.siblings(".swfupload").show();
a.remove()}$(".swfupload").show();return true}function popupLinkSelectorClose(a){var b=$(a);if(b.data("popupOpen")==1){Popups.close();b.data("popupOpen",0)}b.removeClass("active")}function sAttachmentSetupEditDetails(c,h,d){d=typeof d=="boolean"?d:false;var b=$("#"+String(c));var g=$(".file-details-content",b);var f=g.children(".progressTitleInput");f.attr("id","file-title-"+String(h)).removeClass("hidden").val("Add Title");f.focus(function(){var j=$(this);if(j.hasClass("pre-fill")){j.removeClass("pre-fill");j.val("")}});f.blur(function(){var j=$(this);if(j.val()==""){j.val("Add Title");j.addClass("pre-fill")}else{var k=j.attr("id").replace(/^file-title-/i,"")}addFileDetails(k,j.val())});if(d&&$("input.encode-cb",g).length==0){var e='<input type="checkbox" name="" id="file-encode-'+String(h)+'" class="encode-cb" CHECKED/> <span id="file-encode-infotip-'+String(h)+'" class="infotip" tipsygravity="w">'+Drupal.t("Encode video");e+='<span class="infotip-content">'+Drupal.t("If you uncheck this box, the uploaded file will be used for playback instead of a converted version.")+"</span></span>";
g.append(e);$("input.encode-cb",g).bind("change",function(){var j=$(this).attr("id").split("-")[2];addFileDetails(j,null,$(this).is(":checked"))});$("input.encode-cb",g).siblings("span.infotip").bind("click",function(){var j=$(this).siblings("input.encode-cb");j.trigger("click");var k=$(this).attr("id").split("-")[3];addFileDetails(k,null,j.is(":checked"))});Drupal.attachBehaviors(g)}var a=$(".progressShowHide",b);g.hide();a.click(function(){var k=$(this);var l=k.parents(".progressWrapper:first");var j=$(".file-details-content",l);j.toggle();k.toggleClass("active");sPopupsResizeCenter()})}function sAttachmentResetBasicUploader(){var b=Popups.activePopup();if(b){var a=$(".s-attachment-form-basic",$("#"+b.id))}else{var a=$(".s-attachment-form-basic")}var c=$(".upload-form");var d=$(".basic-upload-field",c);c.show();d.removeClass("upload-cloned");$(".basic-uploader-filename",a).remove();$("#edit-file-swf-wrapper",a).append(c);if($.browser.msie){d.replaceWith(d.clone(true))}else{d.val("")}}function sAttachmentGetAddedResources(){var b=$("#edit-file-resources").val();
var a=b==""?{}:$.parseJSON($("#edit-file-resources").val());if(!a.hasOwnProperty("templates")){a.templates=[]}if(!a.hasOwnProperty("contentAppImports")){a.contentAppImports=[]}return a}function sAttachmentSetAddedResources(b){var a=$.toJSON(b);$("#edit-file-resources").val(a)}function sAttachmentChunkedUploadCheckError(e,d,b,c){var a=false;if(typeof b=="undefined"||b=="null"||b.error||typeof b.file=="undefined"||typeof b.file.fid=="undefined"||!b.file.fid){a=true;var f;if(b.error){if(b.error.code){f=Drupal.t("Error !code: !message",{"!code":b.error.code,"!message":b.error.message})}else{if(b.error.message){f=Drupal.t("!message",{"!message":b.error.message})}}}else{f=Drupal.t("An unexpected error occured.")}c[d.id].setStatus(f);c[d.id].setError();e.removeFile(d,false)}return a}function sAttachmentChunkedUploadToggleDropzone(b,d,c){if(b){var a=$("#"+b,c);d=(d)?true:false;if(a){a.toggleClass("drag-hover",d)}}}function sAttachmentChunkedUploadCheckEncode(c,a){var b=$("#"+c,a);if(b.length>0){return(b.is(":checked")?"1":"0")
}return false}function sAttachmentGetFileInputDom(b){var a="[id^=edit-file-files]";return b?$(a,b):$(a)}function FileProgress(a,b){this.fileProgressID=a.id;this.opacity=100;this.height=0;this.fileProgressWrapper=document.getElementById(this.fileProgressID);if(!this.fileProgressWrapper){this.fileProgressWrapper=document.createElement("div");this.fileProgressWrapper.className="progressWrapper";this.fileProgressWrapper.id=this.fileProgressID;this.fileProgressElement=document.createElement("div");this.fileProgressElement.className="progressContainer";var j=document.createElement("a");j.className="progressCancel";j.href="#";j.style.display="none";j.appendChild(document.createTextNode(" "));var k=document.createElement("a");k.className="progressDelete";k.href="#";k.style.display="none";k.appendChild(document.createTextNode(" "));var d=document.createElement("span");d.className="progressName";d.appendChild(document.createTextNode(a.name));var g=document.createElement("span");g.className="progressShowHide";
g.appendChild(document.createTextNode(Drupal.t("Edit Details")));var h=document.createElement("input");h.id=this.fileProgressID+"-title";h.className="progressTitleInput hidden pre-fill";var f=document.createElement("div");f.className="progressBarInProgress";var e=document.createElement("div");e.className="progressBarStatus";e.innerHTML="&nbsp;";var l=document.createElement("div");l.className="file-details-content clearfix";l.appendChild(document.createElement("div"));l.childNodes[0].className="thumb-preview-wrapper";l.appendChild(document.createElement("div").appendChild(h));var c=document.createElement("span");c.className="default-icon inline-icon";this.fileProgressElement.appendChild(j);this.fileProgressElement.appendChild(k);this.fileProgressElement.appendChild(g);this.fileProgressElement.appendChild(c);this.fileProgressElement.appendChild(d);this.fileProgressElement.appendChild(e);this.fileProgressElement.appendChild(f);this.fileProgressElement.appendChild(l);this.fileProgressWrapper.appendChild(this.fileProgressElement);
document.getElementById(b).appendChild(this.fileProgressWrapper)}else{this.fileProgressElement=this.fileProgressWrapper.firstChild;this.reset()}this.height=this.fileProgressWrapper.offsetHeight;this.setTimer(null);sFileProgressResizePopup()}FileProgress.prototype.setExtension=function(a){var b={zip:"zip-icon",xls:"xls-icon",xlsx:"xls-icon",doc:"doc-icon",docx:"doc-icon",pdf:"pdf-icon",ppt:"ppt-icon",pptx:"ppt-icon",txt:"txt-icon",jpg:"image-icon",png:"image-icon",gif:"image-icon",jpeg:"image-icon",flv:"video-icon",avi:"video-icon",mpg:"video-icon",mov:"video-icon",m4v:"video-icon",m2v:"video-icon",wmv:"video-icon",wm:"video-icon",mp4:"video-icon","3g2":"video-icon","3gp":"video-icon",asf:"video-icon",qt:"video-icon",ram:"video-icon",rm:"video-icon",rpm:"video-icon",rv:"video-icon",smi:"video-icon",m4a:"music-icon",mp3:"music-icon",aac:"music-icon",caf:"music-icon",wma:"music-icon",ra:"music-icon",wav:"music-icon",psd:"psd-icon",ai:"ai-icon",indd:"indd-icon"};if(b.hasOwnProperty(a)){this.fileProgressElement.childNodes[3].className="inline-icon "+b[a]
}else{this.fileProgressElement.childNodes[3].className="inline-icon default-icon"}};FileProgress.prototype.setTimer=function(a){this.fileProgressElement.FP_TIMER=a};FileProgress.prototype.getTimer=function(a){return this.fileProgressElement.FP_TIMER||null};FileProgress.prototype.reset=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[5].innerHTML="&nbsp;";this.fileProgressElement.childNodes[5].className="progressBarStatus";this.fileProgressElement.childNodes[6].className="progressBarInProgress";this.fileProgressElement.childNodes[6].style.width="0%";this.appear()};FileProgress.prototype.setProgress=function(a){this.fileProgressElement.className="progressContainer orange";this.fileProgressElement.childNodes[6].className="progressBarInProgress";this.fileProgressElement.childNodes[6].style.width=a+"%";this.appear()};FileProgress.prototype.setComplete=function(){this.fileProgressElement.className="progressContainer green";this.fileProgressElement.childNodes[6].className="progressBarComplete";
this.fileProgressElement.childNodes[6].style.width="";var a=this;this.fileProgressElement.childNodes[1].style.display="block";var b=this;this.fileProgressElement.childNodes[1].onclick=function(){var d=new Popups.Popup();d.extraClass="save-changes-popup";var c=Drupal.t("Are you sure you want to remove this attachment?");var e={hideActive:false};var f={popup_submit:{title:Drupal.t("Remove"),func:function(){var g=b.fileProgressElement.childNodes[4].id.replace(/^file-/i,"");removeFileFromUploads(g);b.setDeleted();b.setStatus(Drupal.t("Removed"));b.fileProgressElement.childNodes[1].style.display="none";sPopupsResizeCenter();d.close();$("#"+b.fileProgressID).trigger("removed");if(!g.match(/^[0-9]+$/)){$("#recording-selector a").removeClass("disabled")}}},popup_cancel:{title:Drupal.t("Cancel"),func:function(){d.close()}}};d.extraClass="popups-small remove-attachment-dialog";Popups.open(d,Drupal.t("Remove Attachment"),c,f,null,e);sFileProgressResizePopup();return false}};FileProgress.prototype.setError=function(){this.fileProgressElement.className="progressContainer red";
this.fileProgressElement.childNodes[6].className="progressBarError";this.fileProgressElement.childNodes[6].style.width="";var a=this};FileProgress.prototype.setCancelled=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[6].className="progressBarError";this.fileProgressElement.childNodes[6].style.width="";var a=this;this.setTimer(setTimeout(function(){a.disappear();sPopupsResizeCenter()},2000))};FileProgress.prototype.setDeleted=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[6].className="progressBarError";this.fileProgressElement.childNodes[6].style.width="";var a=this;a.disappear()};FileProgress.prototype.setStatus=function(a){this.fileProgressElement.childNodes[5].innerHTML=a};FileProgress.prototype.toggleCancel=function(b,c){this.fileProgressElement.childNodes[0].style.display=b?"block":"none";if(c){var a=this.fileProgressID;this.fileProgressElement.childNodes[0].onclick=function(){c.cancelUpload(a);
return false}}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null)}if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100}catch(a){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)"}}else{this.fileProgressWrapper.style.opacity=1}this.fileProgressWrapper.style.height="";this.height=this.fileProgressWrapper.offsetHeight;this.opacity=100;this.fileProgressWrapper.style.display=""};FileProgress.prototype.disappear=function(){this.fileProgressWrapper.style.display="none";this.fileProgressWrapper.style.opacity=0;this.fileProgressWrapper.style.height="0px"};function sFileProgressResizePopup(){if(typeof(Popups)=="undefined"){return}popup=Popups.activePopup();if(popup!=null){Popups.resizeAndCenter(popup)}}function fileQueued(c){try{var a=new FileProgress(c,this.customSettings.progressTarget);a.setStatus(Drupal.t("Pending")+"...");
a.toggleCancel(true,this)}catch(b){this.debug(b)}}function fileQueueError(c,e,d){try{if(e===SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){alert("You have attempted to queue too many files.\n"+(d===0?"You have reached the upload limit.":"You may select "+(d>1?"up to "+d+" files.":"one file.")));return}var a=new FileProgress(c,this.customSettings.progressTarget);a.setError();a.toggleCancel(false);switch(e){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:a.setStatus(Drupal.t("File is too big."));this.debug("Error Code: File too big, File name: "+c.name+", File size: "+c.size+", Message: "+d);break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:a.setStatus(Drupal.t("Cannot upload Zero Byte files."));this.debug("Error Code: Zero byte file, File name: "+c.name+", File size: "+c.size+", Message: "+d);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:a.setStatus(Drupal.t("Invalid File Type."));this.debug("Error Code: Invalid File Type, File name: "+c.name+", File size: "+c.size+", Message: "+d);break;
default:if(c!==null){a.setStatus(Drupal.t("Unhandled Error"))}this.debug("Error Code: "+e+", File name: "+c.name+", File size: "+c.size+", Message: "+d);break}}catch(b){this.debug(b)}}function fileDialogComplete(a,e){try{if(a>0){var b=$("input[type=submit]",$("#"+$(this)[0].movieName).parents().filter("form"));var d=0.2;b.css({filter:"alpha(opacity="+(d*100)+")","-moz-opacity":d,"-khtml-opacity":d,opacity:d});b.attr("disabled",true)}this.startUpload()}catch(c){this.debug(c)}}function uploadStart(c){try{var a=new FileProgress(c,this.customSettings.progressTarget);a.setStatus(Drupal.t("Uploading..."));a.toggleCancel(true,this)}catch(b){}if(uploads){this.addPostParam("queued_files",uploads.join(","))}return true}function uploadProgress(c,f,e){try{var d=Math.ceil((f/e)*100);var a=new FileProgress(c,this.customSettings.progressTarget);a.setProgress(d);a.setStatus(Drupal.t("Uploading..."))}catch(b){this.debug(b)}}function uploadSuccess(b,d){try{var a=new FileProgress(b,this.customSettings.progressTarget);
var c=$.parseJSON(d);if(c.messages){if(c.messages.error){a.setError();a.toggleCancel(false);a.setStatus(c.messages.error);return}}var f=$("#"+b.id).closest("form");addFileToUploadField(c.file.fid,f);$("#"+b.id).children().children(".progressName").attr("id","file-"+c.file.fid);sAttachmentSetupEditDetails(b.id,c.file.fid,c.file.can_skip_encode);a.setComplete();a.setExtension(c.ext);var e=Drupal.t("Complete");var j=c.file.filepath;a.setStatus(e);a.toggleCancel(false);if(typeof this.customSettings.postSuccessFunction=="string"){var h=this.customSettings.postSuccessFunction;window[h](j)}}catch(g){this.debug(g)}}function uploadError(c,f,e){try{var a=new FileProgress(c,this.customSettings.progressTarget);a.setError();a.toggleCancel(false);var d=Drupal.t("If you continue to face problems, try using the basic upload form by changing your settings in 'Account Settings'");switch(f){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:a.setStatus(Drupal.t("Upload Error")+": "+e+d);this.debug("Error Code: HTTP Error, File name: "+c.name+", Message: "+e);
break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:a.setStatus(Drupal.t("Upload Failed.")+d);this.debug("Error Code: Upload Failed, File name: "+c.name+", File size: "+c.size+", Message: "+e);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:a.setStatus(Drupal.t("Server (IO) Error")+d);this.debug("Error Code: IO Error, File name: "+c.name+", Message: "+e);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:a.setStatus(Drupal.t("Security Error")+d);this.debug("Error Code: Security Error, File name: "+c.name+", Message: "+e);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:a.setStatus(Drupal.t("Upload limit exceeded."));this.debug("Error Code: Upload Limit Exceeded, File name: "+c.name+", File size: "+c.size+", Message: "+e);break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:a.setStatus(Drupal.t("Failed Validation.  Upload skipped."));this.debug("Error Code: File Validation Failed, File name: "+c.name+", File size: "+c.size+", Message: "+e);break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:a.setStatus(Drupal.t("Cancelled"));
a.setCancelled();break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:a.setStatus(Drupal.t("Stopped"));break;default:a.setStatus(Drupal.t("Unhandled Error")+": "+f+d);this.debug("Error Code: "+f+", File name: "+c.name+", File size: "+c.size+", Message: "+e);break}}catch(b){this.debug(b)}}function uploadComplete(a){sHandlersResizePopup()}function queueComplete(b){var a=$("input[type=submit]",$("#"+$(this)[0].movieName).parents().filter("form"));var c=1;a.css({filter:"alpha(opacity="+(c*100)+")","-moz-opacity":c,"-khtml-opacity":c,opacity:c});a.attr("disabled",false);sHandlersResizePopup()}function uploadDebug(a){$("body").append('<p class="swfupload-debug-message"><pre>'+(new Date()).toString()+": "+a+"</pre></p>")}function sHandlersResizePopup(){if(typeof(Popups)=="undefined"){return}popup=Popups.activePopup();if(popup!=null){Popups.resizeAndCenter(popup)}}function fileDialogStart(){popupLinkSelectorClose("#attachment-links ul#attachment-selector li#link-selector")};